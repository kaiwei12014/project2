<!DOCTYPE html>
<!-- saved from url=(0101)http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/ -->
<html lang="en-US" prefix="og: http://ogp.me/ns#" class=" js csstransforms3d csstransitions" style="min-height: 100%;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/form"></script><script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/track"></script>

<title>Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery</title>

<link rel="pingback" href="http://machinelearningmastery.com/xmlrpc.php">

<!-- Start Visual Website Optimizer Asynchronous Code -->
<script type="text/javascript" async="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/cc.js.下載"></script><script type="text/javascript" async="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9556588.js.下載"></script><script src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/296263687421164" async=""></script><script async="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/fbevents.js.下載"></script><script async="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/analytics.js.下載"></script><script type="text/javascript">
var _vwo_code=(function(){
var account_id=270912,
settings_tolerance=2000,
library_tolerance=2500,
use_existing_jquery=false,
f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
</script><script src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/j.php" type="text/javascript"></script>
<!-- End Visual Website Optimizer Asynchronous Code -->

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

<!-- This site is optimized with the Yoast SEO plugin v4.6 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/">
<link rel="publisher" href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery">
<meta property="og:description" content="Time series prediction problems are a difficult type of predictive modeling problem. Unlike regression predictive modeling, time series also adds the complexity of a sequence dependence among the input variables. A powerful type of neural network designed to handle sequence dependence is called recurrent neural networks. The Long Short-Term Memory network or LSTM network is …">
<meta property="og:url" content="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="article:publisher" content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/">
<meta property="article:section" content="Deep Learning">
<meta property="article:published_time" content="2016-07-21T05:00:25+10:00">
<meta property="article:modified_time" content="2017-04-20T09:38:17+10:00">
<meta property="og:updated_time" content="2017-04-20T09:38:17+10:00">
<meta property="og:image" content="http://machinelearningmastery.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras.jpg">
<meta property="og:image:width" content="640">
<meta property="og:image:height" content="427">
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="http://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="http://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras Comments Feed" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.4"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/wp-emoji-release.min.js.下載" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="swiftype-css" href="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/autocomplete.css" type="text/css" media="all">
<link rel="stylesheet" id="woo-testimonials-css-css" href="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/testimonials.css" type="text/css" media="all">
<link rel="stylesheet" id="theme-stylesheet-css" href="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/style.css" type="text/css" media="all">
<!-- This site uses the Google Analytics by MonsterInsights plugin v6.1.7 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	var disableStr = 'ga-disable-UA-44039733-3';
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}

	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-44039733-3', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');
</script>
<!-- / Google Analytics by MonsterInsights -->
<!--[if lt IE 9]>
<link href="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/jquery.js.下載"></script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/jquery-migrate.min.js.下載"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/crayon.min.js.下載"></script>
<script type="text/javascript">
/* <![CDATA[ */
var swiftypeParams = {"engineKey":"EQnbutcu7sAwoF7N5nzx"};
/* ]]> */
</script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/install_swiftype.min.js.下載"></script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/third-party.min.js.下載"></script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/modernizr.min.js.下載"></script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/general.min.js.下載"></script>
<link rel="https://api.w.org/" href="http://machinelearningmastery.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://machinelearningmastery.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="http://machinelearningmastery.com/?p=2929">
<link rel="alternate" type="application/json+oembed" href="http://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fmachinelearningmastery.com%2Ftime-series-prediction-lstm-recurrent-neural-networks-python-keras%2F">
<link rel="alternate" type="text/xml+oembed" href="http://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fmachinelearningmastery.com%2Ftime-series-prediction-lstm-recurrent-neural-networks-python-keras%2F&amp;format=xml">
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript>&lt;img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1"
/&gt;</noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
</style>

<!-- Woo Shortcodes CSS -->
<link href="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/shortcodes.css" rel="stylesheet" type="text/css">

<!-- Custom Stylesheet -->
<link href="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/custom.css" rel="stylesheet" type="text/css">

<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.8">
<link rel="icon" href="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="http://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
<script src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/can-i-show.js.下載"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">
  /* === Form-Specific Styles === */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(9,123,156) !important;
    background: rgba(9,123,156,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab div,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Powered By === */

  .drip-tab .drip-powered-by {
    padding: 8px;
    margin-bottom: -5px;
    font-family: Helvetica, Arial, sans-serif;
    text-align: left;
    font-weight: bold;
    font-size: 10px;
    line-height: 16px;
    color: #ffffff;
    letter-spacing: 1px;
    text-align: center;
    text-transform: uppercase;
  }

  .drip-tab .drip-powered-by a {
    color: #ffffff !important;
    text-decoration: underline !important;
    letter-spacing: 1px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-tab .drip-text-field {
    margin: 0 !important;
    padding: 6px !important;
    height: auto !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

</style></head>
<body class="post-template-default single single-post postid-2929 single-format-standard gecko alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="http://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/MachineLearningMastery.png" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="http://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="text-3" class="widget widget_text">			<div class="textwidget"><br>
<div style="font-size:12pt;">
<a href="http://machinelearningmastery.com/start-here"><strong>Start Here</strong></a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://machinelearningmastery.com/blog">Blog</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://machinelearningmastery.com/products">Books</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://machinelearningmastery.com/about">About</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://machinelearningmastery.com/contact">Contact</a>
</div></div>
		</div><div id="search-3" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="http://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}" autocomplete="off">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="http://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Empty Menu</h3>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-2929 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
	<header>
	<h1 class="title entry-title">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="http://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-07-21T05:00:25+1000">July 21, 2016</abbr>  <span class="small">in</span> <span class="categories"><a href="http://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span>  </div>
	<section class="entry">
<div id="fsb-social-bar" class="fsb-social-bar" data-post-id="2929" data-socialite="false" style="width: 623px;"><style type="text/css">            #fsb-social-bar { width: 100%; border-bottom: 1px solid #dbdbdb; border-top: 1px solid #dbdbdb; padding: 10px 0; margin: 0px 0 20px 0; float: left; background: #fff; position: relative; clear: both; }            #fsb-social-bar a { border: 0px !important }            #fsb-social-bar.fsb-fixed { position: fixed; top: -2px; z-index: 99999; }            #fsb-social-bar .fsb-title { display: block; float: left; margin: 3px 20px 0 0; font-size: 16px; font-family: Arial, Helvetica, sans-serif; text-decoration: none; color: #333; }            #fsb-social-bar .fsb-share-facebook { width: 120px; float: left; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-facebook.fsb-hide-count { width: 44px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-twitter { float: left; width: 135px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-twitter.fsb-hide-count { width: 61px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-google { float: left; width: 105px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-google.fsb-hide-count { width: 33px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-linkedin { float: left; width: 135px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-linkedin.fsb-hide-count { width: 61px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-pinterest { float: left; width: 115px; padding: 3px 0 2px; height: 25px;}            #fsb-social-bar .fsb-share-pinterest.fsb-hide-count { width: 43px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .socialite { display: block; position: relative; background: url(http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/plugins/floating-social-bar/images/fsb-sprite.png) no-repeat scroll 0 0; }            #fsb-social-bar .socialite-loaded { background: none !important; }            #fsb-social-bar .fsb-service-title { display: none; }            #fsb-social-bar a { color: #333; text-decoration: none; font-size: 12px; font-family: Arial, Helvetica, sans-serif; }            #fsb-social-bar .fsb-twitter { width: 105px; height: 25px; background-position: -13px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-twitter .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 69px; color: #333; }            #fsb-social-bar .fsb-google { width: 75px; height: 25px; background-position: -136px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-google .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 41px; color: #333; }            #fsb-social-bar .fsb-google .socialite-button { margin: 0 !important; }            #fsb-social-bar .fsb-share-google .socialite-loaded .socialite-button{padding: 2px 0 0}            #fsb-social-bar .fsb-facebook { width: 89px; height: 25px; background-position: -231px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-facebook .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 52px; color: #333; }            #fsb-social-bar .fsb-facebook .socialite-button { margin: 0 !important;}            #fsb-social-bar .fsb-share-facebook .socialite-loaded .socialite-button {padding: 2px 0 0}            #fsb-social-bar .fsb-linkedin { width: 105px; height: 25px; background-position: -347px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-linkedin .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 70px; color: #333; }            #fsb-social-bar .fsb-linkedin .socialite-button { margin: 0 !important; }            #fsb-social-bar .fsb-pinterest { width: 88px; height: 25px; background-position: -484px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-pinterest .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 50px; color: #333; }            #fsb-social-bar .fsb-pinterest .socialite-button { margin: 0 !important; }            .fsb-clear { clear: both; }            .fsb-clear:after { clear:both; content:; display:block; height:0; line-height:0; overflow:auto; visibility:hidden; zoom:1; }            @media (max-width: 768px) { #fsb-social-bar.fsb-fixed { position: relative !important; top: auto !important; } }        </style><div class="fsb-share-facebook fsb-hide-count"><a href="http://www.facebook.com/sharer.php?u=http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" class="socialite facebook fsb-facebook" data-fsb-service="facebook" data-href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" data-send="false" data-layout="button_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="fsb-service-title">Facebook</span><span class="fsb-count">0</span></a></div><div class="fsb-share-twitter fsb-hide-count"><a href="https://twitter.com/share?original_referer=http%3A%2F%2Fmachinelearningmastery.com%2F&amp;source=tweetbutton&amp;text=Time+Series+Prediction+with+LSTM+Recurrent+Neural+Networks+in+Python+with+Keras&amp;url=http%3A%2F%2Fmachinelearningmastery.com%2Ftime-series-prediction-lstm-recurrent-neural-networks-python-keras%2F&amp;via=TeachTheMachine" class="socialite twitter fsb-twitter" data-fsb-service="twitter" rel="nofollow" target="_blank" title="Be the first one to tweet this article!"><span class="fsb-service-title">Twitter</span><span class="fsb-count">0</span></a></div><div class="fsb-share-google"><a href="https://plus.google.com/share?url=http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" class="socialite googleplus fsb-google" data-fsb-service="google" data-size="medium" data-href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow" target="_blank"><span class="fsb-service-title">Google+</span><span class="fsb-count">9</span></a></div><div class="fsb-share-linkedin"><a href="https://www.linkedin.com/cws/share?url=http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" class="socialite linkedin fsb-linkedin" data-fsb-service="linkedin" data-size="medium" data-href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow" target="_blank"><span class="fsb-service-title">LinkedIn</span><span class="fsb-count">170</span></a></div></div><div class="fsb-clear"></div><p>Time series prediction problems are a difficult type of predictive modeling problem.</p>
<p>Unlike regression predictive modeling, time series also adds the complexity of a sequence dependence among the input variables.</p>
<p>A powerful type of neural network designed to handle sequence dependence is called <a href="http://machinelearningmastery.com/crash-course-recurrent-neural-networks-deep-learning/">recurrent neural networks</a>. The Long Short-Term Memory network or LSTM network is a type of recurrent neural network used in deep learning because very large architectures can be successfully trained.</p>
<p>In this post, you will discover how to develop LSTM networks in Python using the Keras deep learning library to address a demonstration time-series prediction problem.</p>
<p>After completing this tutorial you will know how to implement and develop LSTM networks for your own time series prediction problems and other more general sequence problems. You will know:</p>
<ul>
<li>About the International Airline Passengers time-series prediction problem.</li>
<li>How to develop LSTM networks for regression, window and time-step based framing of time series prediction problems.</li>
<li>How to develop and make predictions using LSTM networks that maintain state (memory) across very long sequences.</li>
</ul>
<p>In this tutorial, we will develop a number of LSTMs for a standard time series prediction problem.</p>
<p style="text-align: center;"><strong>The problem and the chosen configuration for the LSTM networks are </strong><br>
<strong>for demonstration purposes only they are not optimized.</strong></p>
<p>These examples will show you exactly how you can develop your own differently structured LSTM networks for time series predictive modeling problems.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Oct/2016</strong>: There was an error in the way that RMSE was calculated in each example. Reported RMSEs were just plain wrong. Now, RMSE is calculated directly from predictions and both RMSE and graphs of predictions are in the units of the original dataset. Models were evaluated using Keras 1.1.0, TensorFlow 0.10.0 and scikit-learn v0.18. Thanks to all those that pointed out the issue, and to&nbsp;Philip O’Brien for helping to point out the fix.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
<li><strong>Update Apr/2017</strong>: For a more complete and better explained tutorial of LSTMs for time series forecasting see the post&nbsp;<a href="http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>.</li>
</ul>
<div id="attachment_2937" style="width: 650px" class="wp-caption aligncenter"><img class="size-full wp-image-2937" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras.jpg" alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="640" height="427" srcset="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras.jpg 640w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-300x200.jpg 300w" sizes="(max-width: 640px) 100vw, 640px"><p class="wp-caption-text">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras<br>Photo by <a href="https://www.flickr.com/photos/124559226@N08/15792381395/">Margaux-Marguerite Duquesnoy</a>, some rights reserved.</p></div>
<h2>Problem Description</h2>
<p>The problem we are going to look at in this post is theInternational Airline Passengers prediction problem.</p>
<p>This is a problem where, given a year and a month, the task is to predict the number of international airline passengers in units of 1,000. The data ranges from January 1949 to December 1960, or 12 years, with 144 observations.</p>
<p>The dataset is available for free from the <a href="https://datamarket.com/data/set/22u3/international-airline-passengers-monthly-totals-in-thousands-jan-49-dec-60#!ds=22u3&amp;display=line">DataMarket webpage as a CSV download</a> with the filename “<em>international-airline-passengers.csv</em>“.</p>
<p>Below is a sample of the first few lines of the file.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa4691013724084" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">"Month","International airline passengers: monthly totals in thousands. Jan 49 ? Dec 60"
"1949-01",112
"1949-02",118
"1949-03",132
"1949-04",129
"1949-05",121</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa4691013724084-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa4691013724084-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa4691013724084-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa4691013724084-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa4691013724084-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa4691013724084-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa4691013724084-1">"Month","International airline passengers: monthly totals in thousands. Jan 49 ? Dec 60"</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa4691013724084-2">"1949-01",112</div><div class="crayon-line" id="crayon-5906e65aa4691013724084-3">"1949-02",118</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa4691013724084-4">"1949-03",132</div><div class="crayon-line" id="crayon-5906e65aa4691013724084-5">"1949-04",129</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa4691013724084-6">"1949-05",121</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We can load this dataset easily using the Pandas library. We are not interested in the date, given that each observation is separated by the same interval of one month. Therefore, when we load the dataset we can exclude the first column.</p>
<p>The downloaded dataset also has footer information that we can exclude with the <strong>skipfooter</strong> argument to <strong>pandas.read_csv()</strong> set to 3 for the 3 footer lines. Once loaded we can easily plot the whole dataset. The code to load and plot the dataset is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa4698886551829" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">import pandas
import matplotlib.pyplot as plt
dataset = pandas.read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
plt.plot(dataset)
plt.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa4698886551829-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa4698886551829-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa4698886551829-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa4698886551829-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa4698886551829-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa4698886551829-1"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa4698886551829-2"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="crayon-5906e65aa4698886551829-3"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa4698886551829-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa4698886551829-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>You can see an upward trend in the dataset over time.</p>
<p>You can also see some periodicity to the dataset that probably corresponds to the Northern Hemisphere vacation period.</p>
<div id="attachment_2925" style="width: 810px" class="wp-caption aligncenter"><img class="size-full wp-image-2925" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/Airline-Passengers-Dataset.png" alt="Plot of the Airline Passengers Dataset" width="800" height="600" srcset="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Airline-Passengers-Dataset.png 800w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Airline-Passengers-Dataset-300x225.png 300w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Airline-Passengers-Dataset-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p class="wp-caption-text">Plot of the Airline Passengers Dataset</p></div>
<p>We are going to keep things simple and work with the data as-is.</p>
<p>Normally, it is a good idea to investigate various data preparation techniques to rescale the data and to make it stationary.</p>
<!-- Start Shortcoder content --><p></p><div class="woo-sc-hr"></div><p></p>
<h2 style="text-align: center;">Beat the Math/Theory Doldrums and Start using Deep Learning in your own projects Today, without getting lost in “documentation hell”</h2>
<p style="text-align: center;"><img class="alignleft size-full wp-image-3427" style="border: 0;" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/DeepLearningWithPython-MiniCourse_ipad-300.png" alt="Deep Learning With Python Mini-Course" width="300" height="413">Get my free Deep Learning With Python mini course and develop your own deep nets by the time you’ve finished the first PDF with just a few lines of Python.</p>
<h4 style="text-align: center;">Daily lessons in your inbox for 14 days, and a DL-With-Python “Cheat Sheet” you can download right now.&nbsp;&nbsp;&nbsp;</h4>
<center><a href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" onclick="__gaTracker(&#39;send&#39;, &#39;event&#39;, &#39;outbound-article&#39;, &#39;https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/&#39;, &#39;Download Your FREE Mini-Course&#39;);" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank" data-leadbox="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" data-leadbox-id="142d6e873f72a2:164f8be4f346dc">Download Your FREE Mini-Course</a> <script src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/leadbox-1463166699.js.下載" type="text/javascript" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" data-config="%7B%7D"></script>&nbsp;</center>
<p style="text-align: center;">&nbsp;</p>
<p></p><div class="woo-sc-hr"></div><p></p><!-- End Shortcoder content -->
<h2>Long Short-Term Memory Network</h2>
<p>The Long Short-Term Memory network, or LSTM network, is a recurrent neural network that is trained using Backpropagation Through Time and overcomes the vanishing gradient problem.</p>
<p>As such, it can be used to create large recurrent networks that in turn can be used to address difficult sequence problems in machine learning and achieve state-of-the-art results.</p>
<p>Instead of neurons, LSTM networks have memory blocks that are connected through layers.</p>
<p>A block has components that make it smarter than a classical neuron and a memory for recent sequences. A block contains gates that manage the block’s state and output. A block&nbsp;operates upon an input sequence and each gate within a block&nbsp;uses the sigmoid activation units to control whether they are triggered or not, making the change of state and addition of information flowing through the block&nbsp;conditional.</p>
<p>There are three types of gates within a unit:</p>
<ul>
<li><strong>Forget Gate</strong>: conditionally decides what information to throw away from the block.</li>
<li><strong>Input Gate</strong>: conditionally decides which values from the input to update the memory state.</li>
<li><strong>Output Gate</strong>: conditionally decides what to output based on input and the memory of the block.</li>
</ul>
<p>Each unit is like a mini-state machine where the gates of the units have weights that are learned during the training procedure.</p>
<p>You can see how you may achieve sophisticated learning and memory from a layer of LSTMs, and it is not hard to imagine&nbsp;how higher-order abstractions may be layered with multiple such layers.</p>
<h2>LSTM Network for Regression</h2>
<p>We can phrase the problem as a regression problem.</p>
<p>That is, given the number of passengers (in units of thousands) this month, what is the number of passengers next month?</p>
<p>We can write a simple function to convert our single column of data into a two-column dataset: the first column containing this month’s (t) passenger count and the second column containing next month’s (t+1) passenger count, to be predicted.</p>
<p>Before we get started, let’s first import all of the functions and classes we intend to use. This assumes a working SciPy environment with the Keras deep learning library installed.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa469d596315809" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">import numpy
import matplotlib.pyplot as plt
import pandas
import math
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa469d596315809-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa469d596315809-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa469d596315809-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa469d596315809-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa469d596315809-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa469d596315809-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa469d596315809-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa469d596315809-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa469d596315809-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa469d596315809-1"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa469d596315809-2"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="crayon-5906e65aa469d596315809-3"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa469d596315809-4"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line" id="crayon-5906e65aa469d596315809-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa469d596315809-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5906e65aa469d596315809-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa469d596315809-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line" id="crayon-5906e65aa469d596315809-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-v">mean_squared_error</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Before we do anything, it is a good idea to fix the random number seed to ensure our results are reproducible.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa469f271177727" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># fix random seed for reproducibility
numpy.random.seed(7)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa469f271177727-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa469f271177727-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa469f271177727-1"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa469f271177727-2"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can also use the code from the previous section to load the dataset as a Pandas dataframe. We can then extract the NumPy&nbsp;array from the dataframe and convert the integer values to floating point values, which are more suitable for modeling with a&nbsp;neural network.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46a1294443438" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load the dataset
dataframe = pandas.read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
dataset = dataframe.values
dataset = dataset.astype('float32')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46a1294443438-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a1294443438-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46a1294443438-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a1294443438-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46a1294443438-1"><span class="crayon-p"># load the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a1294443438-2"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46a1294443438-3"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a1294443438-4"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>LSTMs are sensitive to the scale of the input data, specifically when the sigmoid (default) or tanh activation functions are used. It can be a good practice to rescale the data to the range of 0-to-1, also called normalizing. We can easily normalize the dataset using the <strong>MinMaxScaler</strong> preprocessing class from the scikit-learn library.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46a3453357077" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># normalize the dataset
scaler = MinMaxScaler(feature_range=(0, 1))
dataset = scaler.fit_transform(dataset)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46a3453357077-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a3453357077-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46a3453357077-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46a3453357077-1"><span class="crayon-p"># normalize the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a3453357077-2"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46a3453357077-3"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>After we model our data and estimate the skill of our model on the training dataset, we need to get an idea of the skill of the model on new unseen data. For a normal classification or regression problem, we would do this using cross validation.</p>
<p>With time series data, the sequence of values is important. A simple method that we can use is to split the ordered dataset into train and test datasets. The code below calculates the index of the split point and separates the data into the training datasets with 67% of the observations that we can use to train our model, leaving the remaining 33% for testing the model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46a5699476027" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split into train and test sets
train_size = int(len(dataset) * 0.67)
test_size = len(dataset) - train_size
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]
print(len(train), len(test))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46a5699476027-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a5699476027-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46a5699476027-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a5699476027-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46a5699476027-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46a5699476027-1"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a5699476027-2"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46a5699476027-3"><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train_size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a5699476027-4"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5906e65aa46a5699476027-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Now we can define a function to create a new dataset, as described above.</p>
<p>The function takes two arguments: the <strong>dataset</strong>, which is a NumPy&nbsp;array that we want to convert into a dataset, and the <strong>look_back</strong>, which is the number of previous time steps to use as input variables to predict the next time period — in this case defaulted to 1.</p>
<p>This default will create a dataset where X is the number of passengers at a given time (t) and Y is the number of passengers at the next time (t + 1).</p>
<p>It can be configured, and we will by&nbsp;constructing a differently shaped dataset in the next section.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46a7139338613" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># convert an array of values into a dataset matrix
def create_dataset(dataset, look_back=1):
	dataX, dataY = [], []
	for i in range(len(dataset)-look_back-1):
		a = dataset[i:(i+look_back), 0]
		dataX.append(a)
		dataY.append(dataset[i + look_back, 0])
	return numpy.array(dataX), numpy.array(dataY)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46a7139338613-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a7139338613-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46a7139338613-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a7139338613-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46a7139338613-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a7139338613-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46a7139338613-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a7139338613-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46a7139338613-1"><span class="crayon-p"># convert an array of values into a dataset matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a7139338613-2"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46a7139338613-3"><span class="crayon-h">	</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a7139338613-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">look_back</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46a7139338613-5"><span class="crayon-h">		</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a7139338613-6"><span class="crayon-h">		</span><span class="crayon-v">dataX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46a7139338613-7"><span class="crayon-h">		</span><span class="crayon-v">dataY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a7139338613-8"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataY</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Let’s take a look at the effect of this function on the first rows of the dataset (shown in the unnormalized form for clarity).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46a9828291635" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">X		Y
112		118
118		132
132		129
129		121
121		135</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46a9828291635-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a9828291635-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46a9828291635-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a9828291635-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46a9828291635-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46a9828291635-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46a9828291635-1">X		Y</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a9828291635-2">112		118</div><div class="crayon-line" id="crayon-5906e65aa46a9828291635-3">118		132</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a9828291635-4">132		129</div><div class="crayon-line" id="crayon-5906e65aa46a9828291635-5">129		121</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46a9828291635-6">121		135</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p><span style="line-height: 1.5;">If you compare these first 5 rows to the original dataset sample listed in the previous section, you can see the X=t and Y=t+1 pattern in the numbers.</span></p>
<p>Let’s use this function to prepare the train and test datasets for modeling.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46ab838928338" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># reshape into X=t and Y=t+1
look_back = 1
trainX, trainY = create_dataset(train, look_back)
testX, testY = create_dataset(test, look_back)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46ab838928338-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46ab838928338-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46ab838928338-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46ab838928338-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46ab838928338-1"><span class="crayon-p"># reshape into X=t and Y=t+1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46ab838928338-2"><span class="crayon-v">look_back</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5906e65aa46ab838928338-3"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46ab838928338-4"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The LSTM network expects the input data (X) to be provided with a specific array structure in the form of: <em>[samples, time steps, features]</em>.</p>
<p>Currently, our data is in the form: [<em>samples, features</em>] and we are framing the problem as one time step for each sample. We can transform the prepared train and test input data into the expected structure using <strong>numpy.reshape()</strong> as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46ad912466622" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># reshape input to be [samples, time steps, features]
trainX = numpy.reshape(trainX, (trainX.shape[0], 1, trainX.shape[1]))
testX = numpy.reshape(testX, (testX.shape[0], 1, testX.shape[1]))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46ad912466622-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46ad912466622-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46ad912466622-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46ad912466622-1"><span class="crayon-p"># reshape input to be [samples, time steps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46ad912466622-2"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46ad912466622-3"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We are now ready to design and fit our LSTM network for this problem.</p>
<p>The network has a visible layer with 1 input, a hidden layer with 4 LSTM blocks or neurons, and an output layer that makes a single value prediction. The default sigmoid activation function is used for the LSTM blocks. The network is trained for 100 epochs and a batch size of 1 is used.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46af816251951" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># create and fit the LSTM network
model = Sequential()
model.add(LSTM(4, input_shape=(1, look_back)))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')
model.fit(trainX, trainY, epochs=100, batch_size=1, verbose=2)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46af816251951-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46af816251951-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46af816251951-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46af816251951-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46af816251951-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46af816251951-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46af816251951-1"><span class="crayon-p"># create and fit the LSTM network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46af816251951-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46af816251951-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46af816251951-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46af816251951-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46af816251951-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Once the model is fit, we can estimate the performance of the model on the train and test datasets. This will give us a point of comparison for new models.</p>
<p>Note that we invert the predictions before calculating error scores to ensure that performance is reported in the same units as the original data (thousands of passengers per month).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46b1369582080" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># make predictions
trainPredict = model.predict(trainX)
testPredict = model.predict(testX)
# invert predictions
trainPredict = scaler.inverse_transform(trainPredict)
trainY = scaler.inverse_transform([trainY])
testPredict = scaler.inverse_transform(testPredict)
testY = scaler.inverse_transform([testY])
# calculate root mean squared error
trainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))
print('Train Score: %.2f RMSE' % (trainScore))
testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))
print('Test Score: %.2f RMSE' % (testScore))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46b1369582080-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b1369582080-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46b1369582080-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b1369582080-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46b1369582080-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b1369582080-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46b1369582080-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b1369582080-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46b1369582080-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b1369582080-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46b1369582080-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b1369582080-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46b1369582080-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46b1369582080-1"><span class="crayon-p"># make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b1369582080-2"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b1369582080-3"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b1369582080-4"><span class="crayon-p"># invert predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46b1369582080-5"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b1369582080-6"><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">trainY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b1369582080-7"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">testPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b1369582080-8"><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">testY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b1369582080-9"><span class="crayon-p"># calculate root mean squared error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b1369582080-10"><span class="crayon-v">trainScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b1369582080-11"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b1369582080-12"><span class="crayon-v">testScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b1369582080-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Finally, we can generate predictions using the model for both the train and test dataset to get a visual indication of the skill of the model.</p>
<p>Because of how the dataset was prepared, we must shift the predictions so that they align on the x-axis with the original dataset. Once prepared, the data is plotted, showing the original dataset in blue, the predictions for the training dataset in green, and the predictions on the unseen test dataset in red.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46b3051697172" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># shift train predictions for plotting
trainPredictPlot = numpy.empty_like(dataset)
trainPredictPlot[:, :] = numpy.nan
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict
# shift test predictions for plotting
testPredictPlot = numpy.empty_like(dataset)
testPredictPlot[:, :] = numpy.nan
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict
# plot baseline and predictions
plt.plot(scaler.inverse_transform(dataset))
plt.plot(trainPredictPlot)
plt.plot(testPredictPlot)
plt.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46b3051697172-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b3051697172-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46b3051697172-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b3051697172-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46b3051697172-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b3051697172-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46b3051697172-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b3051697172-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46b3051697172-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b3051697172-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46b3051697172-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b3051697172-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46b3051697172-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46b3051697172-1"><span class="crayon-p"># shift train predictions for plotting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b3051697172-2"><span class="crayon-v">trainPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b3051697172-3"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b3051697172-4"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-v">look_back</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span></div><div class="crayon-line" id="crayon-5906e65aa46b3051697172-5"><span class="crayon-p"># shift test predictions for plotting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b3051697172-6"><span class="crayon-v">testPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b3051697172-7"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b3051697172-8"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">look_back*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span></div><div class="crayon-line" id="crayon-5906e65aa46b3051697172-9"><span class="crayon-p"># plot baseline and predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b3051697172-10"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b3051697172-11"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b3051697172-12"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b3051697172-13"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>We can see that the model did an excellent job of fitting both the training and the test datasets.</p>
<div id="attachment_3303" style="width: 810px" class="wp-caption aligncenter"><img class="size-full wp-image-3303" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/LSTM-Trained-on-Regression-Formulation-of-Passenger-Prediction-Problem-1.png" alt="LSTM Trained on Regression Formulation of Passenger Prediction Problem" width="800" height="600" srcset="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Trained-on-Regression-Formulation-of-Passenger-Prediction-Problem-1.png 800w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Trained-on-Regression-Formulation-of-Passenger-Prediction-Problem-1-300x225.png 300w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Trained-on-Regression-Formulation-of-Passenger-Prediction-Problem-1-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p class="wp-caption-text">LSTM Trained on Regression Formulation of Passenger Prediction Problem</p></div>
<p>For completeness, below is the entire code example.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46b6924721296" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># LSTM for international airline passengers problem with regression framing
import numpy
import matplotlib.pyplot as plt
from pandas import read_csv
import math
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error
# convert an array of values into a dataset matrix
def create_dataset(dataset, look_back=1):
	dataX, dataY = [], []
	for i in range(len(dataset)-look_back-1):
		a = dataset[i:(i+look_back), 0]
		dataX.append(a)
		dataY.append(dataset[i + look_back, 0])
	return numpy.array(dataX), numpy.array(dataY)
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset
dataframe = read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
dataset = dataframe.values
dataset = dataset.astype('float32')
# normalize the dataset
scaler = MinMaxScaler(feature_range=(0, 1))
dataset = scaler.fit_transform(dataset)
# split into train and test sets
train_size = int(len(dataset) * 0.67)
test_size = len(dataset) - train_size
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]
# reshape into X=t and Y=t+1
look_back = 1
trainX, trainY = create_dataset(train, look_back)
testX, testY = create_dataset(test, look_back)
# reshape input to be [samples, time steps, features]
trainX = numpy.reshape(trainX, (trainX.shape[0], 1, trainX.shape[1]))
testX = numpy.reshape(testX, (testX.shape[0], 1, testX.shape[1]))
# create and fit the LSTM network
model = Sequential()
model.add(LSTM(4, input_shape=(1, look_back)))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')
model.fit(trainX, trainY, epochs=100, batch_size=1, verbose=2)
# make predictions
trainPredict = model.predict(trainX)
testPredict = model.predict(testX)
# invert predictions
trainPredict = scaler.inverse_transform(trainPredict)
trainY = scaler.inverse_transform([trainY])
testPredict = scaler.inverse_transform(testPredict)
testY = scaler.inverse_transform([testY])
# calculate root mean squared error
trainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))
print('Train Score: %.2f RMSE' % (trainScore))
testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))
print('Test Score: %.2f RMSE' % (testScore))
# shift train predictions for plotting
trainPredictPlot = numpy.empty_like(dataset)
trainPredictPlot[:, :] = numpy.nan
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict
# shift test predictions for plotting
testPredictPlot = numpy.empty_like(dataset)
testPredictPlot[:, :] = numpy.nan
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict
# plot baseline and predictions
plt.plot(scaler.inverse_transform(dataset))
plt.plot(trainPredictPlot)
plt.plot(testPredictPlot)
plt.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-14">14</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-16">16</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-18">18</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-20">20</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-22">22</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-24">24</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-26">26</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-28">28</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-30">30</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-32">32</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-34">34</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-36">36</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-38">38</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-40">40</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-42">42</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-44">44</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-46">46</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-48">48</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-50">50</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-52">52</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-54">54</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-56">56</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-58">58</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-60">60</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-62">62</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-64">64</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-66">66</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-68">68</div><div class="crayon-num" data-line="crayon-5906e65aa46b6924721296-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b6924721296-70">70</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46b6924721296-1"><span class="crayon-p"># LSTM for international airline passengers problem with regression framing</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-3"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-5"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-v">mean_squared_error</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-11"><span class="crayon-p"># convert an array of values into a dataset matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-12"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-13"><span class="crayon-h">	</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-14"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">look_back</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-15"><span class="crayon-h">		</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-16"><span class="crayon-h">		</span><span class="crayon-v">dataX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-17"><span class="crayon-h">		</span><span class="crayon-v">dataY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-19"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-20"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-21"><span class="crayon-p"># load the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-22"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-24"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-25"><span class="crayon-p"># normalize the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-26"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-27"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-28"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-29"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-30"><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train_size</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-31"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-32"><span class="crayon-p"># reshape into X=t and Y=t+1</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-33"><span class="crayon-v">look_back</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-34"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-35"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-36"><span class="crayon-p"># reshape input to be [samples, time steps, features]</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-37"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-38"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-39"><span class="crayon-p"># create and fit the LSTM network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-40"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-45"><span class="crayon-p"># make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-46"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-47"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-48"><span class="crayon-p"># invert predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-49"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-50"><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">trainY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-51"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">testPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-52"><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">testY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-53"><span class="crayon-p"># calculate root mean squared error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-54"><span class="crayon-v">trainScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-55"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-56"><span class="crayon-v">testScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-57"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-58"><span class="crayon-p"># shift train predictions for plotting</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-59"><span class="crayon-v">trainPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-60"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-61"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-v">look_back</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-62"><span class="crayon-p"># shift test predictions for plotting</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-63"><span class="crayon-v">testPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-64"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-65"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">look_back*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-66"><span class="crayon-p"># plot baseline and predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-67"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-68"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46b6924721296-69"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b6924721296-70"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p>Running the example produces the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46b9275221958" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">...
Epoch 95/100
0s - loss: 0.0020
Epoch 96/100
0s - loss: 0.0020
Epoch 97/100
0s - loss: 0.0020
Epoch 98/100
0s - loss: 0.0020
Epoch 99/100
0s - loss: 0.0020
Epoch 100/100
0s - loss: 0.0020
Train Score: 22.93 RMSE
Test Score: 47.53 RMSE</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46b9275221958-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b9275221958-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46b9275221958-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b9275221958-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46b9275221958-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b9275221958-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46b9275221958-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b9275221958-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46b9275221958-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b9275221958-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46b9275221958-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b9275221958-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46b9275221958-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46b9275221958-14">14</div><div class="crayon-num" data-line="crayon-5906e65aa46b9275221958-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46b9275221958-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b9275221958-2">Epoch 95/100</div><div class="crayon-line" id="crayon-5906e65aa46b9275221958-3">0s - loss: 0.0020</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b9275221958-4">Epoch 96/100</div><div class="crayon-line" id="crayon-5906e65aa46b9275221958-5">0s - loss: 0.0020</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b9275221958-6">Epoch 97/100</div><div class="crayon-line" id="crayon-5906e65aa46b9275221958-7">0s - loss: 0.0020</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b9275221958-8">Epoch 98/100</div><div class="crayon-line" id="crayon-5906e65aa46b9275221958-9">0s - loss: 0.0020</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b9275221958-10">Epoch 99/100</div><div class="crayon-line" id="crayon-5906e65aa46b9275221958-11">0s - loss: 0.0020</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b9275221958-12">Epoch 100/100</div><div class="crayon-line" id="crayon-5906e65aa46b9275221958-13">0s - loss: 0.0020</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46b9275221958-14">Train Score: 22.93 RMSE</div><div class="crayon-line" id="crayon-5906e65aa46b9275221958-15">Test Score: 47.53 RMSE</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that the model has an average error of about 23 passengers (in thousands) on the training dataset, and about 52 passengers (in thousands) on the test dataset. Not that bad.</p>
<h2>LSTM for Regression Using&nbsp;the Window Method</h2>
<p>We can also phrase the problem so that multiple, recent time steps can be used to make the prediction for the next time step.</p>
<p>This is called a window, and the size of the window is a parameter that can be tuned for each problem.</p>
<p>For example, given the current time (t) we want to predict the value at the next time in the sequence (t+1), we can use the current time (t), as well as the two prior times (t-1 and t-2) as input variables.</p>
<p>When phrased as a regression problem, the input variables are t-2, t-1, t and the output variable is t+1.</p>
<p>The <strong>create_dataset()</strong> function we created in the previous section allows us to create this formulation of the time series problem by increasing the <strong>look_back</strong> argument from 1 to 3.</p>
<p>A sample of the dataset with this formulation looks as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46bc543766709" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">X1	X2	X3	Y
112	118	132	129
118	132	129	121
132	129	121	135
129	121	135	148
121	135	148	148</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46bc543766709-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46bc543766709-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46bc543766709-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46bc543766709-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46bc543766709-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46bc543766709-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46bc543766709-1">X1	X2	X3	Y</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46bc543766709-2">112	118	132	129</div><div class="crayon-line" id="crayon-5906e65aa46bc543766709-3">118	132	129	121</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46bc543766709-4">132	129	121	135</div><div class="crayon-line" id="crayon-5906e65aa46bc543766709-5">129	121	135	148</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46bc543766709-6">121	135	148	148</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can re-run the example in the previous section with the larger window size. The whole code listing with just the window size change is listed below for completeness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46be843649752" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># LSTM for international airline passengers problem with window regression framing
import numpy
import matplotlib.pyplot as plt
from pandas import read_csv
import math
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error
# convert an array of values into a dataset matrix
def create_dataset(dataset, look_back=1):
	dataX, dataY = [], []
	for i in range(len(dataset)-look_back-1):
		a = dataset[i:(i+look_back), 0]
		dataX.append(a)
		dataY.append(dataset[i + look_back, 0])
	return numpy.array(dataX), numpy.array(dataY)
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset
dataframe = read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
dataset = dataframe.values
dataset = dataset.astype('float32')
# normalize the dataset
scaler = MinMaxScaler(feature_range=(0, 1))
dataset = scaler.fit_transform(dataset)
# split into train and test sets
train_size = int(len(dataset) * 0.67)
test_size = len(dataset) - train_size
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]
# reshape into X=t and Y=t+1
look_back = 3
trainX, trainY = create_dataset(train, look_back)
testX, testY = create_dataset(test, look_back)
# reshape input to be [samples, time steps, features]
trainX = numpy.reshape(trainX, (trainX.shape[0], 1, trainX.shape[1]))
testX = numpy.reshape(testX, (testX.shape[0], 1, testX.shape[1]))
# create and fit the LSTM network
model = Sequential()
model.add(LSTM(4, input_shape=(1, look_back)))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')
model.fit(trainX, trainY, epochs=100, batch_size=1, verbose=2)
# make predictions
trainPredict = model.predict(trainX)
testPredict = model.predict(testX)
# invert predictions
trainPredict = scaler.inverse_transform(trainPredict)
trainY = scaler.inverse_transform([trainY])
testPredict = scaler.inverse_transform(testPredict)
testY = scaler.inverse_transform([testY])
# calculate root mean squared error
trainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))
print('Train Score: %.2f RMSE' % (trainScore))
testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))
print('Test Score: %.2f RMSE' % (testScore))
# shift train predictions for plotting
trainPredictPlot = numpy.empty_like(dataset)
trainPredictPlot[:, :] = numpy.nan
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict
# shift test predictions for plotting
testPredictPlot = numpy.empty_like(dataset)
testPredictPlot[:, :] = numpy.nan
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict
# plot baseline and predictions
plt.plot(scaler.inverse_transform(dataset))
plt.plot(trainPredictPlot)
plt.plot(testPredictPlot)
plt.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-14">14</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-16">16</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-18">18</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-20">20</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-22">22</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-24">24</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-26">26</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-28">28</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-30">30</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-32">32</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-34">34</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-36">36</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-38">38</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-40">40</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-42">42</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-44">44</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-46">46</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-48">48</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-50">50</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-52">52</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-54">54</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-56">56</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-58">58</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-60">60</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-62">62</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-64">64</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-66">66</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-68">68</div><div class="crayon-num" data-line="crayon-5906e65aa46be843649752-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46be843649752-70">70</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46be843649752-1"><span class="crayon-p"># LSTM for international airline passengers problem with window regression framing</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-3"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-5"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-v">mean_squared_error</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-11"><span class="crayon-p"># convert an array of values into a dataset matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-12"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-13"><span class="crayon-h">	</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-14"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">look_back</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-15"><span class="crayon-h">		</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-16"><span class="crayon-h">		</span><span class="crayon-v">dataX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-17"><span class="crayon-h">		</span><span class="crayon-v">dataY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-19"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-20"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-21"><span class="crayon-p"># load the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-22"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-24"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-25"><span class="crayon-p"># normalize the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-26"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-27"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-28"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-29"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-30"><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train_size</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-31"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-32"><span class="crayon-p"># reshape into X=t and Y=t+1</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-33"><span class="crayon-v">look_back</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-34"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-35"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-36"><span class="crayon-p"># reshape input to be [samples, time steps, features]</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-37"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-38"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-39"><span class="crayon-p"># create and fit the LSTM network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-40"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-45"><span class="crayon-p"># make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-46"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-47"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-48"><span class="crayon-p"># invert predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-49"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-50"><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">trainY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-51"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">testPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-52"><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">testY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-53"><span class="crayon-p"># calculate root mean squared error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-54"><span class="crayon-v">trainScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-55"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-56"><span class="crayon-v">testScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-57"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-58"><span class="crayon-p"># shift train predictions for plotting</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-59"><span class="crayon-v">trainPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-60"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-61"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-v">look_back</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-62"><span class="crayon-p"># shift test predictions for plotting</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-63"><span class="crayon-v">testPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-64"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-65"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">look_back*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-66"><span class="crayon-p"># plot baseline and predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-67"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-68"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46be843649752-69"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46be843649752-70"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0041 seconds] -->
<p>Running the example provides the following output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46c2670557170" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">...
Epoch 95/100
0s - loss: 0.0021
Epoch 96/100
0s - loss: 0.0021
Epoch 97/100
0s - loss: 0.0021
Epoch 98/100
0s - loss: 0.0021
Epoch 99/100
0s - loss: 0.0022
Epoch 100/100
0s - loss: 0.0020
Train Score: 24.19 RMSE
Test Score: 58.03 RMSE</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46c2670557170-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46c2670557170-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46c2670557170-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46c2670557170-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46c2670557170-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46c2670557170-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46c2670557170-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46c2670557170-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46c2670557170-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46c2670557170-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46c2670557170-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46c2670557170-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46c2670557170-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46c2670557170-14">14</div><div class="crayon-num" data-line="crayon-5906e65aa46c2670557170-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46c2670557170-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46c2670557170-2">Epoch 95/100</div><div class="crayon-line" id="crayon-5906e65aa46c2670557170-3">0s - loss: 0.0021</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46c2670557170-4">Epoch 96/100</div><div class="crayon-line" id="crayon-5906e65aa46c2670557170-5">0s - loss: 0.0021</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46c2670557170-6">Epoch 97/100</div><div class="crayon-line" id="crayon-5906e65aa46c2670557170-7">0s - loss: 0.0021</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46c2670557170-8">Epoch 98/100</div><div class="crayon-line" id="crayon-5906e65aa46c2670557170-9">0s - loss: 0.0021</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46c2670557170-10">Epoch 99/100</div><div class="crayon-line" id="crayon-5906e65aa46c2670557170-11">0s - loss: 0.0022</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46c2670557170-12">Epoch 100/100</div><div class="crayon-line" id="crayon-5906e65aa46c2670557170-13">0s - loss: 0.0020</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46c2670557170-14">Train Score: 24.19 RMSE</div><div class="crayon-line" id="crayon-5906e65aa46c2670557170-15">Test Score: 58.03 RMSE</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that the error was increased slightly compared to that of the previous section. The window size and the network architecture were not tuned: this is just a demonstration of how to frame a prediction problem.</p>
<div id="attachment_3304" style="width: 810px" class="wp-caption aligncenter"><img class="size-full wp-image-3304" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/LSTM-Regression-Window-1.png" alt="LSTM Trained on Window Method Formulation of Passenger Prediction Problem" width="800" height="600" srcset="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Regression-Window-1.png 800w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Regression-Window-1-300x225.png 300w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Regression-Window-1-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p class="wp-caption-text">LSTM Trained on Window Method Formulation of Passenger Prediction Problem</p></div>
<h2>LSTM for Regression with Time Steps</h2>
<p>You may have noticed that the data preparation for the LSTM network includes time steps.</p>
<p>Some sequence problems may have a varied number of time steps per sample. For example, you may have measurements of a physical&nbsp;machine leading up to a point of failure or a point of surge. Each incident would be a sample the observations that lead up to the event would be the time steps, and the variables observed would be the features.</p>
<p>Time steps provide another way to phrase our time series problem. Like above in the window example, we can take prior time steps in our time series as inputs to predict the output at the next time step.</p>
<p>Instead of phrasing the past observations as separate input features, we can use them as time steps of the one input feature, which is indeed a more&nbsp;accurate framing of the problem.</p>
<p>We can do this using the same data representation as in the previous window-based example, except when we reshape the data, we set the columns to be the time steps dimension and change the features dimension back to 1. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46c4298386163" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># reshape input to be [samples, time steps, features]
trainX = numpy.reshape(trainX, (trainX.shape[0], trainX.shape[1], 1))
testX = numpy.reshape(testX, (testX.shape[0], testX.shape[1], 1))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46c4298386163-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46c4298386163-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46c4298386163-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46c4298386163-1"><span class="crayon-p"># reshape input to be [samples, time steps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46c4298386163-2"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46c4298386163-3"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The entire code listing is provided below for completeness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46cb587114688" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># LSTM for international airline passengers problem with time step regression framing
import numpy
import matplotlib.pyplot as plt
from pandas import read_csv
import math
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error
# convert an array of values into a dataset matrix
def create_dataset(dataset, look_back=1):
	dataX, dataY = [], []
	for i in range(len(dataset)-look_back-1):
		a = dataset[i:(i+look_back), 0]
		dataX.append(a)
		dataY.append(dataset[i + look_back, 0])
	return numpy.array(dataX), numpy.array(dataY)
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset
dataframe = read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
dataset = dataframe.values
dataset = dataset.astype('float32')
# normalize the dataset
scaler = MinMaxScaler(feature_range=(0, 1))
dataset = scaler.fit_transform(dataset)
# split into train and test sets
train_size = int(len(dataset) * 0.67)
test_size = len(dataset) - train_size
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]
# reshape into X=t and Y=t+1
look_back = 3
trainX, trainY = create_dataset(train, look_back)
testX, testY = create_dataset(test, look_back)
# reshape input to be [samples, time steps, features]
trainX = numpy.reshape(trainX, (trainX.shape[0], trainX.shape[1], 1))
testX = numpy.reshape(testX, (testX.shape[0], testX.shape[1], 1))
# create and fit the LSTM network
model = Sequential()
model.add(LSTM(4, input_shape=(look_back, 1)))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')
model.fit(trainX, trainY, epochs=100, batch_size=1, verbose=2)
# make predictions
trainPredict = model.predict(trainX)
testPredict = model.predict(testX)
# invert predictions
trainPredict = scaler.inverse_transform(trainPredict)
trainY = scaler.inverse_transform([trainY])
testPredict = scaler.inverse_transform(testPredict)
testY = scaler.inverse_transform([testY])
# calculate root mean squared error
trainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))
print('Train Score: %.2f RMSE' % (trainScore))
testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))
print('Test Score: %.2f RMSE' % (testScore))
# shift train predictions for plotting
trainPredictPlot = numpy.empty_like(dataset)
trainPredictPlot[:, :] = numpy.nan
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict
# shift test predictions for plotting
testPredictPlot = numpy.empty_like(dataset)
testPredictPlot[:, :] = numpy.nan
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict
# plot baseline and predictions
plt.plot(scaler.inverse_transform(dataset))
plt.plot(trainPredictPlot)
plt.plot(testPredictPlot)
plt.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-14">14</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-16">16</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-18">18</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-20">20</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-22">22</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-24">24</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-26">26</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-28">28</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-30">30</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-32">32</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-34">34</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-36">36</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-38">38</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-40">40</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-42">42</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-44">44</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-46">46</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-48">48</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-50">50</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-52">52</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-54">54</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-56">56</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-58">58</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-60">60</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-62">62</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-64">64</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-66">66</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-68">68</div><div class="crayon-num" data-line="crayon-5906e65aa46cb587114688-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cb587114688-70">70</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46cb587114688-1"><span class="crayon-p"># LSTM for international airline passengers problem with time step regression framing</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-3"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-5"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-v">mean_squared_error</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-11"><span class="crayon-p"># convert an array of values into a dataset matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-12"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-13"><span class="crayon-h">	</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-14"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">look_back</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-15"><span class="crayon-h">		</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-16"><span class="crayon-h">		</span><span class="crayon-v">dataX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-17"><span class="crayon-h">		</span><span class="crayon-v">dataY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-19"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-20"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-21"><span class="crayon-p"># load the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-22"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-24"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-25"><span class="crayon-p"># normalize the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-26"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-27"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-28"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-29"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-30"><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train_size</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-31"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-32"><span class="crayon-p"># reshape into X=t and Y=t+1</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-33"><span class="crayon-v">look_back</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-34"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-35"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-36"><span class="crayon-p"># reshape input to be [samples, time steps, features]</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-37"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-38"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-39"><span class="crayon-p"># create and fit the LSTM network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-40"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-45"><span class="crayon-p"># make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-46"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-47"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-48"><span class="crayon-p"># invert predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-49"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-50"><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">trainY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-51"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">testPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-52"><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">testY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-53"><span class="crayon-p"># calculate root mean squared error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-54"><span class="crayon-v">trainScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-55"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-56"><span class="crayon-v">testScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-57"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-58"><span class="crayon-p"># shift train predictions for plotting</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-59"><span class="crayon-v">trainPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-60"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-61"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-v">look_back</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-62"><span class="crayon-p"># shift test predictions for plotting</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-63"><span class="crayon-v">testPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-64"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-65"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">look_back*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-66"><span class="crayon-p"># plot baseline and predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-67"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-68"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46cb587114688-69"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cb587114688-70"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0039 seconds] -->
<p>Running the example provides the following output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46cf240468894" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">...
Epoch 95/100
1s - loss: 0.0021
Epoch 96/100
1s - loss: 0.0021
Epoch 97/100
1s - loss: 0.0021
Epoch 98/100
1s - loss: 0.0020
Epoch 99/100
1s - loss: 0.0021
Epoch 100/100
1s - loss: 0.0020
Train Score: 23.69 RMSE
Test Score: 58.88 RMSE</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46cf240468894-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cf240468894-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46cf240468894-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cf240468894-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46cf240468894-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cf240468894-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46cf240468894-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cf240468894-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46cf240468894-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cf240468894-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46cf240468894-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cf240468894-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46cf240468894-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46cf240468894-14">14</div><div class="crayon-num" data-line="crayon-5906e65aa46cf240468894-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46cf240468894-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cf240468894-2">Epoch 95/100</div><div class="crayon-line" id="crayon-5906e65aa46cf240468894-3">1s - loss: 0.0021</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cf240468894-4">Epoch 96/100</div><div class="crayon-line" id="crayon-5906e65aa46cf240468894-5">1s - loss: 0.0021</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cf240468894-6">Epoch 97/100</div><div class="crayon-line" id="crayon-5906e65aa46cf240468894-7">1s - loss: 0.0021</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cf240468894-8">Epoch 98/100</div><div class="crayon-line" id="crayon-5906e65aa46cf240468894-9">1s - loss: 0.0020</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cf240468894-10">Epoch 99/100</div><div class="crayon-line" id="crayon-5906e65aa46cf240468894-11">1s - loss: 0.0021</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cf240468894-12">Epoch 100/100</div><div class="crayon-line" id="crayon-5906e65aa46cf240468894-13">1s - loss: 0.0020</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46cf240468894-14">Train Score: 23.69 RMSE</div><div class="crayon-line" id="crayon-5906e65aa46cf240468894-15">Test Score: 58.88 RMSE</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that the results are slightly better than previous example, although the structure of the input data makes a lot more sense.</p>
<div id="attachment_3305" style="width: 810px" class="wp-caption aligncenter"><img class="size-full wp-image-3305" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/LSTM-Regression-Time-Steps-1.png" alt="LSTM Trained on Time Step Formulation of Passenger Prediction Problem" width="800" height="600" srcset="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Regression-Time-Steps-1.png 800w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Regression-Time-Steps-1-300x225.png 300w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Regression-Time-Steps-1-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p class="wp-caption-text">LSTM Trained on Time Step Formulation of Passenger Prediction Problem</p></div>
<h2>LSTM with Memory Between&nbsp;Batches</h2>
<p>The LSTM network has memory, which is capable of remembering across long sequences.</p>
<p>Normally, the state within the network is reset after each training batch when fitting the model, as well as each call to <strong>model.predict()</strong> or <strong>model.evaluate()</strong>.</p>
<p>We can gain finer control over when the internal state of the LSTM network is cleared in Keras by making the LSTM layer “stateful”. This means that it can build state over the entire training sequence and even maintain that state if needed to make predictions.</p>
<p>It requires that the training data not be shuffled when fitting the network. It also requires explicit resetting of the network state after each exposure to the training data (epoch) by calls to <strong>model.reset_states()</strong>. This means that we must create our own outer loop of epochs and within each epoch call <strong>model.fit()</strong> and <strong>model.reset_states()</strong>. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46d2295677890" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">for i in range(100):
	model.fit(trainX, trainY, epochs=1, batch_size=batch_size, verbose=2, shuffle=False)
	model.reset_states()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46d2295677890-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d2295677890-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46d2295677890-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46d2295677890-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d2295677890-2"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d2295677890-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">reset_states</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Finally, when the LSTM layer is constructed, the <strong>stateful</strong> parameter must be set <strong>True</strong> and instead of specifying the input dimensions, we must hard code the number of samples in a batch, number of time steps in a sample and number of features in a time step by setting the <strong>batch_input_shape</strong> parameter. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46d4566979403" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.add(LSTM(4, batch_input_shape=(batch_size, time_steps, features), stateful=True))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46d4566979403-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46d4566979403-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">time_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>This same batch size must then be used later when evaluating the model and making predictions. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46d6529890200" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.predict(trainX, batch_size=batch_size)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46d6529890200-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46d6529890200-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can adapt the previous time step example to use a stateful LSTM. The full code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46d8569605720" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># LSTM for international airline passengers problem with memory
import numpy
import matplotlib.pyplot as plt
from pandas import read_csv
import math
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error
# convert an array of values into a dataset matrix
def create_dataset(dataset, look_back=1):
	dataX, dataY = [], []
	for i in range(len(dataset)-look_back-1):
		a = dataset[i:(i+look_back), 0]
		dataX.append(a)
		dataY.append(dataset[i + look_back, 0])
	return numpy.array(dataX), numpy.array(dataY)
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset
dataframe = read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
dataset = dataframe.values
dataset = dataset.astype('float32')
# normalize the dataset
scaler = MinMaxScaler(feature_range=(0, 1))
dataset = scaler.fit_transform(dataset)
# split into train and test sets
train_size = int(len(dataset) * 0.67)
test_size = len(dataset) - train_size
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]
# reshape into X=t and Y=t+1
look_back = 3
trainX, trainY = create_dataset(train, look_back)
testX, testY = create_dataset(test, look_back)
# reshape input to be [samples, time steps, features]
trainX = numpy.reshape(trainX, (trainX.shape[0], trainX.shape[1], 1))
testX = numpy.reshape(testX, (testX.shape[0], testX.shape[1], 1))
# create and fit the LSTM network
batch_size = 1
model = Sequential()
model.add(LSTM(4, batch_input_shape=(batch_size, look_back, 1), stateful=True))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')
for i in range(100):
	model.fit(trainX, trainY, epochs=1, batch_size=batch_size, verbose=2, shuffle=False)
	model.reset_states()
# make predictions
trainPredict = model.predict(trainX, batch_size=batch_size)
model.reset_states()
testPredict = model.predict(testX, batch_size=batch_size)
# invert predictions
trainPredict = scaler.inverse_transform(trainPredict)
trainY = scaler.inverse_transform([trainY])
testPredict = scaler.inverse_transform(testPredict)
testY = scaler.inverse_transform([testY])
# calculate root mean squared error
trainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))
print('Train Score: %.2f RMSE' % (trainScore))
testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))
print('Test Score: %.2f RMSE' % (testScore))
# shift train predictions for plotting
trainPredictPlot = numpy.empty_like(dataset)
trainPredictPlot[:, :] = numpy.nan
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict
# shift test predictions for plotting
testPredictPlot = numpy.empty_like(dataset)
testPredictPlot[:, :] = numpy.nan
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict
# plot baseline and predictions
plt.plot(scaler.inverse_transform(dataset))
plt.plot(trainPredictPlot)
plt.plot(testPredictPlot)
plt.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-14">14</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-16">16</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-18">18</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-20">20</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-22">22</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-24">24</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-26">26</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-28">28</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-30">30</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-32">32</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-34">34</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-36">36</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-38">38</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-40">40</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-42">42</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-44">44</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-46">46</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-48">48</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-50">50</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-52">52</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-54">54</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-56">56</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-58">58</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-60">60</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-62">62</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-64">64</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-66">66</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-68">68</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-70">70</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-72">72</div><div class="crayon-num" data-line="crayon-5906e65aa46d8569605720-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46d8569605720-74">74</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46d8569605720-1"><span class="crayon-p"># LSTM for international airline passengers problem with memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-3"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-5"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-v">mean_squared_error</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-11"><span class="crayon-p"># convert an array of values into a dataset matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-12"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-13"><span class="crayon-h">	</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-14"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">look_back</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-15"><span class="crayon-h">		</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-16"><span class="crayon-h">		</span><span class="crayon-v">dataX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-17"><span class="crayon-h">		</span><span class="crayon-v">dataY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-19"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-20"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-21"><span class="crayon-p"># load the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-22"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-24"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-25"><span class="crayon-p"># normalize the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-26"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-27"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-28"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-29"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-30"><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train_size</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-31"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-32"><span class="crayon-p"># reshape into X=t and Y=t+1</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-33"><span class="crayon-v">look_back</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-34"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-35"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-36"><span class="crayon-p"># reshape input to be [samples, time steps, features]</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-37"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-38"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-39"><span class="crayon-p"># create and fit the LSTM network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-40"><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-41"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-45"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-46"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">reset_states</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-48"><span class="crayon-p"># make predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-49"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-50"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">reset_states</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-51"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-52"><span class="crayon-p"># invert predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-53"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-54"><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">trainY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-55"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">testPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-56"><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">testY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-57"><span class="crayon-p"># calculate root mean squared error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-58"><span class="crayon-v">trainScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-59"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-60"><span class="crayon-v">testScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-61"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-62"><span class="crayon-p"># shift train predictions for plotting</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-63"><span class="crayon-v">trainPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-64"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-65"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-v">look_back</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-66"><span class="crayon-p"># shift test predictions for plotting</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-67"><span class="crayon-v">testPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-68"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-69"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">look_back*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-70"><span class="crayon-p"># plot baseline and predictions</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-71"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-72"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46d8569605720-73"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46d8569605720-74"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0041 seconds] -->
<p>Running the example provides the following output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46dc459455329" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">...
Epoch 1/1
1s - loss: 0.0017
Epoch 1/1
1s - loss: 0.0017
Epoch 1/1
1s - loss: 0.0017
Epoch 1/1
1s - loss: 0.0017
Epoch 1/1
1s - loss: 0.0017
Epoch 1/1
1s - loss: 0.0016
Train Score: 20.74 RMSE
Test Score: 52.23 RMSE</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46dc459455329-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46dc459455329-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46dc459455329-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46dc459455329-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46dc459455329-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46dc459455329-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46dc459455329-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46dc459455329-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46dc459455329-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46dc459455329-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46dc459455329-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46dc459455329-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46dc459455329-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46dc459455329-14">14</div><div class="crayon-num" data-line="crayon-5906e65aa46dc459455329-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46dc459455329-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46dc459455329-2">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46dc459455329-3">1s - loss: 0.0017</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46dc459455329-4">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46dc459455329-5">1s - loss: 0.0017</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46dc459455329-6">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46dc459455329-7">1s - loss: 0.0017</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46dc459455329-8">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46dc459455329-9">1s - loss: 0.0017</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46dc459455329-10">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46dc459455329-11">1s - loss: 0.0017</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46dc459455329-12">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46dc459455329-13">1s - loss: 0.0016</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46dc459455329-14">Train Score: 20.74 RMSE</div><div class="crayon-line" id="crayon-5906e65aa46dc459455329-15">Test Score: 52.23 RMSE</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We do see that results are worse. The model may need more modules and may need to be trained for more epochs to internalize the structure of the problem.</p>
<div id="attachment_3306" style="width: 810px" class="wp-caption aligncenter"><img class="size-full wp-image-3306" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/LSTM-Regression-Stateful-1.png" alt="Stateful LSTM Trained on Regression Formulation of Passenger Prediction Problem" width="800" height="600" srcset="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Regression-Stateful-1.png 800w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Regression-Stateful-1-300x225.png 300w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/LSTM-Regression-Stateful-1-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p class="wp-caption-text">Stateful LSTM Trained on Regression Formulation of Passenger Prediction Problem</p></div>
<h2>Stacked LSTMs with Memory Between Batches</h2>
<p>Finally, we will take a look at one of the big benefits of LSTMs: the fact that they can be successfully trained when stacked into deep network architectures.</p>
<p>LSTM networks can be stacked in Keras in the same way that other layer types can be stacked. One addition to the configuration that is required is that an LSTM layer prior to each subsequent LSTM layer must return the sequence. This can be done by setting the <strong>return_sequences</strong> parameter on the layer to <strong>True</strong>.</p>
<p>We can extend the stateful LSTM in the previous section to have two layers, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46de161571413" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.add(LSTM(4, batch_input_shape=(batch_size, look_back, 1), stateful=True, return_sequences=True))
model.add(LSTM(4, batch_input_shape=(batch_size, look_back, 1), stateful=True))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46de161571413-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46de161571413-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46de161571413-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46de161571413-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The entire code listing is provided below for completeness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46e1321573561" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Stacked LSTM for international airline passengers problem with memory
import numpy
import matplotlib.pyplot as plt
from pandas import read_csv
import math
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error
# convert an array of values into a dataset matrix
def create_dataset(dataset, look_back=1):
	dataX, dataY = [], []
	for i in range(len(dataset)-look_back-1):
		a = dataset[i:(i+look_back), 0]
		dataX.append(a)
		dataY.append(dataset[i + look_back, 0])
	return numpy.array(dataX), numpy.array(dataY)
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset
dataframe = read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
dataset = dataframe.values
dataset = dataset.astype('float32')
# normalize the dataset
scaler = MinMaxScaler(feature_range=(0, 1))
dataset = scaler.fit_transform(dataset)
# split into train and test sets
train_size = int(len(dataset) * 0.67)
test_size = len(dataset) - train_size
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]
# reshape into X=t and Y=t+1
look_back = 3
trainX, trainY = create_dataset(train, look_back)
testX, testY = create_dataset(test, look_back)
# reshape input to be [samples, time steps, features]
trainX = numpy.reshape(trainX, (trainX.shape[0], trainX.shape[1], 1))
testX = numpy.reshape(testX, (testX.shape[0], testX.shape[1], 1))
# create and fit the LSTM network
batch_size = 1
model = Sequential()
model.add(LSTM(4, batch_input_shape=(batch_size, look_back, 1), stateful=True, return_sequences=True))
model.add(LSTM(4, batch_input_shape=(batch_size, look_back, 1), stateful=True))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')
for i in range(100):
	model.fit(trainX, trainY, epochs=1, batch_size=batch_size, verbose=2, shuffle=False)
	model.reset_states()
# make predictions
trainPredict = model.predict(trainX, batch_size=batch_size)
model.reset_states()
testPredict = model.predict(testX, batch_size=batch_size)
# invert predictions
trainPredict = scaler.inverse_transform(trainPredict)
trainY = scaler.inverse_transform([trainY])
testPredict = scaler.inverse_transform(testPredict)
testY = scaler.inverse_transform([testY])
# calculate root mean squared error
trainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))
print('Train Score: %.2f RMSE' % (trainScore))
testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))
print('Test Score: %.2f RMSE' % (testScore))
# shift train predictions for plotting
trainPredictPlot = numpy.empty_like(dataset)
trainPredictPlot[:, :] = numpy.nan
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict
# shift test predictions for plotting
testPredictPlot = numpy.empty_like(dataset)
testPredictPlot[:, :] = numpy.nan
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict
# plot baseline and predictions
plt.plot(scaler.inverse_transform(dataset))
plt.plot(trainPredictPlot)
plt.plot(testPredictPlot)
plt.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-14">14</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-16">16</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-18">18</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-20">20</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-22">22</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-24">24</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-26">26</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-28">28</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-30">30</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-32">32</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-34">34</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-36">36</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-38">38</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-40">40</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-42">42</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-44">44</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-46">46</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-48">48</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-50">50</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-52">52</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-54">54</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-56">56</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-58">58</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-60">60</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-62">62</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-64">64</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-66">66</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-68">68</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-70">70</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-72">72</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e1321573561-74">74</div><div class="crayon-num" data-line="crayon-5906e65aa46e1321573561-75">75</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46e1321573561-1"><span class="crayon-p"># Stacked LSTM for international airline passengers problem with memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-3"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-5"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-v">mean_squared_error</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-11"><span class="crayon-p"># convert an array of values into a dataset matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-12"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-13"><span class="crayon-h">	</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-14"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">look_back</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-15"><span class="crayon-h">		</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-16"><span class="crayon-h">		</span><span class="crayon-v">dataX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-17"><span class="crayon-h">		</span><span class="crayon-v">dataY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-19"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-20"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-21"><span class="crayon-p"># load the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-22"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-24"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-25"><span class="crayon-p"># normalize the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-26"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-27"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-28"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-29"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-30"><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train_size</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-31"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-32"><span class="crayon-p"># reshape into X=t and Y=t+1</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-33"><span class="crayon-v">look_back</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-34"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-35"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-36"><span class="crayon-p"># reshape input to be [samples, time steps, features]</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-37"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-38"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-39"><span class="crayon-p"># create and fit the LSTM network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-40"><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-41"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-45"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-46"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">reset_states</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-49"><span class="crayon-p"># make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-50"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-51"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">reset_states</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-52"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-53"><span class="crayon-p"># invert predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-54"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-55"><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">trainY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-56"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">testPredict</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-57"><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">testY</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-58"><span class="crayon-p"># calculate root mean squared error</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-59"><span class="crayon-v">trainScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-60"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-61"><span class="crayon-v">testScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-62"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Score: %.2f RMSE'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-63"><span class="crayon-p"># shift train predictions for plotting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-64"><span class="crayon-v">trainPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-65"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-66"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-v">look_back</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-67"><span class="crayon-p"># shift test predictions for plotting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-68"><span class="crayon-v">testPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-69"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-70"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">look_back*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-71"><span class="crayon-p"># plot baseline and predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-72"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-73"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e1321573561-74"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aa46e1321573561-75"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0043 seconds] -->
<p>Running the example produces the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa46e4561011894" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">...
Epoch 1/1
1s - loss: 0.0017
Epoch 1/1
1s - loss: 0.0017
Epoch 1/1
1s - loss: 0.0017
Epoch 1/1
1s - loss: 0.0017
Epoch 1/1
1s - loss: 0.0016
Train Score: 20.49 RMSE
Test Score: 56.35 RMSE</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa46e4561011894-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e4561011894-2">2</div><div class="crayon-num" data-line="crayon-5906e65aa46e4561011894-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e4561011894-4">4</div><div class="crayon-num" data-line="crayon-5906e65aa46e4561011894-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e4561011894-6">6</div><div class="crayon-num" data-line="crayon-5906e65aa46e4561011894-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e4561011894-8">8</div><div class="crayon-num" data-line="crayon-5906e65aa46e4561011894-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e4561011894-10">10</div><div class="crayon-num" data-line="crayon-5906e65aa46e4561011894-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aa46e4561011894-12">12</div><div class="crayon-num" data-line="crayon-5906e65aa46e4561011894-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa46e4561011894-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e4561011894-2">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46e4561011894-3">1s - loss: 0.0017</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e4561011894-4">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46e4561011894-5">1s - loss: 0.0017</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e4561011894-6">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46e4561011894-7">1s - loss: 0.0017</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e4561011894-8">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46e4561011894-9">1s - loss: 0.0017</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e4561011894-10">Epoch 1/1</div><div class="crayon-line" id="crayon-5906e65aa46e4561011894-11">1s - loss: 0.0016</div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aa46e4561011894-12">Train Score: 20.49 RMSE</div><div class="crayon-line" id="crayon-5906e65aa46e4561011894-13">Test Score: 56.35 RMSE</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The predictions on the test dataset are again worse. This is more evidence to suggest the need for additional training epochs.</p>
<div id="attachment_3307" style="width: 810px" class="wp-caption aligncenter"><img class="size-full wp-image-3307" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/Stacked-LSTM-Regression-1.png" alt="Stacked Stateful LSTMs Trained on Regression Formulation of Passenger Prediction Problem" width="800" height="600" srcset="http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Stacked-LSTM-Regression-1.png 800w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Stacked-LSTM-Regression-1-300x225.png 300w, http://3qeqpr26caki16dnhd19sv6by6v.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Stacked-LSTM-Regression-1-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p class="wp-caption-text">Stacked Stateful LSTMs Trained on Regression Formulation of Passenger Prediction Problem</p></div>
<h2>Summary</h2>
<p>In this post, you discovered how to develop LSTM recurrent neural networks for time series prediction in Python with the Keras deep learning network.</p>
<p>Specifically, you learned:</p>
<ul>
<li>About the international airline passenger time series prediction problem.</li>
<li>How to create an LSTM for a regression and a window formulation of the time series problem.</li>
<li>How to create an LSTM with a time step formulation of the time series problem.</li>
<li>How to create an LSTM with state and stacked LSTMs with state to learn long sequences.</li>
</ul>
<p style="text-align: center;">Do you have any questions about LSTMs for time series prediction or about this post?<br>
Ask your questions in the comments below and I will do my best to answer.</p>
<h3>Related&nbsp;Posts</h3>
<p>For a more complete and better explained tutorial of LSTMs for time series forecasting see the post:</p>
<ul>
<li><a href="http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>.</li>
</ul>
<p>Looking for some more tutorials on LSTMs in Python with Keras? Take a look at some of these:</p>
<ul>
<li><a href="http://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/">Time Series Prediction With Deep Learning in Keras</a></li>
<li><a href="http://machinelearningmastery.com/understanding-stateful-lstm-recurrent-neural-networks-python-keras/">Understanding Stateful LSTM Recurrent Neural Networks in Python with Keras</a></li>
<li><a href="http://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/">Text Generation With LSTM Recurrent Neural Networks in Python with Keras</a></li>
<li><a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a></li>
</ul>
<!-- Start Shortcoder content --><p style="text-align: left;"></p><div class="woo-sc-hr"></div><p></p>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<h4 style="text-align: center;">&nbsp;What If You Could Develop Your Own Deep Nets in Minutes</h4>
<p style="text-align: center;">...with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="http://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br><em>Multilayer Perceptrons</em>,&nbsp;<em>Convolutional Nets</em> and&nbsp;<em>Recurrent Neural Nets</em>, and more...</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To <br>Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just&nbsp;Results.</p>
<p style="text-align: center;"><a href="http://machinelearningmastery.com/deep-learning-with-python/">Click to&nbsp;learn more</a>.</p>
<p></p><div class="woo-sc-hr"></div><p></p><!-- End Shortcoder content -->
	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="http://machinelearningmastery.com/about">Learn more</a>.				<div class="profile-link">
			<a href="http://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="http://machinelearningmastery.com/estimate-baseline-performance-machine-learning-models-weka/" rel="prev"><i class="fa fa-angle-left"></i> How To Estimate A Baseline Performance For Your Machine Learning Models in Weka</a></div>
	            <div class="nav-next fr"><a href="http://machinelearningmastery.com/use-regression-machine-learning-algorithms-weka/" rel="next">How To Use Regression Machine Learning Algorithms in Weka <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">408 Responses to <em>Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-357599" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-357599" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3432fe73699aca1308b55753eedc3f34" srcset="http://0.gravatar.com/avatar/3432fe73699aca1308b55753eedc3f34?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shilin Zhang</span>
	                <span class="date">July 21, 2016 at 12:49 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-357599" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I like Keras, the example is excellent.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=357599#respond" onclick="return addComment.moveForm( &quot;comment-357599&quot;, &quot;357599&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Shilin Zhang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-357603" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-357603" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 21, 2016 at 1:55 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-357603" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=357603#respond" onclick="return addComment.moveForm( &quot;comment-357603&quot;, &quot;357603&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369368" class="comment even depth-3 parent">

	      	<div id="li-comment-369368" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/7f9db9a2c5bd188bbb99541b018ecb41" srcset="http://1.gravatar.com/avatar/7f9db9a2c5bd188bbb99541b018ecb41?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://none/" rel="external nofollow" class="url">Robin Schäfer</a></span>
	                <span class="date">November 4, 2016 at 6:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369368" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, thanks for your awesome tutorial!</p>
<p>I just don’t get one thing… If you’d like to predict 1 step in the future, why does the red line stop before the blue line does?</p>
<p>So for example, we have the testset untill end of the year 1960. How can i predict the future year? Or passangers at the 1/1/1961 (if dataset ends at 12/31/1960).</p>
<p>Best,</p>
<p>Robin</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369368#respond" onclick="return addComment.moveForm( &quot;comment-369368&quot;, &quot;369368&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Robin Schäfer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369404" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-369404" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 4, 2016 at 11:16 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369404" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, there might be a small bug in how I am displaying the predictions in the plot.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369404#respond" onclick="return addComment.moveForm( &quot;comment-369404&quot;, &quot;369404&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370565" class="comment even depth-5">

	      	<div id="li-comment-370565" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/fa09a90485b23184838c12108b842e59" srcset="http://0.gravatar.com/avatar/fa09a90485b23184838c12108b842e59?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Terrence</span>
	                <span class="date">November 15, 2016 at 12:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370565" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey, great tutorial. </p>
<p>I have the same question about the future prediction. The “testPredict” has two fewer rows that the “test” once the algorithm is done running, how would I obtain the values for the a prediction 1 or 2 days ahead from the end date of the time series? Thanks.</p>
<p>Terrence</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-385744" class="comment odd alt depth-5">

	      	<div id="li-comment-385744" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3c6f3e72c301df099f2b54b74bfb3b58" srcset="http://0.gravatar.com/avatar/3c6f3e72c301df099f2b54b74bfb3b58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">zhang</span>
	                <span class="date">February 3, 2017 at 7:46 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-385744" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think in the ”create_dataset” function, the range should be “len(dataset)-look_back” but not “len(dataset)-look_back-1”. No “1”should be subtracted here.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-388251" class="comment even depth-3 parent">

	      	<div id="li-comment-388251" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/a25275cfca19073b01aae42251286419" srcset="http://1.gravatar.com/avatar/a25275cfca19073b01aae42251286419?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shovon Sengupta</span>
	                <span class="date">February 16, 2017 at 1:00 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388251" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thanks for sharing this great tutorial! Can you please also suggest the way to get the forward forecast based on the LSTM method. For example, if we want to forecast the value of the series for the next few weeks (ahead of current time–As we usually do for the  any time series data), then what would be process to do that.</p>
<p>Regards<br>
Shovon</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388251#respond" onclick="return addComment.moveForm( &quot;comment-388251&quot;, &quot;388251&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Shovon Sengupta">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-388335" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-388335" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 16, 2017 at 11:07 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388335" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Shovon,</p>
<p>I would suggest reframing the problem to predict a long output sequence, then develop a model on this framing of the problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388335#respond" onclick="return addComment.moveForm( &quot;comment-388335&quot;, &quot;388335&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-357601" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-357601" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d4d04570059e89798f4b43de8cd0ead1" srcset="http://1.gravatar.com/avatar/d4d04570059e89798f4b43de8cd0ead1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">July 21, 2016 at 1:04 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-357601" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, thanks for the walkthrough. I’ve tried modifying the code to run the network for online prediction, but I’m having some issues. Would you be willing to take a look at my SO question? <a href="http://stackoverflow.com/questions/38313673/lstm-with-keras-for-mini-batch-training-and-online-testing" rel="nofollow">http://stackoverflow.com/questions/38313673/lstm-with-keras-for-mini-batch-training-and-online-testing</a></p>
<p>Cheers,<br>
Alex</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=357601#respond" onclick="return addComment.moveForm( &quot;comment-357601&quot;, &quot;357601&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-357792" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-357792" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 23, 2016 at 2:15 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-357792" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry Alex, you’re question is a little vague. </p>
<p>It’s of the order “I have data like this…, what is the best way to model this problem”. It’s a tough StackOverflow question because it’s an open question rather than a specific technical question.</p>
<p>Generally, my answer would be “no idea, try lots of stuff and see what works best”.</p>
<p>I think your notion of online might also be confused (or I’m confused). Have you seen online implementations of LSTM? Keras does not support it as far as I know. You train your model then you make predictions. Unless of course you mean the maintained state of the model – but this is not online learning, it is just static model with state, the weights are not updated in an online manner unless you re-train your model frequently.</p>
<p>It might be worth stepping back from the code and taking some time to clearly define I/O of the problem and requirements to then figure out the right kind of algorithm/setup you need to solve it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=357792#respond" onclick="return addComment.moveForm( &quot;comment-357792&quot;, &quot;357792&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358027" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-358027" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/f5d9de95213ec55c1b6c43699c591733" srcset="http://0.gravatar.com/avatar/f5d9de95213ec55c1b6c43699c591733?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tommy Johnson</span>
	                <span class="date">July 26, 2016 at 2:26 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358027" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Dr. Brownlee,<br>
I have a question about the difference between the Time Steps and Windows method. Am I correct in understanding that the only difference is the shape of the data you feeding into the model? If so, can you give some intuition why the Time Steps method works better? If I have two sequences (For example, if I have 2 noisy signals, one noisier than the other), and I’m using them both to predict a sequence, which method do you think is better?</p>
<p>Best</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358027#respond" onclick="return addComment.moveForm( &quot;comment-358027&quot;, &quot;358027&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Tommy Johnson">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358047" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-358047" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 26, 2016 at 5:58 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358047" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Tommy,</p>
<p>The window method creates new features, like new attributes for the model, where as timesteps are a sequence within a batch for a given feature.</p>
<p>I would not say one works better than another, the examples in this post are for demonstration only and are not tuned.</p>
<p>I would advise you to try both methods and see what works best, or frame your problem in the way that best makes sense.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358047#respond" onclick="return addComment.moveForm( &quot;comment-358047&quot;, &quot;358047&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358259" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-358259" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/05c0b0c41c484ecdb2d1be2fa627136a" srcset="http://0.gravatar.com/avatar/05c0b0c41c484ecdb2d1be2fa627136a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pedro Ferreira</span>
	                <span class="date">July 29, 2016 at 1:48 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358259" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>What are the hyperparameters of your network?</p>
<p>Thanks,<br>
Pedro</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358259#respond" onclick="return addComment.moveForm( &quot;comment-358259&quot;, &quot;358259&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Pedro Ferreira">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358271" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-358271" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2016 at 6:30 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Pedro, the hyperparameters for each network are available right there in the code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358271#respond" onclick="return addComment.moveForm( &quot;comment-358271&quot;, &quot;358271&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-382999" class="comment even depth-3 parent">

	      	<div id="li-comment-382999" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/a3b3e5726a4029f5ce37e11002f376f7" srcset="http://1.gravatar.com/avatar/a3b3e5726a4029f5ce37e11002f376f7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://outputlogic.com/" rel="external nofollow" class="url">Evgeni Stavinov</a></span>
	                <span class="date">January 19, 2017 at 11:30 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-382999" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it possible to perform hyperparameter optimization of the LTSM, for example using hyperopt?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=382999#respond" onclick="return addComment.moveForm( &quot;comment-382999&quot;, &quot;382999&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Evgeni Stavinov">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383069" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-383069" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 20, 2017 at 10:21 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383069" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not Evgeni., Sorry I don’t have an example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383069#respond" onclick="return addComment.moveForm( &quot;comment-383069&quot;, &quot;383069&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358379" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-358379" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/120ebf27726ecfecf4edfb9ec6c7f395" srcset="http://1.gravatar.com/avatar/120ebf27726ecfecf4edfb9ec6c7f395?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack Kinkade</span>
	                <span class="date">July 30, 2016 at 7:41 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358379" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Interesting post and a very useful website!  Can I use LSTMS for time series classification, for a binary supervised problem? My data is arranged as time steps of 1 hr sequences leading up to an event and the occurrence and non-occurrence of the event are labelled in each instance. I have done a bit of research and have not seen many use cases in the literature. Do you think a different recurrent neural net or simpler MLP might work better in this case? Most of my the research done in my area has got OK results(70% accuracy)  from feed forward neural networks and i thought to try out recurrent neural nets, specifically LSTMs to improve my accuracy.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358379#respond" onclick="return addComment.moveForm( &quot;comment-358379&quot;, &quot;358379&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jack Kinkade">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358416" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-358416" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 31, 2016 at 7:12 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358416" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not Jack.</p>
<p>I would suggest using a standard MLP with the window method as the baseline, then develop some LSTMs for comparison. I would expect LSTMs to generally perform better if there is information in the long sequences.</p>
<p>This post on binary classification may help, you can combine some of the details with the LSTMs in this post (e.g. the specifics of the Dense output layer and loss function):<br>
<a href="http://machinelearningmastery.com/binary-classification-tutorial-with-the-keras-deep-learning-library/" rel="nofollow">http://machinelearningmastery.com/binary-classification-tutorial-with-the-keras-deep-learning-library/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358416#respond" onclick="return addComment.moveForm( &quot;comment-358416&quot;, &quot;358416&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358444" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-358444" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4decf8d3afb46f7b441cdd4168f3a9d2" srcset="http://1.gravatar.com/avatar/4decf8d3afb46f7b441cdd4168f3a9d2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter Ostrowski</span>
	                <span class="date">July 31, 2016 at 11:19 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358444" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this example. I ran the first code example (lookback=1) by just copying the code and can reproduce your train and test scores precisely, however my graph looks differently. Specifically for me the predicted graph (green and red lines) looks as if it is shifted by one to the right in comparison to what I see on this page. It also looks like the predicted graph starts at x=0 in your example, but my predicted graph starts at 1. So in my case it looks like the prediction is almost like predicting identity? Is there a way for me to verify what I could have done wrong? </p>
<p>Thanks,<br>
  Peter</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358444#respond" onclick="return addComment.moveForm( &quot;comment-358444&quot;, &quot;358444&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Peter Ostrowski">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358469" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-358469" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2016 at 6:26 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358469" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Peter.</p>
<p>I think you’re right, I need to update my graphs in the post.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358469#respond" onclick="return addComment.moveForm( &quot;comment-358469&quot;, &quot;358469&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358518" class="comment even depth-3 parent">

	      	<div id="li-comment-358518" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4decf8d3afb46f7b441cdd4168f3a9d2" srcset="http://1.gravatar.com/avatar/4decf8d3afb46f7b441cdd4168f3a9d2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter Ostrowski</span>
	                <span class="date">August 2, 2016 at 12:05 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358518" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>when outputting the train and test score, you scale the output of the model.evaluate with the minmaxscaler to match into the original scale. I am not sure if I understand that correctly. The data values are between 104 and 622, the trainScore (which is the mean squared error) will be scaled into that range using a linear mapping, right? So your transformed trainscore can never be lower than the minimum of the dataset, i.e. 104. Shouldn’t the square root of the trainScore be transformed and then the minimum of the range be subtracted and squared again to get the mean square error in the original domain range? Like numpy.square(scalar.inverse_transform([[nump.sqrt(trainScore)]])-scaler.data_min_)</p>
<p>Thanks,<br>
Peter</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358518#respond" onclick="return addComment.moveForm( &quot;comment-358518&quot;, &quot;358518&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Peter Ostrowski">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358681" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-358681" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 3, 2016 at 8:33 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Peter, you may have found a bug, thanks. </p>
<p>I believe I thought the default evaluation metric was RMSE rather than MSE and I was using the scaler to transform the RMSE score back into original units. </p>
<p>I will update the examples ASAP.</p>
<p>Update: All estimates of model error were updated to first convert the error score to RMSE and then invert scale transform back to original units.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358681#respond" onclick="return addComment.moveForm( &quot;comment-358681&quot;, &quot;358681&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358595" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-358595" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/53892c56f64f996edd4155175f52058f" srcset="http://2.gravatar.com/avatar/53892c56f64f996edd4155175f52058f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">seiya.kumada</span>
	                <span class="date">August 2, 2016 at 3:17 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358595" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your excellent post.</p>
<p>I have one question.<br>
In your examples, you are discussing a predictor such as {x(t-2),x(t-1),x(t)} -&gt; x(t+1).<br>
I want to know how to implement a predictor like {x(t-2),x(t-1),x(t)} -&gt; {x(t+1), x(t+2)}.<br>
Could you tell me how to do so?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358595#respond" onclick="return addComment.moveForm( &quot;comment-358595&quot;, &quot;358595&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to seiya.kumada">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358664" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-358664" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 3, 2016 at 5:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358664" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a sequence in and sequence out type problem.</p>
<p>I believe you prepare the dataset in this form and model it directly with LSTMs and MLPs. </p>
<p>I don’t have a worked example at this stage for you, but I believe it would be straight forward.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358664#respond" onclick="return addComment.moveForm( &quot;comment-358664&quot;, &quot;358664&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358615" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-358615" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/75d910050ccc1bc26073167739158abf" srcset="http://1.gravatar.com/avatar/75d910050ccc1bc26073167739158abf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://sachinruk.github.io/" rel="external nofollow" class="url">Sachin</a></span>
	                <span class="date">August 2, 2016 at 6:08 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358615" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>First of all thanks for the tutorial. An excellent one at that.</p>
<p>However, I do have some questions regarding the underlying architecture that I’m trying to reconcile with what I’ve done learnt about. I posted a question here: <a href="http://stackoverflow.com/questions/38714959/understanding-keras-lstms" rel="nofollow">http://stackoverflow.com/questions/38714959/understanding-keras-lstms</a> which I felt was too long to post in this forum.</p>
<p>I would really appreciate your input, especially the question on time_steps vs features argument.</p>
<p>Thanks,<br>
Sachin</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358615#respond" onclick="return addComment.moveForm( &quot;comment-358615&quot;, &quot;358615&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sachin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358666" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-358666" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 3, 2016 at 6:01 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358666" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If I understand correctly, you want more elaboration on time steps vs features?</p>
<p>Features are your input variables. In this airline example we only have one input variable, but we can contrive multiple input variables using past time steps in what is called the window method. Normally, multiple features would be a multivariate time series.</p>
<p>Timesteps are the sequence through time for a give attribute. As we comment in the tutorial, this is the natural mapping of the problem onto LSTMs for this airline problem.</p>
<p>You always need a 3D array as input for LSTMs [samples, features, timesteps], but you can reduce each dimension to one if needed. We explore this ability in reframe the problem in the tutorial above.</p>
<p>You also ask about the point of stateful. It is helpful to have memory between batches over one training run. If we keep all of out time series samples in order, the method can learn the relationships between values across batches. If we did not enable the stateful parameter, the algorithm we no knowledge beyond each batch, much like a MLP.</p>
<p>I hope that helps, I’m happy to dig into a specific topic further if you have more questions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358666#respond" onclick="return addComment.moveForm( &quot;comment-358666&quot;, &quot;358666&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358843" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-358843" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/75d910050ccc1bc26073167739158abf" srcset="http://1.gravatar.com/avatar/75d910050ccc1bc26073167739158abf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sachin</span>
	                <span class="date">August 4, 2016 at 3:54 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358843" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So does that mean (in reference to the LSTM diagram in <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="nofollow">http://colah.github.io/posts/2015-08-Understanding-LSTMs/</a>) that the cell memory is not passed between consecutive lstms if stateful=false (i.e. set to zero)? Or do you mean cell memory is reset to zero between consecutive batches (In this tutorial batch_size is 1). Although I guess I should point out that the hidden layer values are passed on, so it will still be different to a MLP (wouldn’t it?)</p>
<p>On a side note, the fact that the output has to be a factor of batch_size seems to be confounding. Feels like it limits me to using a batch_size of one.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358843#respond" onclick="return addComment.moveForm( &quot;comment-358843&quot;, &quot;358843&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sachin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358914" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-358914" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 5, 2016 at 8:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358914" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If stateful is set to false (the default), then I understand according to the Keras documentation that the state within each LSTM node is reset after each batch, either for prediction or training.</p>
<p>This is useful if you do not want to use LSTMs in a stateful manner of you want to train with all of the required memory to learn from within each batch.</p>
<p>This does tie into the limit on batch size for prediction. The TF/Theano structures created from this network definition are optimized for the batch size.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358914#respond" onclick="return addComment.moveForm( &quot;comment-358914&quot;, &quot;358914&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367219" class="comment even depth-3 parent">

	      	<div id="li-comment-367219" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/e035660cbe59be613d01e3d792b9cf52" srcset="http://2.gravatar.com/avatar/e035660cbe59be613d01e3d792b9cf52?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mango Freezz</span>
	                <span class="date">October 16, 2016 at 6:18 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367219" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m super confused here. If the LSTM node is reset after each batch (in this case batch_size 1), does that mean in each forward-backprop session, the LSTM starts with a fresh state without any memory of previous inputs, and it’s only input is a single value? If that’s the case, how could it possibly learn anything?</p>
<p>E.g., let’s say on both time step 10 and 15 the input value is 150, how does the network predict step (10+1) to be 180 and step (15+1) to be 130 while the only input is 150 and the LSTM start with a fresh state?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367219#respond" onclick="return addComment.moveForm( &quot;comment-367219&quot;, &quot;367219&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Mango Freezz">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-374001" class="comment odd alt depth-4">

	      	<div id="li-comment-374001" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f20addc8bf4a44b78f276c288924e43" srcset="http://1.gravatar.com/avatar/1f20addc8bf4a44b78f276c288924e43?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ARandomPerson</span>
	                <span class="date">December 6, 2016 at 9:35 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-374001" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mango, I think you’re right. If the number of time-steps is one and the LSTM is not stateful, then I don’t think he is using the recurrent property of the LSTM at all.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=374001#respond" onclick="return addComment.moveForm( &quot;comment-374001&quot;, &quot;374001&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to ARandomPerson">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-358864" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-358864" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/aab6494f366fcff3b8369d6c50e83689" srcset="http://1.gravatar.com/avatar/aab6494f366fcff3b8369d6c50e83689?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nuno Fonseca</span>
	                <span class="date">August 4, 2016 at 8:52 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358864" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi!</p>
<p>First of all, thank you for that great post</p>
<p>I have just one small question: For some research work i am working on, I need to make a prediction, so I’ve been looking for the best possible solution and I am guessing its LSTM…</p>
<p>The app. that I am developing is used in a learning environment, so to predict is the probability of a certain student will submit one solution for a certain assignment…   </p>
<p>I have data from previous years in this format:</p>
<p>                     A1 A2 A3 A4 …<br>
Student 1 –  Y    Y   Y   Y   N   Y   Y   N<br>
Student 2 – N   N   N   N   N   Y   Y   Y<br>
…</p>
<p>Where Y means that the student has submitted, and N otherwise…</p>
<p>From what I understood, the best to achieve what I need is by using the solution described in the section “LSTM For Regression Using the Window Method” where my data will be something like</p>
<p>I1   I2   I3    O<br>
N    N   N     N<br>
Y    Y   Y     Y</p>
<p>And when I present a new case like Y   N   N the “LSTM” will make a prediction according to what has been learnt in the training moment.</p>
<p>Did I understand it right? Do you suggest another way?  </p>
<p>Sorry for the eventually dumb question…</p>
<p>Best regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358864#respond" onclick="return addComment.moveForm( &quot;comment-358864&quot;, &quot;358864&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nuno Fonseca">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-358899" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-358899" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 5, 2016 at 5:30 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-358899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Looks fine Nuno, although I would suggest you try to frame the problem a few different ways and see what gives you the best results.</p>
<p>Also compare results from LSTMs to MLPs with the window method and ensure it is worth the additional complexity.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=358899#respond" onclick="return addComment.moveForm( &quot;comment-358899&quot;, &quot;358899&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-359078" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-359078" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/55aca9cc07b929b0172f10f2509af2d1" srcset="http://2.gravatar.com/avatar/55aca9cc07b929b0172f10f2509af2d1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dunhui Xiao</span>
	                <span class="date">August 7, 2016 at 6:59 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-359078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Very interesting. Is there a function to descale the scaled data (0-1)?  You show the data from 0-1.  I want to see the original scale data.  This is a easy question. But, it is better to show the original scale data, I suppose.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=359078#respond" onclick="return addComment.moveForm( &quot;comment-359078&quot;, &quot;359078&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Dunhui Xiao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-359122" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-359122" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 7, 2016 at 8:46 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-359122" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great point.</p>
<p>Yes, you can save the MinMaxScaler used to scale the training data and use it later to scale new input data and in turn descale predictions. The call is scaler.inverse_transform() from memory.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=359122#respond" onclick="return addComment.moveForm( &quot;comment-359122&quot;, &quot;359122&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-359289" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-359289" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/09663ef28790e96f5f98eefe3f62b464" srcset="http://0.gravatar.com/avatar/09663ef28790e96f5f98eefe3f62b464?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pacchu</span>
	                <span class="date">August 9, 2016 at 5:09 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-359289" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why is the shift necessary for plotting the output? Isn’t it unavailable information at time ‘t+1’?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=359289#respond" onclick="return addComment.moveForm( &quot;comment-359289&quot;, &quot;359289&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Pacchu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360023" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-360023" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2016 at 9:46 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360023" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Pacchu, the framing of the problem is to predict t+1, given t, and possibly some subset of t-n.</p>
<p>I hope that is clearer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360023#respond" onclick="return addComment.moveForm( &quot;comment-360023&quot;, &quot;360023&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-359352" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-359352" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/7cee24bb2390f6edcb7aa80723e1b4a7" srcset="http://1.gravatar.com/avatar/7cee24bb2390f6edcb7aa80723e1b4a7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mat</span>
	                <span class="date">August 10, 2016 at 12:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-359352" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Does the output simply mimics the input ? (the copy is shifted by one)<br>
Just like here : <a href="https://github.com/fchollet/keras/issues/2856" rel="nofollow">https://github.com/fchollet/keras/issues/2856</a> ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=359352#respond" onclick="return addComment.moveForm( &quot;comment-359352&quot;, &quot;359352&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Mat">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360024" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-360024" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2016 at 9:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, the output is a prediction of the next time step given prior time steps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360024#respond" onclick="return addComment.moveForm( &quot;comment-360024&quot;, &quot;360024&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-359414" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-359414" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/6a44fdab183b666a77db85fa0357c8dd" srcset="http://0.gravatar.com/avatar/6a44fdab183b666a77db85fa0357c8dd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shaifu</span>
	                <span class="date">August 10, 2016 at 6:35 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-359414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi sir</p>
<p>I tried your code for time series prediction. On passing either univariate or multivariate data, the predictions of the target variable are same. Should’nt there be a difference in the predicted values. I expect the predictions to improve with the multivariate data. Please shed some light on this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=359414#respond" onclick="return addComment.moveForm( &quot;comment-359414&quot;, &quot;359414&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Shaifu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360025" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-360025" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2016 at 9:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360025" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The performance of the model is dependent on both the framing of your problem and how the model is configured.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360025#respond" onclick="return addComment.moveForm( &quot;comment-360025&quot;, &quot;360025&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-360293" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-360293" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d0ae7a3d906b223fc7508a5b02ee6b64" srcset="http://1.gravatar.com/avatar/d0ae7a3d906b223fc7508a5b02ee6b64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Madhav</span>
	                <span class="date">August 17, 2016 at 4:02 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360293" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the wonderful tutorial. It felt great following your code and implementing my first LSTM network. Looking forward to learning a lot more!!</p>
<p>Can we extend time series forecasting problems to multiple time series? I have the following problem in my mind. Suppose we have stock prices of 100 companies (instead of one) and we wanna forecast what happens in the next month for all the companies? Is it possible to use LSTMs and RNNs for such multiple time series problems?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360293#respond" onclick="return addComment.moveForm( &quot;comment-360293&quot;, &quot;360293&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Madhav">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360352" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-360352" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2016 at 7:15 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360352" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Forecasting stock prices is not my area of expertise. Nevertheless, LSTMs can be used for multiple regression as well as sequence prediction (if you want to predict multiple steps ahead). Give it a shot.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360352#respond" onclick="return addComment.moveForm( &quot;comment-360352&quot;, &quot;360352&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-375819" class="comment even depth-2">

	      	<div id="li-comment-375819" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ea625db98ee53bac98c62037983099f" srcset="http://2.gravatar.com/avatar/2ea625db98ee53bac98c62037983099f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://none/" rel="external nofollow" class="url">Mango</a></span>
	                <span class="date">December 18, 2016 at 10:08 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-375819" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i guess i have the same idea in mind as Madhav..^^ i want to predict multiple time series, each one represent the flow of one grid in the city(since i assume that the neighboured grids influence each other to some extend).. have you done your stock prediction with LSTM?? will you share me some tricks or experience?  Thankyou~</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=375819#respond" onclick="return addComment.moveForm( &quot;comment-375819&quot;, &quot;375819&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Mango">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-360326" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-360326" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/29e44d5a58298e32d84fa39602dd78da" srcset="http://2.gravatar.com/avatar/29e44d5a58298e32d84fa39602dd78da?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Liu</span>
	                <span class="date">August 18, 2016 at 2:11 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360326" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I guess the function learnt is only an one-step lag identity (mimic) prediction.</p>
<p>If the code of your basic version runs, it will look like this:</p>
<p><a href="http://imgur.com/BvPnwGu" rel="nofollow">http://imgur.com/BvPnwGu</a></p>
<p>I change the csv (setting all the data points after some time to be 400 until the end) and run the same code, it will look like this:</p>
<p><a href="http://imgur.com/TvuQDRZ" rel="nofollow">http://imgur.com/TvuQDRZ</a></p>
<p>If it is truly learning the dynamics of the pattern, the prediction should not look like a strict line. At least the previous information before the 400 values will pull down the curve a little bit.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360326#respond" onclick="return addComment.moveForm( &quot;comment-360326&quot;, &quot;360326&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Liu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360337" class="comment even depth-2">

	      	<div id="li-comment-360337" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/29e44d5a58298e32d84fa39602dd78da" srcset="http://2.gravatar.com/avatar/29e44d5a58298e32d84fa39602dd78da?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Liu</span>
	                <span class="date">August 18, 2016 at 3:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360337" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Typo: a *straight line</p>
<p>Clarification: Of course what I said may not be correct. But I think this is an alarming concern to interrupt what the LSTM is really learning behind the scene.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360337#respond" onclick="return addComment.moveForm( &quot;comment-360337&quot;, &quot;360337&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Liu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-360358" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-360358" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2016 at 8:01 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360358" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A key to the examples is that the LSTM is capable of learning the sequence, not just the input-output pairs. From the sequence, it is able to predict the next step.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360358#respond" onclick="return addComment.moveForm( &quot;comment-360358&quot;, &quot;360358&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-360455" class="comment even depth-2 parent">

	      	<div id="li-comment-360455" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/5ecbd72032e526cfafa7c6ae4f104538" srcset="http://2.gravatar.com/avatar/5ecbd72032e526cfafa7c6ae4f104538?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nicholas</span>
	                <span class="date">August 19, 2016 at 7:16 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360455" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Liu,</p>
<p>after investigating a bit, I have concluded that the 1 time-step LSTM is indeed the trivial identity function (you can convince yourself by reducing the layer to 1 neuron, and adding ad-hoc data to the test set, as you have). But if we think about it, this makes alot of sense that the ‘mimic’ function would minimize MSE for such a simple network – it doesn’t see enough time steps to learn the sequence, anyways. </p>
<p>However, if you increase the number of timesteps, you will see that it can reach lower MSE on the test set by slowly moving away from the mimic function to actually learning the sequence, although for low #’s of neurons the approximation will be rougher-looking. I recommend experimenting with the look_back amount, and adding more layers to see how the MSE can be reduced further!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360455#respond" onclick="return addComment.moveForm( &quot;comment-360455&quot;, &quot;360455&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nicholas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360596" class="comment odd alt depth-3">

	      	<div id="li-comment-360596" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/29e44d5a58298e32d84fa39602dd78da" srcset="http://2.gravatar.com/avatar/29e44d5a58298e32d84fa39602dd78da?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Liu</span>
	                <span class="date">August 20, 2016 at 8:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Nicholas,</p>
<p>Thanks for the comment!</p>
<p>I guess the problem (or feature you can say) in the first example is that ‘time-step’ is set to 1 if I understand the API correctly:</p>
<p>trainX = numpy.reshape(trainX, (trainX.shape[0], 1, trainX.shape[1]))</p>
<p>It means it is feeding sequence of length 1 to the network in each training. Therefore, the RNN/LSTM is not unrolled. The updated internal state is not used anywhere (as it is also resetting the states of the machine in each batch).</p>
<p>I agree with what you said. But by setting timestep and look_back to be 1 as in the first example, it is not learning a sequence at all.</p>
<p>For other readers, I think it worths to look at <a href="http://stackoverflow.com/questions/38714959/understanding-keras-lstms" rel="nofollow">http://stackoverflow.com/questions/38714959/understanding-keras-lstms</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360596#respond" onclick="return addComment.moveForm( &quot;comment-360596&quot;, &quot;360596&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Liu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-363267" class="comment even depth-3">

	      	<div id="li-comment-363267" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/b7545be2a92268d9e89c25b7f793fc09" srcset="http://2.gravatar.com/avatar/b7545be2a92268d9e89c25b7f793fc09?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gilles</span>
	                <span class="date">September 2, 2016 at 5:44 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363267" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Nicholas,</p>
<p>This is a very good point, thanks for mentioning it.</p>
<p>I have implemented an LSTM on a 1,500 points sample size and indeed sometimes I was wondering whether there really was a big difference with a “mimic” function. </p>
<p>A lot of work to predict the value t+1 while value at t would have been a good enough predictor!</p>
<p>Will try more experiments as I have more data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363267#respond" onclick="return addComment.moveForm( &quot;comment-363267&quot;, &quot;363267&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Gilles">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395474" class="comment odd alt depth-2">

	      	<div id="li-comment-395474" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/a925a54fb54e27f347277bd66836ce66" srcset="http://1.gravatar.com/avatar/a925a54fb54e27f347277bd66836ce66?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Logan</span>
	                <span class="date">April 6, 2017 at 4:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395474" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hey Liu, it’s a very good observation. I still on the basics and I think these sort of information is really important if we want to build something with quality. Thanks.<br>
Thanks for the tutorial as well.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395474#respond" onclick="return addComment.moveForm( &quot;comment-395474&quot;, &quot;395474&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Logan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-360521" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-360521" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/8541cab0c8aec1819f95f2980684ef9e" srcset="http://2.gravatar.com/avatar/8541cab0c8aec1819f95f2980684ef9e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">August 20, 2016 at 12:07 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360521" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this amazing tut, could you please tell me about what is the main role of batch_size in model.fit() and output shape of LSTM layer parameter ?<br>
I read somewhere that using batch_size is depend on our dataset why you chose batch_size = 1 for fitting model and what is the effect of choosing it’s value on calculating gradient of the model?</p>
<p>thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360521#respond" onclick="return addComment.moveForm( &quot;comment-360521&quot;, &quot;360521&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360580" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-360580" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 20, 2016 at 6:09 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360580" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question Chris.</p>
<p>The batch_size is the number of samples from your train dataset shown to the model at a time. After batch_size samples are run through the network and error calculated, an update to the weights is performed. Too many and the updates are too big, too few, and the updates are too noisy. The hardware you use is also a factor for batch_size and you want to ensure you can fit the batch of samples in memory (e.g. so your GPU can get at them).</p>
<p>I chose a batch_size of 1 because I want to explore and demonstrate LSTMs on time series working with only one sample at a time, but potentially vary the number of features or time steps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360580#respond" onclick="return addComment.moveForm( &quot;comment-360580&quot;, &quot;360580&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-360921" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-360921" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/03c98637586f2a7cba1c0fab45417a46" srcset="http://0.gravatar.com/avatar/03c98637586f2a7cba1c0fab45417a46?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hany El-Ghaish</span>
	                <span class="date">August 22, 2016 at 8:46 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-360921" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this series. I have a question for you.<br>
I want to apply a multi-classification problem for videos using LSTM. also, video samples have a different number of frames.<br>
Dataset: samples of videos for actions like boxing, jumping, hand waving, etc.. (Dataset like UCF1101)  . each class of action has one label.</p>
<p>so, each video has a label.<br>
Really, I  do not know how to describe the data set to LSTM when a number of frames  sequence are different from one action to another and I do not know how to use it when a number of frames are fixed as well.</p>
<p>if you have any example of how to use:<br>
LSTM, stacked of LSTM, or CNN with LSTM with this problem this will help me too much.<br>
I wait for your recommendations<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=360921#respond" onclick="return addComment.moveForm( &quot;comment-360921&quot;, &quot;360921&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hany El-Ghaish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362748" class="comment odd alt depth-2">

	      	<div id="li-comment-362748" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/0ea48066369be91c9bc10701d745bc24" srcset="http://0.gravatar.com/avatar/0ea48066369be91c9bc10701d745bc24?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harsha</span>
	                <span class="date">August 30, 2016 at 7:47 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362748" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Thanks for such a wonderful tutorial. it helped me a lot to get an insight on LSTM’s. I too have a similar question. Can you please comment on this question.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362748#respond" onclick="return addComment.moveForm( &quot;comment-362748&quot;, &quot;362748&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Harsha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-361707" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-361707" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/f3961174a7608cb03f5e2ff7f3ea455b" srcset="http://0.gravatar.com/avatar/f3961174a7608cb03f5e2ff7f3ea455b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alvin</span>
	                <span class="date">August 26, 2016 at 3:02 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-361707" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this great tutorial! I would like to ask, suppose I have a set of X points : X1, X2, .. Xn that contributes to the total sales of the day represented by Y,  and I have 60 days data (Y1 until Y60), how do I do time series forecast using these data? Assuming that I would like to predict Y65. Do you have any sample or coding references?</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=361707#respond" onclick="return addComment.moveForm( &quot;comment-361707&quot;, &quot;361707&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Alvin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-361778" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-361778" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 26, 2016 at 10:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-361778" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe you could adapt one of the examples in your post directly to your problem. Little effort required.</p>
<p>Consider normalizing or standardizing your input and output values when working with neural networks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=361778#respond" onclick="return addComment.moveForm( &quot;comment-361778&quot;, &quot;361778&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362633" class="comment even depth-3 parent">

	      	<div id="li-comment-362633" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/f3961174a7608cb03f5e2ff7f3ea455b" srcset="http://0.gravatar.com/avatar/f3961174a7608cb03f5e2ff7f3ea455b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alvin</span>
	                <span class="date">August 30, 2016 at 8:31 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362633" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I just found out the question that I have is a multi step ahead prediction, where all the X contributes to Y, and I would like to predict ahead the value of Y n days ahead. Is the example that you gave in this tutorial still relevant?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362633#respond" onclick="return addComment.moveForm( &quot;comment-362633&quot;, &quot;362633&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Alvin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362839" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-362839" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 31, 2016 at 8:42 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362839" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Alvin,</p>
<p>Yes, you could trivially extend the example to do sequence-to-sequence prediction as it is called in recurrent neural network parlance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362839#respond" onclick="return addComment.moveForm( &quot;comment-362839&quot;, &quot;362839&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362882" class="comment even depth-5">

	      	<div id="li-comment-362882" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/f3961174a7608cb03f5e2ff7f3ea455b" srcset="http://0.gravatar.com/avatar/f3961174a7608cb03f5e2ff7f3ea455b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alvin</span>
	                <span class="date">August 31, 2016 at 1:03 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362882" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your reply. I still would like to clarify after looking at the sequence to sequence concept. Assuming I would like to predict the daily total sales (Y), given x1 such as the total number of customers, total item A sold as x2, total item B sold as x3 and so on for the next few items, is sequence to sequence suitable for this?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-362920" class="comment odd alt depth-5">

	      	<div id="li-comment-362920" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/f3961174a7608cb03f5e2ff7f3ea455b" srcset="http://0.gravatar.com/avatar/f3961174a7608cb03f5e2ff7f3ea455b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alvin</span>
	                <span class="date">August 31, 2016 at 6:05 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362920" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I have another question. Looking at your example for the Window method, on line 35:<br>
# reshape input to be [samples, time steps, features]<br>
trainX = numpy.reshape(trainX, (trainX.shape[0], 1, trainX.shape[1]))<br>
testX = numpy.reshape(testX, (testX.shape[0], 1, testX.shape[1]))</p>
<p>what if I would like to change the time steps to more than 1? What other parts of codes I would need to change? Currently when I change it, it says<br>
ValueError: total size of new array must be unchanged.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-364353" class="comment even depth-5">

	      	<div id="li-comment-364353" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/f3961174a7608cb03f5e2ff7f3ea455b" srcset="http://0.gravatar.com/avatar/f3961174a7608cb03f5e2ff7f3ea455b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alvin</span>
	                <span class="date">September 13, 2016 at 11:23 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-364353" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>For using stateful LSTM, to predict multiple steps, I came across suggestions to feed the output vector back into the model for the next timestep’s prediction. May I know how to get an output vector from based on your LSTM stateful example?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-364416" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-364416" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 14, 2016 at 10:04 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-364416" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Alvin,</p>
<p>The LSTM will maintain internal state so that you only need to provide the next input pattern. The LSTM implementation in Keras does require that you provide your data in consistent batch sizes, but when experimenting with this you could reduce the batch size down to 1.</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-362317" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-362317" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/72010d5cd7b247fac67db9270c234e55" srcset="http://1.gravatar.com/avatar/72010d5cd7b247fac67db9270c234e55?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DRD</span>
	                <span class="date">August 29, 2016 at 2:25 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362317" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Apparently, when using the tensor flow backend, you have to specify input_length in the LTSM constructor. Otherwise, you get an exception. I assume it would just be input_length=1</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362317#respond" onclick="return addComment.moveForm( &quot;comment-362317&quot;, &quot;362317&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to DRD">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362318" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-362318" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/72010d5cd7b247fac67db9270c234e55" srcset="http://1.gravatar.com/avatar/72010d5cd7b247fac67db9270c234e55?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DRD</span>
	                <span class="date">August 29, 2016 at 2:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362318" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So like this:<br>
model.add(LSTM(4, input_dim=look_back, input_length=1))</p>
<p>This references the first example where number of features and timesteps is 1. Here input_length corresponds to timesteps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362318#respond" onclick="return addComment.moveForm( &quot;comment-362318&quot;, &quot;362318&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to DRD">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362634" class="comment even depth-3 parent">

	      	<div id="li-comment-362634" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/f3961174a7608cb03f5e2ff7f3ea455b" srcset="http://0.gravatar.com/avatar/f3961174a7608cb03f5e2ff7f3ea455b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alvin</span>
	                <span class="date">August 30, 2016 at 8:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362634" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi DRD,</p>
<p>Is this the setting used to solve multi step ahead prediction? </p>
<p>Thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362634#respond" onclick="return addComment.moveForm( &quot;comment-362634&quot;, &quot;362634&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Alvin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363000" class="comment odd alt depth-4">

	      	<div id="li-comment-363000" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/72010d5cd7b247fac67db9270c234e55" srcset="http://1.gravatar.com/avatar/72010d5cd7b247fac67db9270c234e55?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DRD</span>
	                <span class="date">September 1, 2016 at 6:19 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363000" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>HI, </p>
<p>Haven’t tried it yet, but in the section titled: “LSTM With Memory Between Batches</p>
<p>”  input_length should be 3. Basically the same as look_back</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363000#respond" onclick="return addComment.moveForm( &quot;comment-363000&quot;, &quot;363000&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to DRD">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-362782" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-362782" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d902111389ae6ed31320da7a481d2835" srcset="http://1.gravatar.com/avatar/d902111389ae6ed31320da7a481d2835?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nick</span>
	                <span class="date">August 31, 2016 at 1:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362782" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I applied your technique on stock prediction:<br>
But, I am having some issues.<br>
I take all the historical prices of a stock and frame it the same way the airline passenger prices are in a .csv file. </p>
<p>I use a look_back=20 and I get the following image: </p>
<p><a href="https://postimg.org/image/p53hw2nc7/" rel="nofollow">https://postimg.org/image/p53hw2nc7/</a></p>
<p>Then I try to predict the next stock price and the prediction is not accurate. </p>
<p>Why is the model able to predict the airline passengers so precisely ?</p>
<p><a href="https://postimg.org/image/z0lywvru1/" rel="nofollow">https://postimg.org/image/z0lywvru1/</a></p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362782#respond" onclick="return addComment.moveForm( &quot;comment-362782&quot;, &quot;362782&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nick">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362853" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-362853" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 31, 2016 at 9:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362853" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would suggest tuning the number of layers and number of blocks to suits your problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362853#respond" onclick="return addComment.moveForm( &quot;comment-362853&quot;, &quot;362853&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363011" class="comment even depth-3">

	      	<div id="li-comment-363011" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d902111389ae6ed31320da7a481d2835" srcset="http://1.gravatar.com/avatar/d902111389ae6ed31320da7a481d2835?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nader</span>
	                <span class="date">September 1, 2016 at 7:25 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363011" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you.<br>
I will play around the network. </p>
<p>In general, For input_dim (windows size),  is a smaller or larger number better ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363011#respond" onclick="return addComment.moveForm( &quot;comment-363011&quot;, &quot;363011&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nader">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-362934" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-362934" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1646b1e66946371f888d272526d84f0e" srcset="http://1.gravatar.com/avatar/1646b1e66946371f888d272526d84f0e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marcel</span>
	                <span class="date">August 31, 2016 at 8:29 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362934" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>First off, thanks again for this great blog, without you I would be nowhere, with LSTM, and life!</p>
<p>I am running a LSTM model that works, but when I make predictions with “model.predict” it spits out 4000 predictions, which look fine. However, when I run “model.predict” again and save those 4000 predictions again, they are different. From prediction 50 onward, they are all essentially the same, but the first few (that are very important to me) are very different. To give you an idea, the correlation between the first 10 predictions of both rounds is 0.11. </p>
<p>Please help!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362934#respond" onclick="return addComment.moveForm( &quot;comment-362934&quot;, &quot;362934&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Marcel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362949" class="comment even depth-2 parent">

	      	<div id="li-comment-362949" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1646b1e66946371f888d272526d84f0e" srcset="http://1.gravatar.com/avatar/1646b1e66946371f888d272526d84f0e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marcel</span>
	                <span class="date">August 31, 2016 at 10:55 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362949" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The problem wasn’t with numpy.random.seed(0) as I originally thought. I’ve tested this over and over, and even if on the exact same data, predictions are always different/inconsistent for the first few predictions, and only “converge” to some consistent predictions after about 50 predictions have been made previously (on the same or different input data).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362949#respond" onclick="return addComment.moveForm( &quot;comment-362949&quot;, &quot;362949&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Marcel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-362964" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-362964" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1646b1e66946371f888d272526d84f0e" srcset="http://1.gravatar.com/avatar/1646b1e66946371f888d272526d84f0e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marcel</span>
	                <span class="date">September 1, 2016 at 1:15 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-362964" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It seems like I have made an error by neglecting to include “model.reset_states()” after one line of calling model.predict()</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=362964#respond" onclick="return addComment.moveForm( &quot;comment-362964&quot;, &quot;362964&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Marcel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363022" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-363022" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 1, 2016 at 8:05 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear you worked it out Marcel.</p>
<p>A good lesson for all of to remember or calls to reset state.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363022#respond" onclick="return addComment.moveForm( &quot;comment-363022&quot;, &quot;363022&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-363152" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-363152" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d902111389ae6ed31320da7a481d2835" srcset="http://1.gravatar.com/avatar/d902111389ae6ed31320da7a481d2835?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nader</span>
	                <span class="date">September 1, 2016 at 9:30 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363152" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the part “LSTM For Regression with Time Steps”, </p>
<p>should’t the reshaping be in the form:</p>
<p>[Samples, Features, Time] = (trainX, (trainX.shape[0], trainX.shape[1], 1] </p>
<p>Because in the previous two section:<br>
“LSTM Network For Regression” and<br>
“LSTM For Regression Using the Window Method” we used:</p>
<p>[Samples, Time Steps, Features] = (trainX, (trainX.shape[0], 1, trainX.shape[1])</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363152#respond" onclick="return addComment.moveForm( &quot;comment-363152&quot;, &quot;363152&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nader">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-363261" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-363261" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/75d910050ccc1bc26073167739158abf" srcset="http://1.gravatar.com/avatar/75d910050ccc1bc26073167739158abf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://sachinruk.github.io/" rel="external nofollow" class="url">sachin</a></span>
	                <span class="date">September 2, 2016 at 3:57 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363261" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Correct me if I’m wrong, but you don’t want to reset_state in the last training iteration do you? Basically my logic is that you want to carry through the last ‘state’ onto the test set because they occur right after the other.</p>
<p>Cheers,<br>
Sachin</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363261#respond" onclick="return addComment.moveForm( &quot;comment-363261&quot;, &quot;363261&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to sachin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363352" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-363352" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2016 at 6:57 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363352" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You do. The reason is that you can seed the network with state later when you are ready to use it to make a prediction.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363352#respond" onclick="return addComment.moveForm( &quot;comment-363352&quot;, &quot;363352&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-363444" class="comment even thread-even depth-1">

	      	<div id="li-comment-363444" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/a6a5036eb94a2d81de12b42d9572471a" srcset="http://1.gravatar.com/avatar/a6a5036eb94a2d81de12b42d9572471a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Megs</span>
	                <span class="date">September 3, 2016 at 10:04 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363444" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Am I correct if I was to use Recurrent Neural Networks to predict Dengue Incidences against data on temperature, rainfall, humidity, and dengue incidences.. If so, how would I go about in the processing of my data. I already have the aforementioned data at hand and I have tried using a feed forward neural network using pybrain. It doesn’t seem to get the trend hence my trying of Recurrent Neural Network.</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363444#respond" onclick="return addComment.moveForm( &quot;comment-363444&quot;, &quot;363444&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Megs">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-363596" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-363596" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4923737ce90e184faa7481c5db35d04b" srcset="http://1.gravatar.com/avatar/4923737ce90e184faa7481c5db35d04b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Christoph</span>
	                <span class="date">September 5, 2016 at 4:22 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am a little bit confused regarding the “statefulness”. </p>
<p>If I use a Sequential Model with LSTM layers and stateful set to false. Will this still be a recurrent network that feeds back into my nodes? How would I compare it to the standard LSTM model proposed by Hochreiter et al. (1997)? Do I have to use the stateful layers to mimic the behaviour presented in the original paper?</p>
<p>In essence, I have a simple time series of sales forecasts that show a weekly and partly a yearly pattern. It was easy to create a simple MLP with the Dense layer and the time window method. I put some sales values from the last week, the same week day a few weeks back and the sales of the days roughly a year before into my feature vector. Results are pretty good so far. </p>
<p>I now want to compare it to an LSTM approach. I am however not sure how I can model the weekly and yearly pattern correctly and if I need to use the stateful LSTM or not. Basically I want to use the power of an LSTM to predict a sequence of a longer period of time and hope that the forecasts will be better than with a standard (and much faster) MLP.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363596#respond" onclick="return addComment.moveForm( &quot;comment-363596&quot;, &quot;363596&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Christoph">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-363887" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-363887" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/c39732bad8d02da98a637993affaa924" srcset="http://0.gravatar.com/avatar/c39732bad8d02da98a637993affaa924?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nathan George</span>
	                <span class="date">September 7, 2016 at 3:27 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363887" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>These lines don’t make sense to me:</p>
<p># reshape input to be [samples, time steps, features]<br>
trainX = numpy.reshape(trainX, (trainX.shape[0], 1, trainX.shape[1]))<br>
testX = numpy.reshape(testX, (testX.shape[0], 1, testX.shape[1]))</p>
<p>Isn’t it [samples, fetaures, timesteps] ?<br>
When you switch to lookback = 3, you still use trainX.shape[0], 1, trainX.shape[1] as your reshape, and aren’t the timesteps the lookback?  I noticed the Keras model doesn’t work unless you reshape in this way, which is really strange to me.  Why do we have to have a matrix full of 1×1 vectors which hold another vector inside of them?  Is this in case we have more features or something?  Are there ever any cases where the ‘1’ in the reshape would be any other number?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363887#respond" onclick="return addComment.moveForm( &quot;comment-363887&quot;, &quot;363887&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nathan George">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363988" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-363988" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4923737ce90e184faa7481c5db35d04b" srcset="http://1.gravatar.com/avatar/4923737ce90e184faa7481c5db35d04b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Christoph</span>
	                <span class="date">September 8, 2016 at 10:30 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-363988" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think the example given here is wrong in the sense, that each data point represents a sample with one single timestep. This doesn’t make sense at all if you think about the strengths of recurrent networks and especially LSTM. How is the LSTM going to memorize if there’s only one timestep for each sample? </p>
<p>Since we are working on a single time series, it should probably be the other way around, with one sample and n timesteps. One could also try and reduce the number of timesteps and split the time series up into samples of a week or a month depending on the data. </p>
<p>Not sure if this is all correct what I just said, but I get the feeling that this popular tutorial isn’t a 100% correct and therefore a bit misleading for the community.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=363988#respond" onclick="return addComment.moveForm( &quot;comment-363988&quot;, &quot;363988&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Christoph">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-364028" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-364028" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 9, 2016 at 7:20 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-364028" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I do provide multiple examples just so you can compare the methods, both learning by single sample, by window and by timestep.</p>
<p>For this specific problem, the timestep approach is probably the best way to model it, but if you want to use some of these examples as a template for your own problem, you have a few options to choose from.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=364028#respond" onclick="return addComment.moveForm( &quot;comment-364028&quot;, &quot;364028&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-364037" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-364037" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/61a1a8c025af6f0fbeb8a92f18b1de36" srcset="http://0.gravatar.com/avatar/61a1a8c025af6f0fbeb8a92f18b1de36?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Oswaldo</span>
	                <span class="date">September 9, 2016 at 10:35 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-364037" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If I want to predict t+1 in a test set with t, the prediction doesn’t make sense. If I shift the prediction, it make sense but I end up predicting t with t, using a next-step model that learnt the sequence. Nice exercise to get used with the implementation, but what’s the point in real life? I really want a t+1 prediction that match t+1 (not t) in the test set, What I’m missing?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=364037#respond" onclick="return addComment.moveForm( &quot;comment-364037&quot;, &quot;364037&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Oswaldo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-364235" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-364235" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/eb4bf016a7e6252cf767ad979d65669d" srcset="http://2.gravatar.com/avatar/eb4bf016a7e6252cf767ad979d65669d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Easwar</span>
	                <span class="date">September 12, 2016 at 1:21 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-364235" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>  This is an excellent tutuorial. I have a question. You have one LSTM (hidden) layer with 4 neurons. What if I construct a LSTM layer with only 1 neuron. Why should I have 4 neurons ? I suppose this is different from having two or layers (depth) ? Depth in my understanding is if you have more layers of LSTM. </p>
<p>If you have 4 LSTM neurons in first layers, does input get fed to all the 4 neurons in a fully connected fashion ? Can you explain that ?</p>
<p>Best Regards,<br>
Easwar</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=364235#respond" onclick="return addComment.moveForm( &quot;comment-364235&quot;, &quot;364235&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Easwar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-364262" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-364262" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 12, 2016 at 8:33 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-364262" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question Easwar.</p>
<p>More neurons means more representational capacity at that layer. More layers means more opportunity to abstract hierarchical features.</p>
<p>The number of neurons (LSTM call them blocks) and layers to use is a matter of trial and error (tuning).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=364262#respond" onclick="return addComment.moveForm( &quot;comment-364262&quot;, &quot;364262&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389028" class="comment even depth-3 parent">

	      	<div id="li-comment-389028" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d26ec2a1e7b8eac98179518360b88f43" srcset="http://1.gravatar.com/avatar/d26ec2a1e7b8eac98179518360b88f43?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">February 19, 2017 at 2:41 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389028" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If we reduce the number of neurons BELOW the number of features fed into an RNN, then does the model simply use as many features as the neuron number allows ?<br>
For example, if I have 10 features but define a model with only 5 neurons in the initial layer(s), would the model only use the FIRST 5 features ?</p>
<p>Thanks,<br>
Sam</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389028#respond" onclick="return addComment.moveForm( &quot;comment-389028&quot;, &quot;389028&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389150" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-389150" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 20, 2017 at 9:28 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389150" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, I expect it will cause an error. Try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389150#respond" onclick="return addComment.moveForm( &quot;comment-389150&quot;, &quot;389150&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389661" class="comment even depth-5">

	      	<div id="li-comment-389661" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d26ec2a1e7b8eac98179518360b88f43" srcset="http://1.gravatar.com/avatar/d26ec2a1e7b8eac98179518360b88f43?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">February 23, 2017 at 12:05 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389661" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>NO, surprisingly it works very well and gives great prediction results.<br>
Is there a requirement that each feature have a neuron ?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-364334" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-364334" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/fbb9ead611524a53bdc781a6a3169f59" srcset="http://0.gravatar.com/avatar/fbb9ead611524a53bdc781a6a3169f59?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Max Clayer</span>
	                <span class="date">September 13, 2016 at 4:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-364334" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi I have found when running your raw example on the data, the training data seems to be shifted to the right of the true plot and not the same as your graph in your first example, why could this be?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=364334#respond" onclick="return addComment.moveForm( &quot;comment-364334&quot;, &quot;364334&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Max Clayer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-364889" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-364889" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/cfc3ba4b3f95c38125d815a098a1a38b" srcset="http://0.gravatar.com/avatar/cfc3ba4b3f95c38125d815a098a1a38b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stijn</span>
	                <span class="date">September 19, 2016 at 1:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-364889" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Nice blog post.</p>
<p>I noticed however, that when you do not scale the input data and switch the activation of the LSTMs to ReLu, you are able to get performance comparable to the feedforward models in your other blog post (<a href="http://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" rel="nofollow">http://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/</a>).  The performance becomes: Train Score: 23.07 RMSE, Test Score: 48.59 RMSE</p>
<p>Moreover, when you run the feedforward models in the other blog post with scaling of the input data their performance degrades.</p>
<p>Any idea why scaling the dataset seems to worsen the performance performance?</p>
<p>Cheers,</p>
<p>Stijn</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=364889#respond" onclick="return addComment.moveForm( &quot;comment-364889&quot;, &quot;364889&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Stijn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-364907" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-364907" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 19, 2016 at 7:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-364907" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting finding Stijn, thanks for reporting it.</p>
<p>I need to experiment more myself. Not scaling and using ReLu would go hand in hand.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=364907#respond" onclick="return addComment.moveForm( &quot;comment-364907&quot;, &quot;364907&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365343" class="comment even depth-3">

	      	<div id="li-comment-365343" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/6e5854357c24b24c01330cd25700f91a" srcset="http://0.gravatar.com/avatar/6e5854357c24b24c01330cd25700f91a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">V</span>
	                <span class="date">September 23, 2016 at 2:48 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365343" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason – actually I was able to verify Stjin’s results (could you please delete my inquiry to him).</p>
<p>But I am curious about this:</p>
<p>Train Score: 22.51 RMSE<br>
Test Score: 49.75 RMSE</p>
<p>The error is almost twice as large on the out of sample data, what does that mean about the quality of our model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365343#respond" onclick="return addComment.moveForm( &quot;comment-365343&quot;, &quot;365343&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to V">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365342" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-365342" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/6e5854357c24b24c01330cd25700f91a" srcset="http://0.gravatar.com/avatar/6e5854357c24b24c01330cd25700f91a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">V</span>
	                <span class="date">September 23, 2016 at 2:35 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365342" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Stijn – I wasn’t able to replicate your results, could you please post your code. Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365342#respond" onclick="return addComment.moveForm( &quot;comment-365342&quot;, &quot;365342&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to V">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366205" class="comment even depth-3 parent">

	      	<div id="li-comment-366205" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/caf83ee03275d00855f613dc310962f8" srcset="http://0.gravatar.com/avatar/caf83ee03275d00855f613dc310962f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Max Clayer</span>
	                <span class="date">October 4, 2016 at 3:56 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366205" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p><a href="http://stats.stackexchange.com/questions/59630/test-accuracy-higher-than-training-how-to-interpret" rel="nofollow">http://stats.stackexchange.com/questions/59630/test-accuracy-higher-than-training-how-to-interpret</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366205#respond" onclick="return addComment.moveForm( &quot;comment-366205&quot;, &quot;366205&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Max Clayer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366222" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-366222" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 4, 2016 at 7:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366222" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great link, thanks Max.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366222#respond" onclick="return addComment.moveForm( &quot;comment-366222&quot;, &quot;366222&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365288" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-365288" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/bc0c102fa8f850ef3d6496dfb6880d14" srcset="http://2.gravatar.com/avatar/bc0c102fa8f850ef3d6496dfb6880d14?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jakob Aungiers</span>
	                <span class="date">September 22, 2016 at 10:52 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365288" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,</p>
<p>As far as I can tell (and you’ll have to excuse me if I’m being naive) this isn’t predicting the next timestep at all? Merely doing a good job at mimicking the previous timestep?</p>
<p>For example the with the first example, if we take the first timestep of trainX (trainX[0]) the prediction from the model doesn’t seem to be trying to predict what t+1 (trainX[1]) is, but merely mimics what it thinks fits the model at that particular timestep (trainX[0]) i.e. tries to copy the current timestep. Same for trainX[1], the prediction is not a prediction of trainX[2] but a guess at trainX[1]… Hence which the graphs in the post (which as you mentioned above you need to update) look like they’re forwardlooking, but running the code actually produces graphs which have the predictions shifted t+look_back.</p>
<p>How would you make this a forward looking graph? Hence also, I tried to predict multiple future timesteps with your first model by initialising the first prediction with testX[0] and then feeding the next predictions with the prior predictions but the predictions just plummeted downwards into a downwards curve. Not predicting the next timesteps at all.</p>
<p>Am I being naive to the purpose of this blog post here?</p>
<p>All the best, love your work,<br>
Jakob</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365288#respond" onclick="return addComment.moveForm( &quot;comment-365288&quot;, &quot;365288&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jakob Aungiers">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365389" class="comment odd alt depth-2">

	      	<div id="li-comment-365389" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d87701cf30f425e018a7f89cb2d7cc5c" srcset="http://1.gravatar.com/avatar/d87701cf30f425e018a7f89cb2d7cc5c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://jirvin16.github.io/" rel="external nofollow" class="url">Jeremy Irvin</a></span>
	                <span class="date">September 24, 2016 at 11:08 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365389" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jakob, </p>
<p>I believe you are correct.</p>
<p>I have tried these methods on many different time series and the same mimicking behavior occurs – the training loss is somehow minimized by outputting the previous timestep.</p>
<p>A similar mimicking behavior occurs when predicting multiple time steps ahead as well (for example, if predicting two steps ahead, the model learns to output the previous two timesteps). </p>
<p>There is a small discussion on this issue found here – <a href="https://github.com/fchollet/keras/issues/2856" rel="nofollow">https://github.com/fchollet/keras/issues/2856</a> – but besides that I haven’t discovered any ways to combat this (or if there is some underlying problem with Keras, my code, etc.).</p>
<p>I am in the process of writing a blog to uncover this phenomenon in more detail. Will follow up when I am done.</p>
<p>Any other advancements or suggestions would be greatly appreciated!</p>
<p>Thanks,<br>
Jeremy</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365389#respond" onclick="return addComment.moveForm( &quot;comment-365389&quot;, &quot;365389&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jeremy Irvin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-366207" class="comment even depth-2">

	      	<div id="li-comment-366207" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/caf83ee03275d00855f613dc310962f8" srcset="http://0.gravatar.com/avatar/caf83ee03275d00855f613dc310962f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Max Clayer</span>
	                <span class="date">October 4, 2016 at 4:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366207" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Are you simply using t-1 to predict t+1 in the time window, if so I don’t think there is enough data being fed into the neural network to learn effectively. with a bigger time window I notice that the model does start to fit better.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366207#respond" onclick="return addComment.moveForm( &quot;comment-366207&quot;, &quot;366207&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Max Clayer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365299" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-365299" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/c413ed3843a29fa93452b2c66a53c406" srcset="http://0.gravatar.com/avatar/c413ed3843a29fa93452b2c66a53c406?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dominic</span>
	                <span class="date">September 23, 2016 at 2:55 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365299" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason<br>
Thank you for your post.<br>
I am still confused about LSTM for regression with window method and time steps.<br>
Could you explain more about this point. Could you use some figures to show the difference between them?<br>
Many thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365299#respond" onclick="return addComment.moveForm( &quot;comment-365299&quot;, &quot;365299&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Dominic">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365310" class="comment even depth-2">

	      	<div id="li-comment-365310" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/c413ed3843a29fa93452b2c66a53c406" srcset="http://0.gravatar.com/avatar/c413ed3843a29fa93452b2c66a53c406?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dominic</span>
	                <span class="date">September 23, 2016 at 6:36 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365310" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>As my understanding, the LSTM for regression with window method is the same as a standard MLP method, which has 3 input features and one output as the example. Is this correct? What’s the difference?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365310#respond" onclick="return addComment.moveForm( &quot;comment-365310&quot;, &quot;365310&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Dominic">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365404" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-365404" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/7ee764828682624020d180f399a871e4" srcset="http://1.gravatar.com/avatar/7ee764828682624020d180f399a871e4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wolfgang</span>
	                <span class="date">September 24, 2016 at 4:20 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365404" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you very much for the detailed article!</p>
<p>Does anybody have a scientific source for the time window? I can’t seem to find one.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365404#respond" onclick="return addComment.moveForm( &quot;comment-365404&quot;, &quot;365404&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Wolfgang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365452" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-365452" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2016 at 8:01 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365452" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>I don’t know of any, but there must be something written up about it back in the early days. I also expect it’s in old neural net texts.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365452#respond" onclick="return addComment.moveForm( &quot;comment-365452&quot;, &quot;365452&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365445" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-365445" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1bb9d681c73d4e543ce7dbee55241665" srcset="http://1.gravatar.com/avatar/1bb9d681c73d4e543ce7dbee55241665?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brian</span>
	                <span class="date">September 25, 2016 at 7:14 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365445" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Have you experimented with having predictors (multivariate time series) versus a univariate? Is that possible in Keras?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365445#respond" onclick="return addComment.moveForm( &quot;comment-365445&quot;, &quot;365445&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Brian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365454" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-365454" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2016 at 8:05 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365454" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can have multiple input features for multiple regression.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365454#respond" onclick="return addComment.moveForm( &quot;comment-365454&quot;, &quot;365454&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365509" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-365509" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/5251c2b259a949fdb11f18f6c2eddfe3" srcset="http://2.gravatar.com/avatar/5251c2b259a949fdb11f18f6c2eddfe3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brian</span>
	                <span class="date">September 26, 2016 at 12:37 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365509" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Any chance you will add this type of example?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365509#respond" onclick="return addComment.moveForm( &quot;comment-365509&quot;, &quot;365509&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Brian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365531" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-365531" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 26, 2016 at 6:59 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365531" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I will in coming weeks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365531#respond" onclick="return addComment.moveForm( &quot;comment-365531&quot;, &quot;365531&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365680" class="comment odd alt depth-5">

	      	<div id="li-comment-365680" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/14a97f2fd7d2c80353e37d6278ad8f4f" srcset="http://1.gravatar.com/avatar/14a97f2fd7d2c80353e37d6278ad8f4f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://prvt/" rel="external nofollow" class="url">Jacques Rand</a></span>
	                <span class="date">September 27, 2016 at 11:40 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365680" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Me too will be interested in using multivariate(numerical) data !<br>
Been trying for a few days , but the “reshaping/shaping/data-format-blackmagic” always breaks<br>
Purely cause I don’t yet understand it !<br>
Otherwise great example !</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-365714" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-365714" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 28, 2016 at 7:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365714" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Understood, I’ll prepare tutorials.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-366162" class="comment odd alt depth-5">

	      	<div id="li-comment-366162" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1bafba9ede64f51694d5a20a2f285090" srcset="http://1.gravatar.com/avatar/1bafba9ede64f51694d5a20a2f285090?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://daviswind.net%20/%20davishydro.com" rel="external nofollow" class="url">Richard Ely</a></span>
	                <span class="date">October 3, 2016 at 4:31 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366162" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir,  Awesome work!!!  </p>
<p>I am very interested in cross-sectional time series estimation… How can that be done? </p>
<p>I am starting your Python track, but will eventually target data with say 50 explanatory variables, with near infinite length of time series observations available  on each one.  Since the explanatory variables are not independent normal OLS is useless and wish to learn your methods.  </p>
<p>I would be most interested in your approach to deriving an optimal sampling temporal window and estimation procedure.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-366214" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-366214" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 4, 2016 at 7:20 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry Richard, I don’t know about cross-sectional time series estimation.</p>
<p>For good window sizes, I recommend designing a study and resolving the question empirically.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-377442" class="comment odd alt depth-5">

	      	<div id="li-comment-377442" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/14b89a6aa5ee7f2b0246c3beb30f4eff" srcset="http://1.gravatar.com/avatar/14b89a6aa5ee7f2b0246c3beb30f4eff?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zhang Wenjie</span>
	                <span class="date">December 25, 2016 at 8:04 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-377442" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>As you mentioned before, you will prepare the tutorial for  multiple input features for multiple regression. Could you provide us the link to that tutorial?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-377649" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-377649" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 26, 2016 at 7:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-377649" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It will be part of a new book I am writing. I will put a version of it on the blog soon.</p>
<p>Multiple regression is straight forward with LSTMs, remember input is defined as [samples, timesteps, features]. Your multiple inputs are features. </p>
<p>For multiple output multi-step regression you can recurse the LSTM or change the number of outputs in the output layer.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365661" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-365661" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4e8573dccbe5d38b3340ed028ae6f61e" srcset="http://1.gravatar.com/avatar/4e8573dccbe5d38b3340ed028ae6f61e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">September 27, 2016 at 12:22 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365661" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I get this error when I run your script with the Theano backend:</p>
<p>ValueError: (‘The following error happened while compiling the node’, forall_inplace,cpu,scan_fn}(Elemwise{maximum,no_inplace}.0, Subtensor{int64:int64:int8}.0, IncSubtensor{InplaceSet;:int64:}.0, IncSubtensor{InplaceSet;:int64:}.0, Elemwise{Maximum}[(0, 0)].0, lstm_1_U_o, lstm_1_U_f, lstm_1_U_i, lstm_1_U_c), ‘\n’, ‘numpy.dtype has the wrong size, try recompiling’)</p>
<p>Any idea what might be happening?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365661#respond" onclick="return addComment.moveForm( &quot;comment-365661&quot;, &quot;365661&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Bob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365710" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-365710" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 28, 2016 at 7:35 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365710" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Bob, it might be a problem with your backend. Try reinstalling Theano or Tensorflow – whichever you are using. Try switching up the one you are using.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365710#respond" onclick="return addComment.moveForm( &quot;comment-365710&quot;, &quot;365710&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365778" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-365778" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/20e9f02964ad4d4da8821d144c9e0373" srcset="http://2.gravatar.com/avatar/20e9f02964ad4d4da8821d144c9e0373?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Philip</span>
	                <span class="date">September 28, 2016 at 9:32 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365778" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent article, really insightful. Do you have an article which expands on this to forecast data? An approach that would mimic that of say arima.predict in statsmodels? So ideally we train/fit the model on historical data, but then attempt to predict future values?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365778#respond" onclick="return addComment.moveForm( &quot;comment-365778&quot;, &quot;365778&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Philip">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365807" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-365807" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 29, 2016 at 8:36 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365807" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Philip, I plan to prepare many more time series examples.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365807#respond" onclick="return addComment.moveForm( &quot;comment-365807&quot;, &quot;365807&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367480" class="comment odd alt depth-3">

	      	<div id="li-comment-367480" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/46c571cf35e19e5e3f93476b44f4d35a" srcset="http://1.gravatar.com/avatar/46c571cf35e19e5e3f93476b44f4d35a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Waldemar</span>
	                <span class="date">October 19, 2016 at 12:39 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367480" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,Mr.Brownlee!<br>
I don’t see future values on your plots, as I understand your model don’t predict the Future, only describe History. Can you give advice, how can I do this? And how I can print predictive values?<br>
Thanks a lot!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367480#respond" onclick="return addComment.moveForm( &quot;comment-367480&quot;, &quot;367480&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Waldemar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365812" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-365812" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3cba8989ab8513a23f879c18029f708e" srcset="http://0.gravatar.com/avatar/3cba8989ab8513a23f879c18029f708e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tucker Siegel</span>
	                <span class="date">September 29, 2016 at 10:51 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365812" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great article Jason.<br>
I was just wondering if there was any way I could input more than 1 feature , and have 1 output, which is what I am trying to predict? I am trying to build a stock market predictor. And yes I know, it is nearly impossible to predict the stock market, but I am just testing this, so lets say we live in a perfect world and it can be predicted. How would I do this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365812#respond" onclick="return addComment.moveForm( &quot;comment-365812&quot;, &quot;365812&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Tucker Siegel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365859" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-365859" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 30, 2016 at 7:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365859" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Tucker, </p>
<p>You can have multiple features as inputs. </p>
<p>The input structure for LSTMS is [samples, time steps, features], as explained above. In fact, there are examples of what you are looking for above (see the section on the window method).</p>
<p>Just specify the features (e.g. different indicators) in the third dimension. You may have 1 or more timesteps for each feature (second dimension).</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365859#respond" onclick="return addComment.moveForm( &quot;comment-365859&quot;, &quot;365859&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365892" class="comment even depth-3">

	      	<div id="li-comment-365892" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3cba8989ab8513a23f879c18029f708e" srcset="http://0.gravatar.com/avatar/3cba8989ab8513a23f879c18029f708e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tucker Siegel</span>
	                <span class="date">September 30, 2016 at 1:33 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-365892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I did what you said, but now it wants to output 2 sequences out of the activation layer, but I only wanted it to have a final output of 1. Basically what I am doing is trying to use open and close stock data, and use it to predict tomorrow’s close. So I need to input 2 sequences and have an output of 1. I hope I explained that right. What should I do?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=365892#respond" onclick="return addComment.moveForm( &quot;comment-365892&quot;, &quot;365892&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Tucker Siegel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-366026" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-366026" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/37316641439462b9a66568408ade754d" srcset="http://0.gravatar.com/avatar/37316641439462b9a66568408ade754d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joe</span>
	                <span class="date">October 1, 2016 at 11:24 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366026" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, you mentioned that LSTMs input shape must be [samples, time stamps, features]. What if my time series is sampled (t, x), i.e. each sample has its own time stamp, and the time stamps are NOT evenly spaced. Do I have to generate another time series in which all samples are evenly spaced? Is there any way to handle the original time series?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366026#respond" onclick="return addComment.moveForm( &quot;comment-366026&quot;, &quot;366026&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Joe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366057" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-366057" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 2, 2016 at 8:19 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366057" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Really good question Joe. Thanks. I have not thought about this. </p>
<p>My instinct would be to pad the time series, fill in the spaces with zeros and make the time series steps equidistant. At least, I would try that against not doing it and evaluate the effect on performance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366057#respond" onclick="return addComment.moveForm( &quot;comment-366057&quot;, &quot;366057&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-369559" class="comment odd alt depth-2">

	      	<div id="li-comment-369559" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/bf6e9f611e605e855ef8593779d77cfe" srcset="http://2.gravatar.com/avatar/bf6e9f611e605e855ef8593779d77cfe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://np.nan/" rel="external nofollow" class="url">Pho King</a></span>
	                <span class="date">November 5, 2016 at 3:38 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369559" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Take samples in blocks via Sklearn.model_selection.TimeSeriesSplit</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369559#respond" onclick="return addComment.moveForm( &quot;comment-369559&quot;, &quot;369559&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Pho King">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-366359" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-366359" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/da128b3e9d8a74f3b3e02452a45bc8fc" srcset="http://1.gravatar.com/avatar/da128b3e9d8a74f3b3e02452a45bc8fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rio</span>
	                <span class="date">October 6, 2016 at 4:07 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What an excellent article!<br>
Recently I used LSTM to predict stock market index where the data is fluctuating and has no seasonal pattern like the air passanger data. I was just wondering about how does LSTM (or every gate) decide when to forget or keep a certain value of this type of series data. Any explanation about this? Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366359#respond" onclick="return addComment.moveForm( &quot;comment-366359&quot;, &quot;366359&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Rio">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366397" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-366397" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2016 at 9:40 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366397" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question Rio. I would love to work through how the gates compute/output on a specific problem. </p>
<p>I think this would be a new blog post in the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366397#respond" onclick="return addComment.moveForm( &quot;comment-366397&quot;, &quot;366397&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366518" class="comment even depth-3">

	      	<div id="li-comment-366518" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/da128b3e9d8a74f3b3e02452a45bc8fc" srcset="http://1.gravatar.com/avatar/da128b3e9d8a74f3b3e02452a45bc8fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rio</span>
	                <span class="date">October 7, 2016 at 1:15 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366518" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m looking forward to that post, Jason. Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366518#respond" onclick="return addComment.moveForm( &quot;comment-366518&quot;, &quot;366518&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Rio">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-366459" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-366459" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d9096fc10c3caa033aa6fc73394177d9" srcset="http://1.gravatar.com/avatar/d9096fc10c3caa033aa6fc73394177d9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">SalemAmeen</span>
	                <span class="date">October 6, 2016 at 10:27 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366459" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I used “LSTM For Regression Using the Window Method” with the following parameters<br>
look_back = 20<br>
LSTM(20,input_dim=look_back)</p>
<p>I got the following results</p>
<p>Train_Score: 113.67 RMSE<br>
Test_Score: 122.88 RMSE</p>
<p>I computed R-squared and I got 0.93466300136</p>
<p>In addition I tried changing the hyperparameters in the other two models but R-squared was less in both comparing to this model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366459#respond" onclick="return addComment.moveForm( &quot;comment-366459&quot;, &quot;366459&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to SalemAmeen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-366556" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-366556" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/89d977d2ee8042b34489af9513ce9296" srcset="http://2.gravatar.com/avatar/89d977d2ee8042b34489af9513ce9296?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Randy</span>
	                <span class="date">October 7, 2016 at 11:03 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366556" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason<br>
First of all, this is really a fantastic post and thank you so much!<br>
I’ve got confused on the “model.predict(x,batch_size)”.<br>
I can’t figure what it means “predict in a batched way” on the keras official website.<br>
My situation is like:<br>
batch_size=10<br>
I have a test sample [x_1] \in R^{2}, and I put it into the function,<br>
[x_2] = model.predict([x_1],batch_size=batch_size)<br>
(Let’s skip the numpy form issue)<br>
Then,  subsequently, I put [x_2] into it, similarly, and I get [x_3] = model.predict([x_2],batch_size=batch_size), and so on, till x_10.</p>
<p>I don’t know if the function “predict” treats [x_1],[x_2],…[x_3] as in a batch ?<br>
I guess it does.(although I didn’t put them into the function at one time) </p>
<p>Otherwise, I’ve tried another way to compute [x_2],…[x_10] and I got the same as above.<br>
Another strategy is like:<br>
[x_2] = model.predict([x_1],batch_size=batch_size)<br>
[x_3] = model.predict([[x_1],[x_2],batch_size=batch_size)<br>
[x_4] = model.predict([[x_1],[x_2],[x_3]],batch_size=batch_size)<br>
…</p>
<p>What’s the difference between the two ways?<br>
Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366556#respond" onclick="return addComment.moveForm( &quot;comment-366556&quot;, &quot;366556&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Randy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366558" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-366558" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/89d977d2ee8042b34489af9513ce9296" srcset="http://2.gravatar.com/avatar/89d977d2ee8042b34489af9513ce9296?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Randy</span>
	                <span class="date">October 7, 2016 at 11:55 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366558" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>btw, I am also confused at “batch”.<br>
If batch_size=1, does that mean there’s no relation between samples? I mean the state s_t won’t be sent to affect the next step s_(t+1).<br>
So, why we need RNN?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366558#respond" onclick="return addComment.moveForm( &quot;comment-366558&quot;, &quot;366558&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Randy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366587" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-366587" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 8, 2016 at 10:40 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366587" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It’s a good point.</p>
<p>We need RNN because the state they can maintain gives results better than methods that do not maintain state.</p>
<p>As for batch_size=1 during calls to model.predict() I have not tested whether indeed state is lost as in training, but I expect it may be. I expect one would need batch_size=n_samples and replay data each time a prediction is needed.</p>
<p>I must experiment with this and get back to you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366587#respond" onclick="return addComment.moveForm( &quot;comment-366587&quot;, &quot;366587&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-366585" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-366585" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 8, 2016 at 10:37 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366585" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not sure I understand the “two ways” you’re comparing, sorry.</p>
<p>The batch size is the number of records that the network will process at once  – as in load into memory and perform computation upon.</p>
<p>In training, this is the constraint on data before weight update. In test, it is data before computed predictions are returned.</p>
<p>Does that help at all?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366585#respond" onclick="return addComment.moveForm( &quot;comment-366585&quot;, &quot;366585&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367061" class="comment even depth-3">

	      	<div id="li-comment-367061" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/89d977d2ee8042b34489af9513ce9296" srcset="http://2.gravatar.com/avatar/89d977d2ee8042b34489af9513ce9296?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Randy</span>
	                <span class="date">October 13, 2016 at 3:11 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367061" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>yes, it does!<br>
I appreciate it !!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367061#respond" onclick="return addComment.moveForm( &quot;comment-367061&quot;, &quot;367061&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Randy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-366605" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-366605" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/b7ead1e2020288b7c27741ee5510a346" srcset="http://2.gravatar.com/avatar/b7ead1e2020288b7c27741ee5510a346?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">dubi dubi</span>
	                <span class="date">October 8, 2016 at 3:09 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366605" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a great post! Thanks for the guidance. I’m wondering about performance. I’ve setup my network very similarly to yours, just have a larger data set (about 2500 samples, each with 218 features). Up to about 20 epochs runs in a reasonable amount of time, but anything over that seems to take forever.</p>
<p>I’ve set-up random forests and MLPs, and nothing has run so slowly. I can see all CPUs are being used, so am wondering whether Keras and/or LSTM has performance issues with larger data sets.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366605#respond" onclick="return addComment.moveForm( &quot;comment-366605&quot;, &quot;366605&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to dubi dubi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-366650" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-366650" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 9, 2016 at 6:48 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-366650" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>LSTMs do use more resources than classical networks because of all the internal gates. No significant, but you will notice it at scale.</p>
<p>I have not performed any specific studies on this, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=366650#respond" onclick="return addComment.moveForm( &quot;comment-366650&quot;, &quot;366650&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-367005" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-367005" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/e1459cdec7c2e12166f1764ce8110fc7" srcset="http://2.gravatar.com/avatar/e1459cdec7c2e12166f1764ce8110fc7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jason Wills</span>
	                <span class="date">October 12, 2016 at 4:02 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367005" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I am confusing about deep learning and machine learning in Stock Market , forex . There are a lot of models which analyses via chart using amibroker or metastock which redraw the history price  and take the prediction in that model . Does it call the machine learning or deep learning ?<br>
How is it when we could do farther to make better prediction via deep learning if it’s right ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367005#respond" onclick="return addComment.moveForm( &quot;comment-367005&quot;, &quot;367005&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Wills">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367044" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-367044" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 13, 2016 at 8:35 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367044" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, it sounds like you are already using predictive models. </p>
<p>It may fair to call them machine learning. Deep learning is one group of specific techniques you may or may not be using.</p>
<p>There are may ways to improve results, but it is trial and error. I offer some ideas here:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>Sorry, I don’t know the specifics of stockmarket data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367044#respond" onclick="return addComment.moveForm( &quot;comment-367044&quot;, &quot;367044&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-367053" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-367053" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9323d8433eb6f7e121a501271be52139" srcset="http://0.gravatar.com/avatar/9323d8433eb6f7e121a501271be52139?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander</span>
	                <span class="date">October 13, 2016 at 12:46 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367053" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>These models do not predict, they extrapolate current value 1 step ahead in more or less obscured way. As seen on the pictures, prediction is just shifted original data. For this data one can achieve much better RMSE 33.7 without neural net, in just one line of code:</p>
<p>trainScore = math.sqrt(mean_squared_error(x[:-1], x[1:]))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367053#respond" onclick="return addComment.moveForm( &quot;comment-367053&quot;, &quot;367053&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Alexander">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367109" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-367109" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 14, 2016 at 8:56 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367109" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Alexander, thanks. </p>
<p>This is good motivation for me/community to go beyond making LSTMs “just work” for time series and dive into how to train LSTMs effectively and even competitively on even very simple problems. </p>
<p>It’s an exciting open challenge.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367109#respond" onclick="return addComment.moveForm( &quot;comment-367109&quot;, &quot;367109&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-367394" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-367394" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/cae442f26e783ab35a36e458264a5964" srcset="http://0.gravatar.com/avatar/cae442f26e783ab35a36e458264a5964?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Leftriver</span>
	                <span class="date">October 18, 2016 at 12:45 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367394" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a nice tutorial for starters. Thank you.</p>
<p>However, I have some concerns about the <code>create_dataset</code> function. I think it just make a simple problem complicated (or even wrong).</p>
<p>When <code>look_back=1</code>, the function is simply equivalent to: dataX = dataset[:len(dataset)-look_back], dataY = dataset[look_back:].</p>
<p>When <code>look_back</code> is larger than 1, the function is wrong: after each iteration, <code>dataX</code> is appended by more than 1 data, but <code>dataY</code> is appended by just 1 data. Finally, dataX will be <code>look_back</code> times larger than dataY. </p>
<p>Is that what <code>create_dataset</code> supposed to do?</p>
<p>def create_dataset(dataset, look_back=1):<br>
	dataX, dataY = [], []<br>
	for i in range(len(dataset)-look_back-1):<br>
		a = dataset[i:(i+look_back), 0]<br>
		dataX.append(a)<br>
		dataY.append(dataset[i + look_back, 0])<br>
	return numpy.array(dataX), numpy.array(dataY)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367394#respond" onclick="return addComment.moveForm( &quot;comment-367394&quot;, &quot;367394&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Leftriver">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-367789" class="comment even thread-even depth-1">

	      	<div id="li-comment-367789" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/10137757ee3cd44e5333c77b0cd50fdf" srcset="http://1.gravatar.com/avatar/10137757ee3cd44e5333c77b0cd50fdf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pang wenfeng</span>
	                <span class="date">October 21, 2016 at 3:23 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367789" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your great article! I have a question that when I use the model “Stacked LSTMs With Memory Between Batches” with my own data, I found that cpu is much faster than gpu.<br>
May data contains many files and each files’ size is about 3M. I put  each file into the model to<br>
trian one by one. I guess that the data is too small so the gpu is useless, but I can’t sure. I use thano backend and I can sure that the type of the data is float32. So I want to know what reason would make this happen, or the only reason is the data too small? Thank you very much and best wishes to you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367789#respond" onclick="return addComment.moveForm( &quot;comment-367789&quot;, &quot;367789&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to pang wenfeng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-367883" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-367883" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/46dd894b6e6fb5eae6f0f077d67cd64e" srcset="http://1.gravatar.com/avatar/46dd894b6e6fb5eae6f0f077d67cd64e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rajesh</span>
	                <span class="date">October 22, 2016 at 4:00 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367883" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Excellent tutorial. I am new to time series prediction. I have a basic question. In this example(international-airline-passengers) model predicted the values on test data from 1957-01 to 1960-12 time period.</p>
<p>How to predict the passengers in next one year from 1961-01 – 1961-12.</p>
<p>How to pass input values to model, so it will predict the passengers count in each month for next one year.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367883#respond" onclick="return addComment.moveForm( &quot;comment-367883&quot;, &quot;367883&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Rajesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367985" class="comment even depth-2">

	      	<div id="li-comment-367985" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/46dd894b6e6fb5eae6f0f077d67cd64e" srcset="http://1.gravatar.com/avatar/46dd894b6e6fb5eae6f0f077d67cd64e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rajesh</span>
	                <span class="date">October 23, 2016 at 5:53 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367985" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>Any inputs to solve below question</p>
<p>How to predict the passengers in next one year from 1961-01 – 1961-12.</p>
<p>Regards,<br>
Rajesh</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367985#respond" onclick="return addComment.moveForm( &quot;comment-367985&quot;, &quot;367985&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Rajesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-367902" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-367902" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3d203b7c730fc1d54078c17b65f2492b" srcset="http://0.gravatar.com/avatar/3d203b7c730fc1d54078c17b65f2492b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">NicoAd</span>
	                <span class="date">October 22, 2016 at 8:33 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367902" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>“The dataset is available for free from the DataMarket webpage as a CSV download with the filename “international-airline-passengers.csv“.”</p>
<p>Not anymore I guess.</p>
<p>Any other way to get the file?</p>
<p>Thanks,<br>
Nicolas</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367902#respond" onclick="return addComment.moveForm( &quot;comment-367902&quot;, &quot;367902&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to NicoAd">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367956" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-367956" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2016 at 10:11 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-367956" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it is still available NicoAd.</p>
<p>Visit: <a href="https://datamarket.com/data/set/22u3/international-airline-passengers-monthly-totals-in-thousands-jan-49-dec-60" rel="nofollow">https://datamarket.com/data/set/22u3/international-airline-passengers-monthly-totals-in-thousands-jan-49-dec-60</a></p>
<p>Click “Export” on the left-hand side, and choose the CSV file format.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=367956#respond" onclick="return addComment.moveForm( &quot;comment-367956&quot;, &quot;367956&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-368411" class="comment odd alt depth-3">

	      	<div id="li-comment-368411" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3d203b7c730fc1d54078c17b65f2492b" srcset="http://0.gravatar.com/avatar/3d203b7c730fc1d54078c17b65f2492b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">NicoAd</span>
	                <span class="date">October 27, 2016 at 9:05 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368411" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368411#respond" onclick="return addComment.moveForm( &quot;comment-368411&quot;, &quot;368411&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to NicoAd">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397509" class="comment even depth-3">

	      	<div id="li-comment-397509" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 25, 2017 at 5:31 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397509" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Just a new location:</p>
<p><a href="https://github.com/ufal/npfl114/blob/master/labs06/international-airline-passengers.tsv" rel="nofollow">https://github.com/ufal/npfl114/blob/master/labs06/international-airline-passengers.tsv</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397509#respond" onclick="return addComment.moveForm( &quot;comment-397509&quot;, &quot;397509&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-368109" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-368109" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/63d1b7a23b8eefd36b528619d1ce3160" srcset="http://0.gravatar.com/avatar/63d1b7a23b8eefd36b528619d1ce3160?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brian</span>
	                <span class="date">October 25, 2016 at 3:51 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368109" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>Great article on LSTM and keras. I was really struggling with this, until I read through your examples. Now I have a much better understanding and can use LSTM on my own data.</p>
<p>One thing I’d like to point out. The reuse of trainY and trainX on lines 55 &amp; 57.<br>
Line 55 trainY = scaler.inverse_transform([trainY])</p>
<p>This confused me a lot, because the model can’t run fit() or predict() again, after this is done.  I was struggling to understand why it could not do a second predict or fit. Until i very carefully read each line of code.  </p>
<p>I think renaming the above variables would make the example code clearer.</p>
<p>Unless I am missing something….. and being a novice programmer that’s very possible.</p>
<p>Thanks again for the great work.<br>
Brian.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368109#respond" onclick="return addComment.moveForm( &quot;comment-368109&quot;, &quot;368109&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Brian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-368147" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-368147" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 25, 2016 at 8:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Brian, I’m glad the examples were useful to get you started.</p>
<p>Great point about remaining variables.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368147#respond" onclick="return addComment.moveForm( &quot;comment-368147&quot;, &quot;368147&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-368471" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-368471" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/cec9a1fb9da33ddc3027589735867b43" srcset="http://0.gravatar.com/avatar/cec9a1fb9da33ddc3027589735867b43?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joaco</span>
	                <span class="date">October 28, 2016 at 12:09 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368471" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason, thank you for the example.<br>
 I have used the method on my own data. The data is about the prediction of the average temperature per month. I want to predict more than one month. But I can only predict one month now. Because the inputs are X1 X2 X3, the result is only y. I want to kown how to modify the code to use ,like, X1 X2 X3 X4 X5 X6 to predict Y1 Y2 Y3.<br>
I don’t know if I have made it clear. I hope you will help me.<br>
Thank you very much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368471#respond" onclick="return addComment.moveForm( &quot;comment-368471&quot;, &quot;368471&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Joaco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-368549" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-368549" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 29, 2016 at 7:33 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368549" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Joaco, that is a sequence to sequence problem. I will prepare an example soon.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368549#respond" onclick="return addComment.moveForm( &quot;comment-368549&quot;, &quot;368549&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-377886" class="comment odd alt depth-3">

	      	<div id="li-comment-377886" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/adece7ae7d5afd1d2137058749de3acf" srcset="http://1.gravatar.com/avatar/adece7ae7d5afd1d2137058749de3acf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Je</span>
	                <span class="date">December 27, 2016 at 10:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-377886" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Joaco,<br>
 I am also looking forward to a similar example <img draggable="false" class="emoji" alt="🙂" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f642.svg"></p>
<p>Je</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=377886#respond" onclick="return addComment.moveForm( &quot;comment-377886&quot;, &quot;377886&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Je">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-368475" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-368475" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/da128b3e9d8a74f3b3e02452a45bc8fc" srcset="http://1.gravatar.com/avatar/da128b3e9d8a74f3b3e02452a45bc8fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nida</span>
	                <span class="date">October 28, 2016 at 1:21 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368475" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice post Jason!<br>
I read that GRU has a less complex architecture than the LSTM has, but many people still use LSTM for forecasting. I’d like to ask, what are the advantages LSTM compared to GRU? Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368475#respond" onclick="return addComment.moveForm( &quot;comment-368475&quot;, &quot;368475&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nida">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-368551" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-368551" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 29, 2016 at 7:35 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368551" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Nida, I would defer to model skill in most circumstances, rather than concerns of computational complexity – unless that is a requirement of your project.</p>
<p>Agreed, we do want the simplest and best performing model possible, so perhaps evaluate GRUs and then see of LSTMs can out perform them on your problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368551#respond" onclick="return addComment.moveForm( &quot;comment-368551&quot;, &quot;368551&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-368502" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-368502" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/19bf0bfa08f9be3aebf3797e19996d9f" srcset="http://1.gravatar.com/avatar/19bf0bfa08f9be3aebf3797e19996d9f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://sty.nu/" rel="external nofollow" class="url">Tim</a></span>
	                <span class="date">October 28, 2016 at 9:49 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368502" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m a total newbie to Keras and LSTM and most things NN, but if you’ll excuse that, I’d like to run this idea past you just to see if I’m talking the same language let alone on the same page… :</p>
<p>I’m interested in time-series prediction, mostly stocks / commodities etc, and have encountered the same problem as others in these comments, namely, how is it prediction if it’s mostly constrained to within the time-span for which we already have data? </p>
<p>With most ML algorithms I could train the model and implement a shuffle, ie get the previous day’s prediction for today and append it in the input-variable column, get another prediction, … repeat. The worst that would happen is a little fudge around the last day in the learning dataset.<br>
That seems rather laborious if we want to predict how expensive gold is going to be in 6 months’ time.<br>
(Doubly so, since in other worlds (R + RSNNS + elman or jordan), the prediction is bound-up with training so a prediction would involve rebuilding the entire NN for every day’s result, but we digress.)</p>
<p>I saw somewhere Keras has a notion of “masking”, assigning a dummy value that tells the training the values are missing. Would it be possible to use this with LSTM, just append a bunch of 180 mask zeroes, let it train itself on this and then use the testing phase to impute the last values, thereby filling in the blanks for the next 6 months?</p>
<p>It would also be possible to run an ensemble of these models and draw a pretty graph similar to arima.predict with varying degrees of confidence as to what might happen. </p>
<p>Waffle ends.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368502#respond" onclick="return addComment.moveForm( &quot;comment-368502&quot;, &quot;368502&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Tim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-368556" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-368556" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 29, 2016 at 7:45 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368556" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting idea.</p>
<p>My thoughts go more towards updating the model. A great thing about neural nets is that they are updatable. This means that you can prepare just some additional training data for today/this week and update the weights with the new knowledge, rather than training them from scratch.</p>
<p>Again, the devil is in the detail and often updating may require careful tuning and perhaps balance of old data to avoid overfitting.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368556#respond" onclick="return addComment.moveForm( &quot;comment-368556&quot;, &quot;368556&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-368710" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-368710" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/05dfcf8ac4213c650e6a299b2c539e34" srcset="http://0.gravatar.com/avatar/05dfcf8ac4213c650e6a299b2c539e34?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lazaros</span>
	                <span class="date">October 30, 2016 at 6:39 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368710" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>I am trying to implement your code in order to make forecasting on a time-series that i am receiving from a server. My only problem is that the length of my dataset is continuously increasing. Is there any way to read the last N rows from my csv file? What changes do i have to make in code below in order to succeed it. </p>
<p>def create_dataset(dataset, look_back=1):<br>
		dataX, dataY = [], []<br>
		for i in range(len(dataset)-look_back-1):<br>
			a = dataset[i:(i+look_back), 0]<br>
			dataX.append(a)<br>
			dataY.append(dataset[i + look_back, 0])<br>
		return numpy.array(dataX), numpy.array(dataY)<br>
	# fix random seed for reproducibility<br>
	numpy.random.seed(7)<br>
	# load the dataset<br>
	dataframe = pandas.read_csv(‘timeseries.csv’, usecols=[1], engine=’python’, skipfooter=3)<br>
	dataset = dataframe.values<br>
	dataset = dataset.astype(‘float32’)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368710#respond" onclick="return addComment.moveForm( &quot;comment-368710&quot;, &quot;368710&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Lazaros">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-368753" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-368753" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 31, 2016 at 5:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-368753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post might help with loading your CSV into memory:<br>
<a href="http://machinelearningmastery.com/load-machine-learning-data-python/" rel="nofollow">http://machinelearningmastery.com/load-machine-learning-data-python/</a></p>
<p>If you load your data with Pandas, you can use DataFrame.tail() to select the last n records of your dataset, for example:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aaa2f0727954953" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Load CSV using Pandas
from pandas import read_csv
filename = 'pima-indians-diabetes.csv'
names = ['preg', 'plas', 'pres', 'skin', 'test', 'mass', 'pedi', 'age', 'class']
data = read_csv(filename, names=names)
data = data.tail(10)
print(data.shape)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aaa2f0727954953-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aaa2f0727954953-2">2</div><div class="crayon-num" data-line="crayon-5906e65aaa2f0727954953-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aaa2f0727954953-4">4</div><div class="crayon-num" data-line="crayon-5906e65aaa2f0727954953-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5906e65aaa2f0727954953-6">6</div><div class="crayon-num" data-line="crayon-5906e65aaa2f0727954953-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aaa2f0727954953-1"><span class="crayon-p"># Load CSV using Pandas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aaa2f0727954953-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5906e65aaa2f0727954953-3"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'pima-indians-diabetes.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aaa2f0727954953-4"><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'preg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'plas'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pres'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'skin'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'test'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mass'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pedi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'class'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5906e65aaa2f0727954953-5"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5906e65aaa2f0727954953-6"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">tail</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5906e65aaa2f0727954953-7"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=368753#respond" onclick="return addComment.moveForm( &quot;comment-368753&quot;, &quot;368753&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-369242" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-369242" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/412c6c968b08ee51a4d0af534e81ef82" srcset="http://1.gravatar.com/avatar/412c6c968b08ee51a4d0af534e81ef82?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alisson Pereira</span>
	                <span class="date">November 3, 2016 at 9:12 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369242" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I would like to use that your model. But the problem I am using sliding window size greater than one. Type {[x-2], [x-1], [x]} ==&gt; [x + 1]. But I found several problems in training. For example, when I turn your trainX in {[x-2], [x-1], [x]} and trainY in [x + 1], the keras tells me that the input and the target must have same size. Can you help me with this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369242#respond" onclick="return addComment.moveForm( &quot;comment-369242&quot;, &quot;369242&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Alisson Pereira">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369377" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-369377" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 4, 2016 at 9:02 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369377" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Alisson, I think the error suggests that input and target do not have the same number of rows.</p>
<p>Check your prepared data, maybe even save it to file and look in a text editor or excel.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369377#respond" onclick="return addComment.moveForm( &quot;comment-369377&quot;, &quot;369377&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370001" class="comment even depth-3">

	      	<div id="li-comment-370001" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/412c6c968b08ee51a4d0af534e81ef82" srcset="http://1.gravatar.com/avatar/412c6c968b08ee51a4d0af534e81ef82?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alisson Pereira</span>
	                <span class="date">November 9, 2016 at 3:55 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370001" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thaks, Jason. I was able to solve my problem. But see, the use of the ReLu function in the memory cell and the sigmoid function on the output showed strange behavior. You have some experience with this setting.<br>
Congratulations on the work, this page has helped me a lot.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370001#respond" onclick="return addComment.moveForm( &quot;comment-370001&quot;, &quot;370001&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Alisson Pereira">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-369347" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-369347" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/ffa50b2ca24453993f3a1aaefc6db603" srcset="http://0.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Soren</span>
	                <span class="date">November 4, 2016 at 2:20 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369347" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your great content.</p>
<p>As you did i upgraded to Keras 1.1.0 and scikit-learn v0.18. however i run Theano v.0.9.0dev3 as im on Windows 10. Also im on Anaconda 3.5. (installed from this article: <a href="http://ankivil.com/installing-keras-theano-and-dependencies-on-windows-10/" rel="nofollow">http://ankivil.com/installing-keras-theano-and-dependencies-on-windows-10/</a>)</p>
<p>Your examples run fine on my setup – but i seem to be getting slightly different results.</p>
<p>For eamples in your first example: # LSTM for international airline passengers problem with window regression framing – i get:</p>
<p>Train Score: 22.79 RMSE<br>
Test Score: 48.80 RMSE</p>
<p>Should i be getting exact the same results as in your tutorial? If yes, any idea what i should be looking at changing?</p>
<p>Best regards<br>
Soren</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369347#respond" onclick="return addComment.moveForm( &quot;comment-369347&quot;, &quot;369347&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Soren">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369388" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-369388" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 4, 2016 at 9:12 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369388" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great work Soren!</p>
<p>Don’t worry about small differences. It is hard to get 100% reproducible results with Keras/Theano/TensorFlow at the moment. I hope the community can work something out soon.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369388#respond" onclick="return addComment.moveForm( &quot;comment-369388&quot;, &quot;369388&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-369420" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-369420" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/dd6f3e9a3f441759db81c125a0d9d441" srcset="http://1.gravatar.com/avatar/dd6f3e9a3f441759db81c125a0d9d441?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pemfir</span>
	                <span class="date">November 4, 2016 at 2:00 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369420" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>great post ! thank you so much. I was wondering how can be adapt the code to make multiple-step-ahead prediction. One of the commenters suggested defining the out-put like [x(t+1),x(t+2),x(t+3),…x(t+n)] , but is there a way to make prediction recursively ? More specifically, to build an LSTM with only one output. We first predict x(t+1), then use the predicted x(t+1) as the input for the next time step to predict x(t+2) and continue doing so ‘n’ times.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369420#respond" onclick="return addComment.moveForm( &quot;comment-369420&quot;, &quot;369420&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to pemfir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-369542" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-369542" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/555c3d8b8f3c8c238c132f8198010480" srcset="http://2.gravatar.com/avatar/555c3d8b8f3c8c238c132f8198010480?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bill</span>
	                <span class="date">November 5, 2016 at 12:11 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369542" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>I am wondering how to apply LSTM to real time data. The first change I can see is the data normalisation. Concretely, a new sample could be well out of min max among previous observations. How would you go about this problem?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369542#respond" onclick="return addComment.moveForm( &quot;comment-369542&quot;, &quot;369542&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Bill">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-369606" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-369606" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/cb9eb64d5c3757c7cfba93488e2697d8" srcset="http://0.gravatar.com/avatar/cb9eb64d5c3757c7cfba93488e2697d8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Noque</span>
	                <span class="date">November 6, 2016 at 2:58 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could it be that in:</p>
<p># calculate root mean squared error<br>
math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))</p>
<p>you mean :</p>
<p># calculate root mean squared error<br>
trainScore = math.sqrt(mean_squared_error(trainY[:], trainPredict[:,0]))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369606#respond" onclick="return addComment.moveForm( &quot;comment-369606&quot;, &quot;369606&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Noque">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-376596" class="comment even depth-2">

	      	<div id="li-comment-376596" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2b96b2be523053a1e9b5234a350d958f" srcset="http://2.gravatar.com/avatar/2b96b2be523053a1e9b5234a350d958f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kit</span>
	                <span class="date">December 21, 2016 at 9:30 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>trainY is an array of (one) array. Compare:</p>
<p>print len(trainYi[0]) # 720<br>
print len(trainYi[:]) # 1</p>
<p>print len(trainPredict[:,0]) # 720</p>
<p>So the original code is the right one.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376596#respond" onclick="return addComment.moveForm( &quot;comment-376596&quot;, &quot;376596&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Kit">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-369618" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-369618" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/63943354e49cfb6883a28181808e27ae" srcset="http://0.gravatar.com/avatar/63943354e49cfb6883a28181808e27ae?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sherlockatszx</span>
	                <span class="date">November 6, 2016 at 6:05 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369618" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jason, i got a question,that have stacked me for many days,how can i add hidden layer into the LSTM model(By using model.add(LSTM()).what i tried : say ,in your first code example,  I assume ‘model.add(LSTM(4, input_dim=look_back))’ this line was to create a hidden layer in the LSTM model. So i thought:oh , 1 hidden layer is so easy , why don’t add one hidden layer into it .So i try to add one layer. After the code:’model.add(LSTM(4, input_dim=look_back))’ , i try many ways to insert one hidden layer , such as : just copy model.add(LSTM(4,input_dim=look_back)) and insert after it . I try many ways ,but it always got the error that got the wrong input _ dimension. So can you show me how to add one hidden layer in example 1st . Or , i don’t got the LSTM model right ,it can’t be inserted ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369618#respond" onclick="return addComment.moveForm( &quot;comment-369618&quot;, &quot;369618&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to sherlockatszx">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369741" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-369741" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 7, 2016 at 7:07 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See the section titled “Stacked LSTMs With Memory Between Batches”.</p>
<p>It gives an example of multiple hidden layers in an LSTM network.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369741#respond" onclick="return addComment.moveForm( &quot;comment-369741&quot;, &quot;369741&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369770" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-369770" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/63943354e49cfb6883a28181808e27ae" srcset="http://0.gravatar.com/avatar/63943354e49cfb6883a28181808e27ae?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sherlockatszx</span>
	                <span class="date">November 7, 2016 at 1:26 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369770" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks . I got that.<br>
However, I got another question: compared to the other article you published ‘time series prediction with deep learning ‘(<a href="http://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/?utm_source=tuicool&amp;utm_medium=referral" rel="nofollow">http://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/?utm_source=tuicool&amp;utm_medium=referral</a>) , It seems that ‘LSTM’ model doesn’t predict as well as the simple neurons. Does that mean LSTM may not a good choice for some specific time series structure?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369770#respond" onclick="return addComment.moveForm( &quot;comment-369770&quot;, &quot;369770&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to sherlockatszx">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369862" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-369862" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 8, 2016 at 9:49 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369862" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would not agree, these are just demonstration projects and were not optimized for top performance. </p>
<p>These examples show how LSTMs could be used for time series projects (and how to use MLPs for time series projects), but not optimally tuned for the problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369862#respond" onclick="return addComment.moveForm( &quot;comment-369862&quot;, &quot;369862&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-369963" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-369963" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/cb9eb64d5c3757c7cfba93488e2697d8" srcset="http://0.gravatar.com/avatar/cb9eb64d5c3757c7cfba93488e2697d8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Noque</span>
	                <span class="date">November 9, 2016 at 1:28 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-369963" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, great post! Thanks</p>
<p>How could I set the input if I have several observations (time series) with same length of the same feature and I want to predict t+1? Would I concatenate them all? In that case the last sample of one observation would predict the first one of the next.. Or should I explicitly assign the length of each time series to the batch_size?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=369963#respond" onclick="return addComment.moveForm( &quot;comment-369963&quot;, &quot;369963&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Noque">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-370181" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-370181" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/acf5262588a322a9b732a8c44c970add" srcset="http://1.gravatar.com/avatar/acf5262588a322a9b732a8c44c970add?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mauro</span>
	                <span class="date">November 10, 2016 at 9:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370181" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, you’re predicting one day after your last entry, if i want to predict a day five days after what should i do?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370181#respond" onclick="return addComment.moveForm( &quot;comment-370181&quot;, &quot;370181&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Mauro">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370261" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-370261" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 11, 2016 at 9:56 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370261" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mauro, that would be a sequence to sequence prediction.</p>
<p>Sorry, I don’t have an example just yet.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370261#respond" onclick="return addComment.moveForm( &quot;comment-370261&quot;, &quot;370261&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370756" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-370756" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/18238d1c5ecb5b4c93cac90f6551f8a7" srcset="http://1.gravatar.com/avatar/18238d1c5ecb5b4c93cac90f6551f8a7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ron</span>
	                <span class="date">November 16, 2016 at 7:01 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370756" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi</p>
<p>This is a great example. I am quite new in deep learning and keras. But this website has been very helpful. I want to learn more.</p>
<p>Like many commenters, I am also requesting to find out: how to predict future time periods. Is that possible? How can I achieve this using the example above? If there are multiple series or Ys and there are categorical predictors, how can I accomodate that?</p>
<p>Please help, and am very keen to learn this via other channels in this website if required. Please let me know.</p>
<p>Many thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370756#respond" onclick="return addComment.moveForm( &quot;comment-370756&quot;, &quot;370756&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Ron">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370794" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-370794" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2016 at 9:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370794" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The example does indeed predict future values.</p>
<p>You can adapt the example and call model.predict to make a prediction for new data, rather than just evaluate the performance of predictions on new data as in the example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370794#respond" onclick="return addComment.moveForm( &quot;comment-370794&quot;, &quot;370794&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370895" class="comment even depth-3 parent">

	      	<div id="li-comment-370895" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3d203b7c730fc1d54078c17b65f2492b" srcset="http://0.gravatar.com/avatar/3d203b7c730fc1d54078c17b65f2492b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nico AD</span>
	                <span class="date">November 17, 2016 at 3:21 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370895" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, </p>
<p>I tried to predict future values, but have trouble finding the right way to do it</p>
<p>I work with the window method so my current data à t-3 t-2 t-1 t looks like this</p>
<p>[100,110,108]</p>
<p>If I try </p>
<p>data = [[100,110,108]]</p>
<p>model.predict(data) </p>
<p>I get the following error :</p>
<p>Attribute error : ‘list’ object has no attribute “shape”</p>
<p>I guess the format is not correct, and I need sort of reshape.</p>
<p>but for me the line</p>
<p>trainX = numpy.reshape(trainX, (trainX.shape[0], 1, trainX.shape[1])) is not clear.</p>
<p>and if I try to apply the same transform on my new data I get this error :</p>
<p>IndexError : tuple index out of range</p>
<p>could you provide an exemple dealing with new data ?</p>
<p>Thanks !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370895#respond" onclick="return addComment.moveForm( &quot;comment-370895&quot;, &quot;370895&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nico AD">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370901" class="comment odd alt depth-4">

	      	<div id="li-comment-370901" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3d203b7c730fc1d54078c17b65f2492b" srcset="http://0.gravatar.com/avatar/3d203b7c730fc1d54078c17b65f2492b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nico AD</span>
	                <span class="date">November 17, 2016 at 3:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370901" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think I almost here but still have a last error (my window side is 8)</p>
<p>todayData = numpy.array([[1086.22,827.62,702.94,779.5,711.8399999999999,1181.25,1908.69,2006.39]])<br>
todayData = todayData.astype(‘float32’)<br>
todayData = scaler.fit_transform(todayData)<br>
print “todayData scaled ” + str(todayData)</p>
<p>todayData = scaler.inverse_transform(todayData)<br>
print “todayData inversed ” + str(todayData)<br>
todayData = numpy.reshape(todayData, (todayData.shape[0], 1, todayData.shape[1]))</p>
<p>predictTomorrow = model.predict(todayData)<br>
predictTomorrow = scaler.inverse_transform([predictTomorrow])<br>
print “prediction” + str(predictTomorrow)</p>
<p>the inverse_transform line on predictTomorrow generate the following error</p>
<p>ValueError : Found array with dim 3 . Estimator expected &lt;= 2</p>
<p>again a reshape issue <img draggable="false" class="emoji" alt="🙁" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f641.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370901#respond" onclick="return addComment.moveForm( &quot;comment-370901&quot;, &quot;370901&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nico AD">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-370934" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-370934" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2016 at 9:55 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370934" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am working on a new example Nico, it may be a new blog post.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370934#respond" onclick="return addComment.moveForm( &quot;comment-370934&quot;, &quot;370934&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371553" class="comment odd alt depth-5">

	      	<div id="li-comment-371553" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3d203b7c730fc1d54078c17b65f2492b" srcset="http://0.gravatar.com/avatar/3d203b7c730fc1d54078c17b65f2492b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nico AD</span>
	                <span class="date">November 22, 2016 at 8:08 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371553" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks Jason. I tried various things with no luck. for me some part of the tutorial (like the reshape part / scaling ) are pure magic <img draggable="false" class="emoji" alt="🙂" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f642.svg"> trying to get some help from the keras community on gitter <img draggable="false" class="emoji" alt="🙂" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f642.svg"></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-371598" class="comment even depth-5">

	      	<div id="li-comment-371598" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3d203b7c730fc1d54078c17b65f2492b" srcset="http://0.gravatar.com/avatar/3d203b7c730fc1d54078c17b65f2492b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nico AD</span>
	                <span class="date">November 23, 2016 at 2:05 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371598" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>finally got it , I need to reshape in  (1,1,8) ( where 8 is the look_back size)</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-371695" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-371695" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2016 at 9:00 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371695" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done Nico.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370757" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-370757" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/18238d1c5ecb5b4c93cac90f6551f8a7" srcset="http://1.gravatar.com/avatar/18238d1c5ecb5b4c93cac90f6551f8a7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ron</span>
	                <span class="date">November 16, 2016 at 7:15 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370757" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>Which book gives complete examples/codes with time series keras? I want to predict future time periods ahead and want add other predictor variables? Is that achievable? </p>
<p>Please let me know if you have any resources / book that I can purchase.</p>
<p>Many thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370757#respond" onclick="return addComment.moveForm( &quot;comment-370757&quot;, &quot;370757&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Ron">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370795" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-370795" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2016 at 9:35 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-370795" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Deep Learning With Python:<br>
<a href="https://machinelearningmastery.com/deep-learning-with-python/" rel="nofollow">https://machinelearningmastery.com/deep-learning-with-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=370795#respond" onclick="return addComment.moveForm( &quot;comment-370795&quot;, &quot;370795&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371177" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-371177" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/e18a661cce6b71e948ea30b80fabac5a" srcset="http://2.gravatar.com/avatar/e18a661cce6b71e948ea30b80fabac5a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sarah</span>
	                <span class="date">November 19, 2016 at 7:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>Thank you for your great tutorial,<br>
I have a question about number of features. How could I have input with 5 variables?</p>
<p>Thank you in advance</p>
<p>Sarah</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371177#respond" onclick="return addComment.moveForm( &quot;comment-371177&quot;, &quot;371177&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sarah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371196" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-371196" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 19, 2016 at 8:52 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371196" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Sarah, LSTMs take input in the form [samples, timesteps, features], e.g. [n, 1, 5].</p>
<p>You can prepare your data in this way, then set the input configuration of your network appropriately, e.g. input_dim=5.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371196#respond" onclick="return addComment.moveForm( &quot;comment-371196&quot;, &quot;371196&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371212" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-371212" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d1d9dbc4b9be435853c9f8ffb813ff71" srcset="http://1.gravatar.com/avatar/d1d9dbc4b9be435853c9f8ffb813ff71?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adam</span>
	                <span class="date">November 19, 2016 at 1:24 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371212" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice tutorial, thanks.<br>
I think the line<br>
for i in range(len(dataset)-look_back-1):<br>
should be<br>
for i in range(len(dataset)-(look_back-1)):</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371212#respond" onclick="return addComment.moveForm( &quot;comment-371212&quot;, &quot;371212&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Adam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371214" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-371214" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d1d9dbc4b9be435853c9f8ffb813ff71" srcset="http://1.gravatar.com/avatar/d1d9dbc4b9be435853c9f8ffb813ff71?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adam</span>
	                <span class="date">November 19, 2016 at 1:52 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Actually, I think its<br>
<code>for i in range(len(dataset)-look_back):</code><br>
and<br>
<code>testPredictPlot[train_size+(look_back-1):len(dataset)-1, :] = testPredict</code></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371214#respond" onclick="return addComment.moveForm( &quot;comment-371214&quot;, &quot;371214&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Adam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371481" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-371481" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 22, 2016 at 6:46 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Adam, I’ll take a look.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371481#respond" onclick="return addComment.moveForm( &quot;comment-371481&quot;, &quot;371481&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371684" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-371684" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/ffbea40ff9de47daa66cc74dec01bffe" srcset="http://0.gravatar.com/avatar/ffbea40ff9de47daa66cc74dec01bffe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ben</span>
	                <span class="date">November 23, 2016 at 8:55 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371684" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Adam, nice blog ! I only have a small suggestion for shifting data: use the shift() method from pandas. Cheers</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371684#respond" onclick="return addComment.moveForm( &quot;comment-371684&quot;, &quot;371684&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Ben">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371702" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-371702" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2016 at 9:07 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371702" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great suggestion Ben. I have been using this myself recent to create a lagged dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371702#respond" onclick="return addComment.moveForm( &quot;comment-371702&quot;, &quot;371702&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371771" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-371771" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1a91d41abf12e584a0db66d590dfdaaa" srcset="http://1.gravatar.com/avatar/1a91d41abf12e584a0db66d590dfdaaa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="external nofollow" class="url">Weixian</a></span>
	                <span class="date">November 23, 2016 at 3:08 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371771" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>As i am new to RNN, i would like to ask about the difference in stateful:</p>
<p>for i in range(100):<br>
	model.fit(trainX, trainY, nb_epoch=1, batch_size=batch_size, verbose=2, shuffle=False)<br>
	model.reset_states()</p>
<p>and the stateless:</p>
<p>model.fit(trainX, trainY, nb_epoch=100, batch_size=1, verbose=2)</p>
<p>Do the range of 100(nb_epoch=1) the same as nb_epoch=100?<br>
What is the difference between these 2?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371771#respond" onclick="return addComment.moveForm( &quot;comment-371771&quot;, &quot;371771&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Weixian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371933" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-371933" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2016 at 10:37 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371933" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question Weixian.</p>
<p>In the stateful case, we are running each epoch manually and resetting the state of the network at the end of each epoch.</p>
<p>In the stateless case, we let the Keras infrastructure run the loop over epochs for us and we’re not concerned with resetting network state.</p>
<p>I hope that is clear.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371933#respond" onclick="return addComment.moveForm( &quot;comment-371933&quot;, &quot;371933&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371983" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-371983" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1a91d41abf12e584a0db66d590dfdaaa" srcset="http://1.gravatar.com/avatar/1a91d41abf12e584a0db66d590dfdaaa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="external nofollow" class="url">Weixian</a></span>
	                <span class="date">November 24, 2016 at 4:21 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371983" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the reply.</p>
<p>In this case for the stateful:<br>
if i reset the network, would the next input from the last trained epoch?</p>
<p>For the stateless:<br>
Does it loop from the epochs that was previously trained?</p>
<p>How does the 2 affect the data trained or tested?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371983#respond" onclick="return addComment.moveForm( &quot;comment-371983&quot;, &quot;371983&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Weixian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-372186" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-372186" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 25, 2016 at 9:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372186" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t understand your questions. Perhaps you could provide more context?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372186#respond" onclick="return addComment.moveForm( &quot;comment-372186&quot;, &quot;372186&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-372741" class="comment odd alt depth-5">

	      	<div id="li-comment-372741" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1a91d41abf12e584a0db66d590dfdaaa" srcset="http://1.gravatar.com/avatar/1a91d41abf12e584a0db66d590dfdaaa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="external nofollow" class="url">Weixian</a></span>
	                <span class="date">November 28, 2016 at 7:36 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>stateful:<br>
I mean like the training results of the last epoch [Y1] output  for example A<br>
Would the [X2] input of the network be A from the last epoch?</p>
<p>Stateless:<br>
How would the top situation be different from the epoch=2?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-372816" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-372816" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2016 at 8:49 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372816" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you need to have the same inputs in both cases. The difference is the LSTM is maintaining some internal state when stateful.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371797" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-371797" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/26ee5dc77a8cc29aa33495e584d0e48b" srcset="http://2.gravatar.com/avatar/26ee5dc77a8cc29aa33495e584d0e48b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Quinn</span>
	                <span class="date">November 23, 2016 at 5:08 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371797" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br>
Thank you for your LSTM tutorial.</p>
<p>But i found that an error always occurred, when i ran the first code in ‘model.add(LSTM(4, input_dim=look_back))’</p>
<p>The error is : TypeError: super() argument 1 must be type, not None</p>
<p>So, why?<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371797#respond" onclick="return addComment.moveForm( &quot;comment-371797&quot;, &quot;371797&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Quinn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371934" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-371934" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2016 at 10:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371934" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Check your white space Quinn, it’s possible to let extra white space sneak in when doing the copy-paste.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371934#respond" onclick="return addComment.moveForm( &quot;comment-371934&quot;, &quot;371934&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371822" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-371822" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/44d0c02ff389748e58f26cb99d87a86b" srcset="http://1.gravatar.com/avatar/44d0c02ff389748e58f26cb99d87a86b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://vedhaspandit.blogspot.com/" rel="external nofollow" class="url">Vedhas</a></span>
	                <span class="date">November 23, 2016 at 9:57 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371822" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Many thanks for this article. I am trying to wrap my head around </p>
<p>trainX = numpy.reshape(trainX, (trainX.shape[0], trainX.shape[1], 1))<br>
testX = numpy.reshape(testX, (testX.shape[0], testX.shape[1], 1))</p>
<p>(from LSTM for Regression with Time Steps section), since this is exactly what I need.</p>
<p>Let’s say I have 4 videos (prefix v) , of different lengths (say, 2,3,1 sec) (prefix t) , and for every 1 sec, I get a feature vector of length 3 (prefix f).</p>
<p>So, as I understand my trainX would be like this, right? –&gt;</p>
<p>trainX=np.array (<br>
[  </p>
<p>[  [v1_t1_f1, v1_t1_f2, v1_t1_f3],<br>
[v1_t2_f1, v1_t2_f2, v1_t2_f3]    ],</p>
<p>[ [v2_t1_f1, v2_t1_f2, v2_t1_f3],<br>
[v2_t2_f1, v2_t2_f2, v2_t2_f3],<br>
[v2_t3_f1, v2_t3_f2, v2_t3_f3],  ],</p>
<p>[ [v3_t1_f1, v3_t1_f2, v3_t1_f3] ] )<br>
]<br>
(=[ [v1], [v2], [v3] ], and v is Nt x Nf python list?)</p>
<p>If I have v1, v2,v3, how do I start with an **empty** xTrain and update them **recursively** to xTrain, so that xTrain can be used by Keras?</p>
<p>I have tried np.append, np.insert, np.stack methods, but no success as yet, I always get some error. Kindly help!!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371822#respond" onclick="return addComment.moveForm( &quot;comment-371822&quot;, &quot;371822&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Vedhas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371830" class="comment even depth-2">

	      	<div id="li-comment-371830" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/44d0c02ff389748e58f26cb99d87a86b" srcset="http://1.gravatar.com/avatar/44d0c02ff389748e58f26cb99d87a86b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://vedhaspandit.blogspot.com/" rel="external nofollow" class="url">Vedhas</a></span>
	                <span class="date">November 23, 2016 at 10:18 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371830" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If I make my ‘v1′,’v2′,v3′ ..’v19’ as np arrays, and trainX as a list =[ v1, v2, v3…v19 ] using trainX.append(vn) –&gt; and eventually outside of for loop: trainX=np.array(trainX), I get following error.</p>
<p>File “/usr/local/lib/python2.7/dist-packages/keras/engine/training.py”, line 100, in standardize_input_data<br>
str(array.shape))<br>
Exception: Error when checking model input: expected lstm_input_1 to have 3 dimensions, but got array with shape (19, 1)</p>
<p>Which makes sense since, Keras must be expecting input to have 3 dimensions = (sample,tstep, features).</p>
<p>But how do I fix this???</p>
<p>Your comment is awaiting moderation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371830#respond" onclick="return addComment.moveForm( &quot;comment-371830&quot;, &quot;371830&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Vedhas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371829" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-371829" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/44d0c02ff389748e58f26cb99d87a86b" srcset="http://1.gravatar.com/avatar/44d0c02ff389748e58f26cb99d87a86b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://vedhaspandit.blogspot.com/" rel="external nofollow" class="url">Vedhas</a></span>
	                <span class="date">November 23, 2016 at 10:18 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-371829" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If I make my ‘v1′,’v2′,v3′ ..’v19’ as np arrays, and trainX as a list =[ v1, v2, v3…v19 ] using  trainX.append(vn) –&gt; and eventually outside of for loop: trainX=np.array(trainX), I get following error.</p>
<p> File “/usr/local/lib/python2.7/dist-packages/keras/engine/training.py”, line 100, in standardize_input_data<br>
    str(array.shape))<br>
Exception: Error when checking model input: expected lstm_input_1 to have 3 dimensions, but got array with shape (19, 1)</p>
<p>Which makes sense since, Keras must be expecting input to have 3 dimensions = (sample,tstep, features). </p>
<p>But how do I fix this???</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=371829#respond" onclick="return addComment.moveForm( &quot;comment-371829&quot;, &quot;371829&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Vedhas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-372213" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-372213" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9e8abedd3869110de46326844be84067" srcset="http://0.gravatar.com/avatar/9e8abedd3869110de46326844be84067?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ilias</span>
	                <span class="date">November 25, 2016 at 12:08 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372213" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Guestion about the stateful data representation.<br>
If I understood correctly prepare_data makes repeats the previous look_back sequences.<br>
For example the original data<br>
1<br>
2<br>
3<br>
4<br>
5<br>
6</p>
<p>will become<br>
1 2 3 -&gt; 4<br>
2 3 4 -&gt;5<br>
3 4 5 -&gt;6</p>
<p>Then when you reshape for the stateful LSTM don’t you feed these sequences like this ?<br>
batch 1 sequences  [ 1, 2, 3] -&gt; predict 4<br>
batch 2 sequences  [ 2, 3, 4] -&gt; predict 5<br>
batch 3 sequences  [ 3, 4, 5] -&gt; predict 6</p>
<p>In the stateful RNN shouldn’t it be two batches only that continue one from the next:<br>
batch 1 sequences  [ 1, 2, 3] -&gt; predict 4<br>
batch 2 sequences  [ 3, 4, 5] -&gt; predict 6</p>
<p>Or alternatively you can have it to return the full state and predict all of them<br>
batch 1 sequences  [ 1, 2, 3] -&gt; predict [2, 3, 4]<br>
batch 2 sequences  [ 3, 4, 5] -&gt; predict [4, 5, 6]</p>
<p>Thanks,<br>
Ilias</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372213#respond" onclick="return addComment.moveForm( &quot;comment-372213&quot;, &quot;372213&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Ilias">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-372214" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-372214" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9e8abedd3869110de46326844be84067" srcset="http://0.gravatar.com/avatar/9e8abedd3869110de46326844be84067?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ilias</span>
	                <span class="date">November 25, 2016 at 12:09 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry i mean for the stateful RNN<br>
batch 1 sequences [ 1, 2, 3] -&gt; predict 4<br>
batch 2 sequences [ 4, 5, 6] -&gt; predict 7 (not 3,4,5)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372214#respond" onclick="return addComment.moveForm( &quot;comment-372214&quot;, &quot;372214&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Ilias">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-372278" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-372278" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3fe641a6a3acaaede04ec4a239f78e41" srcset="http://0.gravatar.com/avatar/3fe641a6a3acaaede04ec4a239f78e41?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luca</span>
	                <span class="date">November 25, 2016 at 8:27 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372278" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi!<br>
First of all, thanks for the tutorial. I’m trying to predict data that are very similar to the example ones. I was playing with the code you gave, but then something very strange happened: if I fit a model using the flight data and i use those hyper parameters to predict white noise I receive a very accurate results. Example:</p>
<p>#Data Generation:</p>
<p>dataset = numpy.random.randint(500, size=(200,1))<br>
dataset = dataset.astype(‘float32’)</p>
<p>#Data Prediction:</p>
<p>scaler = MinMaxScaler(feature_range=(0, 1))<br>
dataset = scaler.fit_transform(dataset)</p>
<p>prediction in red:</p>
<p><a href="https://s17.postimg.org/oavua7uq7/download.png" rel="nofollow">https://s17.postimg.org/oavua7uq7/download.png</a></p>
<p>How could that be possible? White noise should be not predictable, what am I doing wrong?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372278#respond" onclick="return addComment.moveForm( &quot;comment-372278&quot;, &quot;372278&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Luca">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-372282" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-372282" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3fe641a6a3acaaede04ec4a239f78e41" srcset="http://0.gravatar.com/avatar/3fe641a6a3acaaede04ec4a239f78e41?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luca</span>
	                <span class="date">November 25, 2016 at 8:43 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372282" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, i was doing something very stupid, just ignore my latest post.</p>
<p>Cheers</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372282#respond" onclick="return addComment.moveForm( &quot;comment-372282&quot;, &quot;372282&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Luca">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-372293" class="comment even depth-3 parent">

	      	<div id="li-comment-372293" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3fe641a6a3acaaede04ec4a239f78e41" srcset="http://0.gravatar.com/avatar/3fe641a6a3acaaede04ec4a239f78e41?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luca</span>
	                <span class="date">November 25, 2016 at 10:09 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372293" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok, sorry again for the last correction, the result was obtained using:</p>
<p>plt.plot(dataset,”b”,model.predict(dataset[:,:,numpy.newaxis]),”r”)</p>
<p>so I’am actually predicting white noise, how could that be possible?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372293#respond" onclick="return addComment.moveForm( &quot;comment-372293&quot;, &quot;372293&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Luca">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-372371" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-372371" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 26, 2016 at 10:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372371" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Luca, glad you’re making progress.</p>
<p>If results are too good to be true, they usually are. There will be a bug somewhere.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372371#respond" onclick="return addComment.moveForm( &quot;comment-372371&quot;, &quot;372371&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-372747" class="comment even depth-5">

	      	<div id="li-comment-372747" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/44d0c02ff389748e58f26cb99d87a86b" srcset="http://1.gravatar.com/avatar/44d0c02ff389748e58f26cb99d87a86b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vedhas</span>
	                <span class="date">November 28, 2016 at 10:03 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372747" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Kindly reply to my question above as well, please?</p>
<p>How do I shape trainX for 4 videos (v1,..v4) , of different lengths (2,3,1 sec) and for every 1 sec, I get a feature vector [f1 f2 f3] ?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-372818" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-372818" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2016 at 8:50 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372818" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have examples of working with video data. Hopefully soon.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-372944" class="comment even depth-5">

	      	<div id="li-comment-372944" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/44d0c02ff389748e58f26cb99d87a86b" srcset="http://1.gravatar.com/avatar/44d0c02ff389748e58f26cb99d87a86b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vedhas</span>
	                <span class="date">November 30, 2016 at 4:18 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372944" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>oh, it is not about videos.. Question is about ‘instances/samples’ in general…<br>
I am saying,<br>
Instance1 through instance4 correspond to 2,3,1,5 feature vectors in time respectively, each of dimension 3. How do I shape these to train LSTM?</p>
<p>That is the whole idea behind the section “LSTM for Regression with Time Steps” above, right?</p>
<p>Features of instance1 should not be considered when training LSTM on instance2! Just as your paragraph says:</p>
<p>“Some sequence problems may have a varied number of time steps per sample. For example, you may have measurements of a physical machine leading up to a point of failure or a point of surge. Each incident would be a sample the observations that lead up to the event would be the time steps, and the variables observed would be the features.”</p>
<p>I don’t need *examples of working with video data.* Kindly advise only on how to shape trainX I mentioned above.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-376228" class="comment odd alt depth-4">

	      	<div id="li-comment-376228" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/a2c8293711c438a8fd3ee9d39803e330" srcset="http://1.gravatar.com/avatar/a2c8293711c438a8fd3ee9d39803e330?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shu</span>
	                <span class="date">December 20, 2016 at 3:51 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376228" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>look careful, isn’t there +1 shift in your white noise prediction? )))<br>
same as in charts in tutorial?<br>
best prediction for weather tomorrow is: it’ll be exact the same as today. see?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376228#respond" onclick="return addComment.moveForm( &quot;comment-376228&quot;, &quot;376228&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Shu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-372560" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-372560" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/236a49e0b91ead97e45054264dd38e80" srcset="http://2.gravatar.com/avatar/236a49e0b91ead97e45054264dd38e80?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Prakash</span>
	                <span class="date">November 27, 2016 at 1:24 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372560" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see many factors for your handling this time series prediction:</p>
<p>-Number of LSTM blocks<br>
-Lookback number<br>
-Epochs<br>
-Activation<br>
-Optimizer</p>
<p>Can you show the order of importance for these in creating a prediction model? Also, you have chosen 4 LSTM blocks, any reason for this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372560#respond" onclick="return addComment.moveForm( &quot;comment-372560&quot;, &quot;372560&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Prakash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-372663" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-372663" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 28, 2016 at 8:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372663" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question Prakash. I would say framing of the problem and network topology as the biggest levers.</p>
<p>I have more info on improving performance in deep learning here:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>I chose 4 neurons (memory modules) with a little trial and error.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372663#respond" onclick="return addComment.moveForm( &quot;comment-372663&quot;, &quot;372663&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-372909" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-372909" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3840fa4131978d58ac34a406583e6ec2" srcset="http://0.gravatar.com/avatar/3840fa4131978d58ac34a406583e6ec2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">C</span>
	                <span class="date">November 30, 2016 at 12:51 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-372909" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
When I try your “Stacked LSTMs with Memory Between Batches” example as it is, I found the following error. I wonder if you could help to explain what went wrong and how to rectify it please?<br>
Thank you.</p>
<p>ValueError                                Traceback (most recent call last)<br>
 in ()<br>
     41 model = Sequential()<br>
     42 model.add(LSTM(4, batch_input_shape=(batch_size, look_back, 1), stateful=True, return_sequences=True))<br>
—&gt; 43 model.add(LSTM(4, batch_input_shape=(batch_size, look_back, 1), stateful=True))<br>
     44 model.add(Dense(1))<br>
     45 model.compile(loss=’mean_squared_error’, optimizer=’adam’)</p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/keras/models.py in add(self, layer)<br>
    322                  output_shapes=[self.outputs[0]._keras_shape])<br>
    323         else:<br>
–&gt; 324             output_tensor = layer(self.outputs[0])<br>
    325             if type(output_tensor) is list:<br>
    326                 raise Exception(‘All layers in a Sequential model ‘</p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/keras/engine/topology.py in __call__(self, x, mask)<br>
    515         if inbound_layers:<br>
    516             # This will call layer.build() if necessary.<br>
–&gt; 517             self.add_inbound_node(inbound_layers, node_indices, tensor_indices)<br>
    518             # Outputs were already computed when calling self.add_inbound_node.<br>
    519             outputs = self.inbound_nodes[-1].output_tensors</p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/keras/engine/topology.py in add_inbound_node(self, inbound_layers, node_indices, tensor_indices)<br>
    569         # creating the node automatically updates self.inbound_nodes<br>
    570         # as well as outbound_nodes on inbound layers.<br>
–&gt; 571         Node.create_node(self, inbound_layers, node_indices, tensor_indices)<br>
    572<br>
    573     def get_output_shape_for(self, input_shape):</p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/keras/engine/topology.py in create_node(cls, outbound_layer, inbound_layers, node_indices, tensor_indices)<br>
    153<br>
    154         if len(input_tensors) == 1:<br>
–&gt; 155             output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))<br>
    156             output_masks = to_list(outbound_layer.compute_mask(input_tensors[0], input_masks[0]))<br>
    157             # TODO: try to auto-infer shape if exception is raised by get_output_shape_for.</p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/keras/layers/recurrent.py in call(self, x, mask)<br>
    225                                              constants=constants,<br>
    226                                              unroll=self.unroll,<br>
–&gt; 227                                              input_length=input_shape[1])<br>
    228         if self.stateful:<br>
    229             updates = []</p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/keras/backend/tensorflow_backend.py in rnn(step_function, inputs, initial_states, go_backwards, mask, constants, unroll, input_length)<br>
   1304             loop_vars=(time, output_ta) + states,<br>
   1305             parallel_iterations=32,<br>
-&gt; 1306             swap_memory=True)<br>
   1307         last_time = final_outputs[0]<br>
   1308         output_ta = final_outputs[1]</p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py in while_loop(cond, body, loop_vars, shape_invariants, parallel_iterations, back_prop, swap_memory, name)<br>
   2634     context = WhileContext(parallel_iterations, back_prop, swap_memory, name)<br>
   2635     ops.add_to_collection(ops.GraphKeys.WHILE_CONTEXT, context)<br>
-&gt; 2636     result = context.BuildLoop(cond, body, loop_vars, shape_invariants)<br>
   2637     return result<br>
   2638 </p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py in BuildLoop(self, pred, body, loop_vars, shape_invariants)<br>
   2467       self.Enter()<br>
   2468       original_body_result, exit_vars = self._BuildLoop(<br>
-&gt; 2469           pred, body, original_loop_vars, loop_vars, shape_invariants)<br>
   2470     finally:<br>
   2471       self.Exit()</p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py in _BuildLoop(self, pred, body, original_loop_vars, loop_vars, shape_invariants)<br>
   2448     for m_var, n_var in zip(merge_vars, next_vars):<br>
   2449       if isinstance(m_var, ops.Tensor):<br>
-&gt; 2450         _EnforceShapeInvariant(m_var, n_var)<br>
   2451<br>
   2452     # Exit the loop.</p>
<p>/home/nbuser/anaconda3_410/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py in _EnforceShapeInvariant(merge_var, next_var)<br>
    584           “Provide shape invariants using either the <code>shape_invariants</code> ”<br>
    585           “argument of tf.while_loop or set_shape() on the loop variables.”<br>
–&gt; 586           % (merge_var.name, m_shape, n_shape))<br>
    587   else:<br>
    588     if not isinstance(var, (ops.IndexedSlices, sparse_tensor.SparseTensor)):</p>
<p>ValueError: The shape for while_2/Merge_2:0 is not an invariant for the loop. It enters the loop with shape (1, 4), but has shape (?, 4) after one iteration. Provide shape invariants using either the <code>shape_invariants</code> argument of tf.while_loop or set_shape() on the loop variables.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=372909#respond" onclick="return addComment.moveForm( &quot;comment-372909&quot;, &quot;372909&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to C">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-373249" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-373249" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/b3b7d4552ec1688ae90202d77b70d16d" srcset="http://2.gravatar.com/avatar/b3b7d4552ec1688ae90202d77b70d16d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Icy</span>
	                <span class="date">December 1, 2016 at 8:14 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-373249" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason.<br>
Thank you for your LSTM tutorial! I would like to use it to do some predictions, however, the input_dim is two variables, and the output_dim is one, just like:  input: x(t) y(t) output: y(t+1) .I have known that you answered it with the window method. I still have no idea, any suggestions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=373249#respond" onclick="return addComment.moveForm( &quot;comment-373249&quot;, &quot;373249&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Icy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-373327" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-373327" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/b869c1376d634924b0173dc4e355a9a9" srcset="http://2.gravatar.com/avatar/b869c1376d634924b0173dc4e355a9a9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Benjamin S. Skrainka</span>
	                <span class="date">December 2, 2016 at 6:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-373327" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is an informative and fun article.  Thanks!</p>
<p>However, for this application, ARIMA and exponential smoothing perform better out of the box without any tuning.</p>
<p><code></code><code><br>
# Compare ARIMA vs. NN</code></p><code>
<p>library(forecast)<br>
library(ModelMetrics)</p>
<p>df.raw &lt;- read.csv('international-airline-passengers.csv', stringsAsFactors=FALSE)<br>
df &lt;- ts(df.raw[,2], start=c(1949,1), end=c(1960,12), frequency=12)</p>
<p># Same train/test split as example<br>
train.size &lt;- floor(length(df) * 0.67)<br>
ts.train &lt;- ts(df[1:train.size], start=c(1949,1), frequency=12)<br>
ts.test &lt;- ts(df[(train.size+1):length(df)], end=c(1960,12), frequency=12)</p>
<p>ts.fit &lt;- auto.arima(ts.train)<br>
ets.fit &lt;- ets(ts.train)</p>
<p>fcast &lt;- forecast(ts.fit, 4*12)<br>
y_hat &lt;- fcast$mean</p>
<p># Simple ARIMA vs. NN has RMSE = 8.83/26.47 vs. 22.61/51.58 for train/test<br>
ModelMetrics::rmse(ts.train, fcast$fitted)<br>
ModelMetrics::rmse(ts.test, y_hat)</p>
</code><p><code># ETS is even better ... RMSE 7.25/23.05<br>
ets.fcast &lt;- forecast(ets.fit, 4*12)<br>
ModelMetrics::rmse(ts.train, ets.fcast$fitted)<br>
ModelMetrics::rmse(ts.test, ets.fcast$mean)<br>
</code>`</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=373327#respond" onclick="return addComment.moveForm( &quot;comment-373327&quot;, &quot;373327&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Benjamin S. Skrainka">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-373351" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-373351" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 2, 2016 at 8:21 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-373351" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Agreed Benjamin. The post does show how LSTMs can be used, just not a very good use on this dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=373351#respond" onclick="return addComment.moveForm( &quot;comment-373351&quot;, &quot;373351&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397512" class="comment even depth-2">

	      	<div id="li-comment-397512" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 25, 2017 at 6:04 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397512" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is this Python too?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397512#respond" onclick="return addComment.moveForm( &quot;comment-397512&quot;, &quot;397512&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-374689" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-374689" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/c437f87dd8b09472b623c0abfa233c97" srcset="http://0.gravatar.com/avatar/c437f87dd8b09472b623c0abfa233c97?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">libra</span>
	                <span class="date">December 10, 2016 at 8:35 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-374689" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a question is how to predict the data outside the dataset</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=374689#respond" onclick="return addComment.moveForm( &quot;comment-374689&quot;, &quot;374689&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to libra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-374750" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-374750" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2016 at 5:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-374750" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi libra, train your model your training data and make predictions by calling model.predict(). </p>
<p>The batch size/pattern dimensions must match what was used to train the network.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=374750#respond" onclick="return addComment.moveForm( &quot;comment-374750&quot;, &quot;374750&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-375218" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-375218" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/fdb65a8627cb74436f847a9e6a1edf36" srcset="http://0.gravatar.com/avatar/fdb65a8627cb74436f847a9e6a1edf36?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nilavra Pathak</span>
	                <span class="date">December 15, 2016 at 1:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-375218" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, does the dataset need to be continuous … if i have intermittent missing data then is it supposed to work ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=375218#respond" onclick="return addComment.moveForm( &quot;comment-375218&quot;, &quot;375218&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nilavra Pathak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-375251" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-375251" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 15, 2016 at 8:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-375251" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can use 0 to pad and to mark missing values Nilavra.</p>
<p>Also, try consider imputing and see how that affects performance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=375251#respond" onclick="return addComment.moveForm( &quot;comment-375251&quot;, &quot;375251&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-375429" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-375429" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/078db419de97817bc2c8e6eb73e24ae5" srcset="http://0.gravatar.com/avatar/078db419de97817bc2c8e6eb73e24ae5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aubrey Li</span>
	                <span class="date">December 16, 2016 at 6:02 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-375429" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>This is a wonderful tutorial. As a beginner, just wondering, how do I know when I should add a layer and when I should add more neurons in a layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=375429#respond" onclick="return addComment.moveForm( &quot;comment-375429&quot;, &quot;375429&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Aubrey Li">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-375502" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-375502" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 17, 2016 at 11:09 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-375502" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>More layers offer more “levels of abstraction” or indirection, depending on how you want to conceptualize.</p>
<p>More nodes/modules in a layer offers more “capacity” at one level of abstraction.</p>
<p>Increasing the capacity of the network in terms of layers or neurons in a layer will both require more learning (epochs) or faster learning (learning rate).</p>
<p>What is the magic bullet for a given problem? There’s none. Find a big computer with lots of CPU/RAM and grind away a suite of ideas on a sample of the dataset to see what works well.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=375502#respond" onclick="return addComment.moveForm( &quot;comment-375502&quot;, &quot;375502&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-375591" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-375591" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/078db419de97817bc2c8e6eb73e24ae5" srcset="http://0.gravatar.com/avatar/078db419de97817bc2c8e6eb73e24ae5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aubrey Li</span>
	                <span class="date">December 17, 2016 at 10:25 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-375591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the reply, another question is, is there a typical scenario we should use stacked LSTM instead of the normal one?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=375591#respond" onclick="return addComment.moveForm( &quot;comment-375591&quot;, &quot;375591&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Aubrey Li">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-375643" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-375643" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2016 at 5:31 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-375643" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When you need more representation capacity.</p>
<p>It’s a vague answer , because it’s a hard question to answer objectively, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=375643#respond" onclick="return addComment.moveForm( &quot;comment-375643&quot;, &quot;375643&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-376253" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-376253" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/adece7ae7d5afd1d2137058749de3acf" srcset="http://1.gravatar.com/avatar/adece7ae7d5afd1d2137058749de3acf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Je</span>
	                <span class="date">December 20, 2016 at 5:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376253" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
 Many thanks for the tutorial. Very useful indeed. </p>
<p> Following up the question from Aubrey Li and your response to that, does it mean that if I double the number of LSTM nodes (from four to eight), it will perform better?. In other words, how did you decide that number of LSTM nodes to be of 4 and not 6 or 8?</p>
<p>Thanks <img draggable="false" class="emoji" alt="🙂" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f642.svg"></p>
<p>Regards</p>
<p>Je</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376253#respond" onclick="return addComment.moveForm( &quot;comment-376253&quot;, &quot;376253&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Je">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-376278" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-376278" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 20, 2016 at 7:26 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376278" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may perform better but may require a lot more training.</p>
<p>It may also not converge or it may overfit the problem.</p>
<p>Sadly, there is no magic bullet, just a ton of trial and error. This is why we must develop a strong test harness for a given problem and a strong baseline performance for models to out-perform.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376278#respond" onclick="return addComment.moveForm( &quot;comment-376278&quot;, &quot;376278&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-376564" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-376564" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/adece7ae7d5afd1d2137058749de3acf" srcset="http://1.gravatar.com/avatar/adece7ae7d5afd1d2137058749de3acf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Je</span>
	                <span class="date">December 21, 2016 at 6:02 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason. Please keep throwing all these nice and very informative blogs / tutorials. </p>
<p>Je</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376564#respond" onclick="return addComment.moveForm( &quot;comment-376564&quot;, &quot;376564&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Je">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-376593" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-376593" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 21, 2016 at 8:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376593" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Je.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376593#respond" onclick="return addComment.moveForm( &quot;comment-376593&quot;, &quot;376593&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-376447" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-376447" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9dc1076c8831ea242ddd4edd4448b8db" srcset="http://0.gravatar.com/avatar/9dc1076c8831ea242ddd4edd4448b8db?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">nrcjea001</span>
	                <span class="date">December 20, 2016 at 6:34 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>I’ve been struggling with a particular problem and I am hoping you can assist. Basically, I’m running a stateful LSTM following the same logic and code as you’ve discussed above and in addition I’ve played around a bit by adding for example a convolutional layer. My issue is with the mean squared error given at the last epoch (where verbose=2 in model.fit) compared to the mean squared error calculated from trainPredict as in the formula you provide above. Please correct me if I am wrong, but my intuition tells me that these two mean square errors should be the same or at least approximately equal because we are predicting on the training set. However, in my case the mean square error calculated from trainPredict is nearly 50% larger than the mean square error at the last epoch of model.fit. Initially, I thought this had something to do with the resetting of states, but this seems not to be the case with only small differences noticed through my investigation. Does anything come to mind of why this may be? I feel like there is something obvious I’m missing here.</p>
<p>model.compile(loss=’mean_squared_error’, optimizer=ada)<br>
for i in range(500):<br>
    XXm = model.fit(trainX, trainY, nb_epoch=1, batch_size=bats, verbose=0,<br>
    shuffle=False)<br>
    model.reset_states()<br>
    print(XXm.history)</p>
<p>at epoch 500: {‘loss’: [0.004482088498778204]}</p>
<p>trainPredict = model.predict(trainX, batch_size=bats)<br>
mean_squared_error(trainY, trainPredict[:,0])<br>
Out[68]: 0.0064886363673947768</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376447#respond" onclick="return addComment.moveForm( &quot;comment-376447&quot;, &quot;376447&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to nrcjea001">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-376583" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-376583" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 21, 2016 at 8:36 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376583" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I agree with your intuition, I would expect the last reported MSE to match a manually calculated MSE. Also, it is not obvious from a quick scan where you might be going wrong.</p>
<p>Start off by confirming this expectation on a standalone small network with a contrived or well understand dataset. Say one hidden layer MLP on the normalized boston house price dataset.</p>
<p>This is a valuable exercise because it cuts out all of the problem specific and technique specific code and concerns and gets right to the heart of the matter.</p>
<p>Once achieved, now come back to your project and cut it back to the bone until it achieves the same outcome. </p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376583#respond" onclick="return addComment.moveForm( &quot;comment-376583&quot;, &quot;376583&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-376881" class="comment odd alt depth-3">

	      	<div id="li-comment-376881" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9dc1076c8831ea242ddd4edd4448b8db" srcset="http://0.gravatar.com/avatar/9dc1076c8831ea242ddd4edd4448b8db?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">nrcjea001</span>
	                <span class="date">December 22, 2016 at 11:36 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376881" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>Thanks for getting back to me. </p>
<p>I followed your suggestion by running a simple MLP using the housing dataset but I’m still seeing differences. Here is my code as well as the output:</p>
<p>%reset -f<br>
import numpy<br>
seed = 50<br>
numpy.random.seed(seed)<br>
import pandas<br>
from keras.models import Sequential<br>
from keras.layers import Dense<br>
from sklearn.metrics import mean_squared_error</p>
<p>dataframe = pandas.read_csv(“housing.csv”, delim_whitespace=True,<br>
                            header=None)<br>
dataset = dataframe.values</p>
<p>X = dataset[:,0:13]<br>
Y = dataset[:,13]</p>
<p>model = Sequential()<br>
model.add(Dense(13, input_dim=13, init=’normal’, activation=’relu’))<br>
model.add(Dense(1, init=’normal’))<br>
model.compile(loss=’mean_squared_error’, optimizer=’adam’)</p>
<p>nep=100<br>
mhist = model.fit(X, Y, nb_epoch=nep, batch_size=3, verbose=0)<br>
print ‘MSE on last epoch:’, mhist.history[“loss”][nep-1]</p>
<p>PX=model.predict(X)<br>
print ‘Calculated MSE:’, mean_squared_error(Y, PX)</p>
<p>MSE on last epoch: 30.7131816067<br>
Calculated MSE: 28.8423397398</p>
<p>Please advise. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376881#respond" onclick="return addComment.moveForm( &quot;comment-376881&quot;, &quot;376881&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to nrcjea001">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-376894" class="comment even depth-3 parent">

	      	<div id="li-comment-376894" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9dc1076c8831ea242ddd4edd4448b8db" srcset="http://0.gravatar.com/avatar/9dc1076c8831ea242ddd4edd4448b8db?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">nrcjea001</span>
	                <span class="date">December 23, 2016 at 12:43 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Apologies. I forgot to scale. Used a MinMaxScaler</p>
<p>scalerX = MinMaxScaler(feature_range=(0, 1))<br>
scalerY = MinMaxScaler(feature_range=(0, 1))<br>
X = scalerX.fit_transform(dataset[:,0:13])<br>
Y = scalerY.fit_transform(dataset[:,13])</p>
<p>MSE on last epoch: 0.00589414117318<br>
Calculated MSE: 0.00565485540125</p>
<p>The difference is about 4%. Perhaps this is negligible?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376894#respond" onclick="return addComment.moveForm( &quot;comment-376894&quot;, &quot;376894&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to nrcjea001">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-376946" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-376946" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 23, 2016 at 5:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376946" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Might be small differences due to random number generators and platform differences.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376946#respond" onclick="return addComment.moveForm( &quot;comment-376946&quot;, &quot;376946&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-376751" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-376751" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/be6265c0bfa631867842fe70ec265f68" srcset="http://2.gravatar.com/avatar/be6265c0bfa631867842fe70ec265f68?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">David Holmgren</span>
	                <span class="date">December 22, 2016 at 10:07 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-376751" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you for an excellent introduction to using LSTM networks for time series prediction; I learned a great deal from this article. One question I did have: if I wanted to plot the difference between the data and prediction, would it be correct to use something like (in the case of the training data):</p>
<p>plt.plot(trainY[0]-trainPredict[:,0]),plt.show()</p>
<p>Once again, many thanks.</p>
<p>Regards,<br>
David</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=376751#respond" onclick="return addComment.moveForm( &quot;comment-376751&quot;, &quot;376751&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to David Holmgren">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-377030" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-377030" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/7182f74bb2b2ad405cf188e1408bf998" srcset="http://1.gravatar.com/avatar/7182f74bb2b2ad405cf188e1408bf998?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">unknnw0afa</span>
	                <span class="date">December 23, 2016 at 1:22 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-377030" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For the codes with stacked ltsm, I’m getting the following error. Copy paste the whole thing doesn’t work either. Any help?</p>
<p>The shape for while_1/Merge_2:0 is not an invariant for the loop. It enters the loop with shape (1, 4), but has shape (?, 4) after one iteration. Provide shape invariants using either the <code>shape_invariants</code> argument of tf.while_loop or set_shape() on the loop variables.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=377030#respond" onclick="return addComment.moveForm( &quot;comment-377030&quot;, &quot;377030&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to unknnw0afa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-377207" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-377207" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 24, 2016 at 4:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-377207" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ouch, I’ve not seen that before.</p>
<p>Perhaps try StackOverflow or the google group for the backend that you’re using?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=377207#respond" onclick="return addComment.moveForm( &quot;comment-377207&quot;, &quot;377207&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-377532" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-377532" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/ffa50b2ca24453993f3a1aaefc6db603" srcset="http://0.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Søren Pallesen</span>
	                <span class="date">December 25, 2016 at 9:18 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-377532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason.</p>
<p>Thanks for all you valuable advice here.</p>
<p>I have trained a model for time series prediction on a quite big data set, which took 12 hours for 100 epochs.</p>
<p>The results (validation accuracy) stayed flat for the first 90 epochs and then began to move up.</p>
<p>Now wonder how to add more training on top of a trained model in Keras without loosing the training gained from the first 100 epochs?</p>
<p>Best regards<br>
Søren</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=377532#respond" onclick="return addComment.moveForm( &quot;comment-377532&quot;, &quot;377532&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Søren Pallesen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-377651" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-377651" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 26, 2016 at 7:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-377651" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Søren,</p>
<p>You can save the weights of your network. Then later load them and continue training / refining weights.</p>
<p>See here for more info on saving and loading a network:<br>
<a href="http://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=377651#respond" onclick="return addComment.moveForm( &quot;comment-377651&quot;, &quot;377651&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-377884" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-377884" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/adece7ae7d5afd1d2137058749de3acf" srcset="http://1.gravatar.com/avatar/adece7ae7d5afd1d2137058749de3acf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Je</span>
	                <span class="date">December 27, 2016 at 10:31 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-377884" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
 Another question towards the normalisation. Here, we are lucky to have all the data for training and testing. And this has enabled us to normalise the data (MinMaxScaler).  However, in real-life, we may not have all the data in one go and in fact it is very likely the case that we will be receiving data from streams. In such cases, we will never has the max or min or even the sum. How do we handle this case (so that we can feed the RNN with the normalised values?). </p>
<p>One obvious  solution, perhaps, is calculating this over the running data. But that will be an expensive approach. Or something to do with stochastic  sampling strategy ? Any help Jason?</p>
<p>Thanks in advance </p>
<p>Kind Regards</p>
<p>Je</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=377884#respond" onclick="return addComment.moveForm( &quot;comment-377884&quot;, &quot;377884&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Je">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-378034" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-378034" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 28, 2016 at 7:03 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-378034" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question Je.</p>
<p>For normalization we need to estimate the expected extremes of the data (min/max). For standardization we need to estimate the expected mean and standard deviation. These can be stored and used any time to validate and prepare data.</p>
<p>For more on normalizing and standardizing time series data, see this post:<br>
<a href="http://machinelearningmastery.com/normalize-standardize-time-series-data-python/" rel="nofollow">http://machinelearningmastery.com/normalize-standardize-time-series-data-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=378034#respond" onclick="return addComment.moveForm( &quot;comment-378034&quot;, &quot;378034&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-378164" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-378164" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/adece7ae7d5afd1d2137058749de3acf" srcset="http://1.gravatar.com/avatar/adece7ae7d5afd1d2137058749de3acf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Je</span>
	                <span class="date">December 28, 2016 at 11:02 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-378164" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
 Thanks for the response and for the pointer. Useful  – I have to say. <img draggable="false" class="emoji" alt="🙂" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f642.svg"></p>
<p>Kind Regards</p>
<p>Je</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=378164#respond" onclick="return addComment.moveForm( &quot;comment-378164&quot;, &quot;378164&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Je">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-378284" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-378284" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 29, 2016 at 7:17 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-378284" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=378284#respond" onclick="return addComment.moveForm( &quot;comment-378284&quot;, &quot;378284&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-378165" class="comment odd alt depth-3">

	      	<div id="li-comment-378165" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/adece7ae7d5afd1d2137058749de3acf" srcset="http://1.gravatar.com/avatar/adece7ae7d5afd1d2137058749de3acf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Je</span>
	                <span class="date">December 28, 2016 at 11:08 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-378165" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason  for the response and for the pointer. Useful  – I have to say. <img draggable="false" class="emoji" alt="🙂" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=378165#respond" onclick="return addComment.moveForm( &quot;comment-378165&quot;, &quot;378165&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Je">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-380154" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-380154" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/f61a374094ff3ba065754b857667718e" srcset="http://0.gravatar.com/avatar/f61a374094ff3ba065754b857667718e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shaun L</span>
	                <span class="date">January 5, 2017 at 2:21 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-380154" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Great article! I got a lot of benefits from your work.</p>
<p>One question here, lots of LSTM code like yours use such</p>
<p>trainX[1,2,3,4] to target trainY[5]<br>
trainX[2,3,4,5] to target trainY[6]<br>
…</p>
<p>It is possible to make trainY also be time series? like</p>
<p>trainX[1,2,3,4] to target trainY[5,6]<br>
trainX[2,3,4,5] to target trainY[6,7]<br>
…<br>
So the prediction will be done at once rather than 5 and then 6.</p>
<p>Best regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=380154#respond" onclick="return addComment.moveForm( &quot;comment-380154&quot;, &quot;380154&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Shaun L">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-380256" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-380256" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 5, 2017 at 9:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-380256" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, Shaun.</p>
<p>Reform the dataset with two output variables. Then change the number of neurons in the output layer to 2.</p>
<p>I will have an example of this on the blog in coming weeks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=380256#respond" onclick="return addComment.moveForm( &quot;comment-380256&quot;, &quot;380256&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-380674" class="comment even depth-3">

	      	<div id="li-comment-380674" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2490869d5983b66d9554fd9ad2f3de8c" srcset="http://2.gravatar.com/avatar/2490869d5983b66d9554fd9ad2f3de8c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shaun L</span>
	                <span class="date">January 7, 2017 at 1:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-380674" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I look forward to your example! I really wonder the advantages and disadvantages in doing so.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=380674#respond" onclick="return addComment.moveForm( &quot;comment-380674&quot;, &quot;380674&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Shaun L">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381198" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-381198" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/cec9a1fb9da33ddc3027589735867b43" srcset="http://0.gravatar.com/avatar/cec9a1fb9da33ddc3027589735867b43?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joaco</span>
	                <span class="date">January 9, 2017 at 6:49 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-381198" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I am here again. I have achieved my goal to predict more than one day in this period of time. But now I have another question. I make X=[x1,x2…x30] and Y=[y1,y2…y7], which means I use 30 days to predict 7 days. When predicting y2, actually I used the real value. So here is the question. How can I put my predicted number,like y2,to the X sequence to predict y3? I am looking forward to your answer.<br>
Thank you very much</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=381198#respond" onclick="return addComment.moveForm( &quot;comment-381198&quot;, &quot;381198&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Joaco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-381367" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-381367" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4a0714b13c18cad59f44f7717ce255f2" srcset="http://1.gravatar.com/avatar/4a0714b13c18cad59f44f7717ce255f2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kavitha</span>
	                <span class="date">January 11, 2017 at 12:11 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-381367" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, a great tutorial.  I’m a newbie, and trying to understand this code.  My understanding of Keras is that time steps refers to the number of hidden nodes that the system back propagates to through time, and input dimensions refers to the number of ‘features’ for a given input datum (e.g. if we had 2 categorical values, the input dimensions would be 2). So what confuses me about the code is that it tries to model past values (look back) as the number of input dimensions.  Timesteps is always set to 1.  In that case isn’t the system not behaving like a recurrent network at all but more like an MLP?  Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=381367#respond" onclick="return addComment.moveForm( &quot;comment-381367&quot;, &quot;381367&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Kavitha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381423" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-381423" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 11, 2017 at 9:28 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-381423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Kavitha,</p>
<p>The tutorial demonstrates a number of ways that you can use LSTMs, including using lag variables as input features and lag variables as time steps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=381423#respond" onclick="return addComment.moveForm( &quot;comment-381423&quot;, &quot;381423&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-382370" class="comment even depth-3">

	      	<div id="li-comment-382370" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4a0714b13c18cad59f44f7717ce255f2" srcset="http://1.gravatar.com/avatar/4a0714b13c18cad59f44f7717ce255f2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kavitha</span>
	                <span class="date">January 16, 2017 at 10:21 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-382370" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Got it, thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=382370#respond" onclick="return addComment.moveForm( &quot;comment-382370&quot;, &quot;382370&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Kavitha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381656" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-381656" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/7037ad0dee4d261fb5f70ebd661ce68f" srcset="http://1.gravatar.com/avatar/7037ad0dee4d261fb5f70ebd661ce68f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nishat</span>
	                <span class="date">January 12, 2017 at 2:56 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-381656" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I am looking for a machine learning algorithm that can learn the timing issues like debounce and flip flops in logic circuits and predict an output.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=381656#respond" onclick="return addComment.moveForm( &quot;comment-381656&quot;, &quot;381656&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nishat">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381802" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-381802" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 13, 2017 at 9:08 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-381802" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds like an interesting problem Nishat.</p>
<p>This post might help you frame your problem for predictive modeling:<br>
<a href="http://machinelearningmastery.com/how-to-define-your-machine-learning-problem/" rel="nofollow">http://machinelearningmastery.com/how-to-define-your-machine-learning-problem/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=381802#respond" onclick="return addComment.moveForm( &quot;comment-381802&quot;, &quot;381802&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381871" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-381871" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/ad09ebe1207b6885ae4ffb1f3599a9f7" srcset="http://1.gravatar.com/avatar/ad09ebe1207b6885ae4ffb1f3599a9f7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sss</span>
	                <span class="date">January 13, 2017 at 5:43 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-381871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think this is wrong :len(dataset)-look_back-1<br>
it should be len(dataset)-look_back</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=381871#respond" onclick="return addComment.moveForm( &quot;comment-381871&quot;, &quot;381871&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to sss">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-382635" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-382635" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/21a2e054a47029615da747a31e7cf72e" srcset="http://2.gravatar.com/avatar/21a2e054a47029615da747a31e7cf72e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jakub</span>
	                <span class="date">January 17, 2017 at 9:04 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-382635" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p> I would like to point out that the graphics</p>
<p>LSTM Trained on Regression Formulation of Passenger Prediction Problem</p>
<p>is the most confusing part of the article.</p>
<p>The red line is NOT the actual prediction for 1,2,3, etc. steps ahead. As we can see from the data, you need to know the REAL value just at the time T to predict T+1, it is not based on your prediction in this setup.</p>
<p>If you need to do a prediction for more steps ahead a different approach is needed.</p>
<p>I am still grateful for the parts of the code you have provided, but this part led me way away from my goal.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=382635#respond" onclick="return addComment.moveForm( &quot;comment-382635&quot;, &quot;382635&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jakub">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383715" class="comment odd alt depth-2">

	      	<div id="li-comment-383715" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/aaa2c26ecafd7e384c264a422588526e" srcset="http://1.gravatar.com/avatar/aaa2c26ecafd7e384c264a422588526e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Faezeh</span>
	                <span class="date">January 24, 2017 at 3:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383715" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jakub, do you have any idea on what approach to take for multi-step ahead prediction?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383715#respond" onclick="return addComment.moveForm( &quot;comment-383715&quot;, &quot;383715&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Faezeh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-382996" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-382996" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2b8f4c09f62c81a948a954a563642fe2" srcset="http://2.gravatar.com/avatar/2b8f4c09f62c81a948a954a563642fe2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Salvo</span>
	                <span class="date">January 19, 2017 at 11:09 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-382996" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
I would control the input of the internal gate of the cell memory. is it a possible thing to do?<br>
In case of yes, what are the function that allow it? Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=382996#respond" onclick="return addComment.moveForm( &quot;comment-382996&quot;, &quot;382996&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Salvo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383068" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-383068" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 20, 2017 at 10:20 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383068" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t believe this is the case in Keras Salvo. I’m happy to be corrected though.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383068#respond" onclick="return addComment.moveForm( &quot;comment-383068&quot;, &quot;383068&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383188" class="comment even depth-3 parent">

	      	<div id="li-comment-383188" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2b8f4c09f62c81a948a954a563642fe2" srcset="http://2.gravatar.com/avatar/2b8f4c09f62c81a948a954a563642fe2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Salvo</span>
	                <span class="date">January 21, 2017 at 2:57 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383188" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your help! These articles are very useful for my studies!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383188#respond" onclick="return addComment.moveForm( &quot;comment-383188&quot;, &quot;383188&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Salvo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383251" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-383251" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 21, 2017 at 10:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383251" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that Salvo.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383251#respond" onclick="return addComment.moveForm( &quot;comment-383251&quot;, &quot;383251&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-383024" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-383024" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d902111389ae6ed31320da7a481d2835" srcset="http://1.gravatar.com/avatar/d902111389ae6ed31320da7a481d2835?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nader</span>
	                <span class="date">January 20, 2017 at 4:23 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>in the “LSTM for Regression with Time Steps”<br>
how can we add more layers to the model ?</p>
<p>model = Sequential()<br>
model.add(LSTM(4, input_dim=1))<br>
model.add(Dense(1))<br>
model.compile(loss=’mean_squared_error’, optimizer=’adam’)<br>
model.fit(trainX, trainY, nb_epoch=100, batch_size=1, verbose=2)</p>
<p>How can I add another Layer or more Layers ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383024#respond" onclick="return addComment.moveForm( &quot;comment-383024&quot;, &quot;383024&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nader">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383073" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-383073" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 20, 2017 at 10:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383073" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Nader,</p>
<p>Set the batch_input_shape on each layer and set the return_sequences argument on all layers except the output layer.</p>
<p>I’d recommend carefully re-reading the words and code in the section titled “Stacked LSTMs with Memory Between Batches”.</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383073#respond" onclick="return addComment.moveForm( &quot;comment-383073&quot;, &quot;383073&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-383182" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-383182" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/862ef7ab4dc40a72de4e86393e144083" srcset="http://2.gravatar.com/avatar/862ef7ab4dc40a72de4e86393e144083?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anthony</span>
	                <span class="date">January 21, 2017 at 1:25 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383182" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,<br>
Thanks for the nice blog. What Hardware configurations are required for running this program?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383182#respond" onclick="return addComment.moveForm( &quot;comment-383182&quot;, &quot;383182&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Anthony">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383250" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-383250" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 21, 2017 at 10:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383250" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Anthony, you’re welcome.</p>
<p>A normal PC without a GPU is just fine for running small LSTMs like those in this tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383250#respond" onclick="return addComment.moveForm( &quot;comment-383250&quot;, &quot;383250&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-383316" class="comment even depth-2">

	      	<div id="li-comment-383316" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/b9e1e62eb28c414051c7bd7e5f36169e" srcset="http://2.gravatar.com/avatar/b9e1e62eb28c414051c7bd7e5f36169e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nikola Tanković</span>
	                <span class="date">January 21, 2017 at 9:34 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383316" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a small question. I dont see how look_back feature is relevant. If I put look_back to zero or one but increase memory units to lets say 20, I get much better results because the network itself “learns” to look back as much as its needed. Can you replicate that? Isn’t that the whole point of LSTM?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383316#respond" onclick="return addComment.moveForm( &quot;comment-383316&quot;, &quot;383316&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nikola Tanković">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-383563" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-383563" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9bd571b865e88d016f24499710a40403" srcset="http://0.gravatar.com/avatar/9bd571b865e88d016f24499710a40403?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">January 23, 2017 at 6:57 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383563" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How do you recommend we include additional features, such as<br>
moving averages, standard deviation,etc.. ?</p>
<p>Also, how would we tune the Stacked LSTMs with Memory Between Batches<br>
to achieve better accuracy ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383563#respond" onclick="return addComment.moveForm( &quot;comment-383563&quot;, &quot;383563&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-383628" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-383628" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/f24339ae06ca3fce7fd89e57541752f7" srcset="http://0.gravatar.com/avatar/f24339ae06ca3fce7fd89e57541752f7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anthony</span>
	                <span class="date">January 23, 2017 at 4:04 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383628" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for a wonderful post. Your code uses keras which has tensorflow working in the background. Tensorflow is not available under Windows platform. Is there any way one could run this code in windows?<br>
I am using Anaconda.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383628#respond" onclick="return addComment.moveForm( &quot;comment-383628&quot;, &quot;383628&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Anthony">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383790" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-383790" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 24, 2017 at 11:00 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383790" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Anthony, absolutely. Use the Theano backend instead:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5906e65aa9566483466298" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">pip install theano</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5906e65aa9566483466298-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5906e65aa9566483466298-1"><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">theano</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383790#respond" onclick="return addComment.moveForm( &quot;comment-383790&quot;, &quot;383790&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397513" class="comment even depth-2">

	      	<div id="li-comment-397513" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 25, 2017 at 6:17 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397513" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correction 04.2017: Its available on Windows/Anaconda</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397513#respond" onclick="return addComment.moveForm( &quot;comment-397513&quot;, &quot;397513&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-383656" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-383656" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4607ce1a117f3d82a5a64651729bf772" srcset="http://1.gravatar.com/avatar/4607ce1a117f3d82a5a64651729bf772?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Akhilesh Kumar</span>
	                <span class="date">January 23, 2017 at 7:27 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383656" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think the way data is normalized in this tutorial is not correct. The shows hetroskadicity and hence needs advanced method of normalization.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383656#respond" onclick="return addComment.moveForm( &quot;comment-383656&quot;, &quot;383656&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Akhilesh Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383792" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-383792" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 24, 2017 at 11:01 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383792" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I agree Akhilesh.</p>
<p>The series really should have been made stationary first. A log or box-cox transform and then differenced.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383792#respond" onclick="return addComment.moveForm( &quot;comment-383792&quot;, &quot;383792&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-383708" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-383708" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/84dd416fba7e63dc0620b2ed320d7bd1" srcset="http://2.gravatar.com/avatar/84dd416fba7e63dc0620b2ed320d7bd1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">S Wollner</span>
	                <span class="date">January 24, 2017 at 2:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383708" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m sorry to tell you that this is no prediction.<br>
Your LSTM network learned to save the value from t-1 and  retrieve it at time t.</p>
<p>Try one thing… train this model on that dataset… and test this on a hole different Timeseries. E.g. a sincurve.</p>
<p>You will get the inputted sincurve with an offset of 1 timestep out. Maybe with some distortion in it.</p>
<p>I can get the same results with an stupid arima model…</p>
<p>This is no prediction at all. It just a stupid system.</p>
<p>Kind Regards,<br>
S. Wollner</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383708#respond" onclick="return addComment.moveForm( &quot;comment-383708&quot;, &quot;383708&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to S Wollner">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383797" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-383797" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 24, 2017 at 11:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-383797" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks S. Wollner,</p>
<p>It is a trivial perhaps even terrible prediction example, but it does show how to use the LSTM features of Keras.</p>
<p>I hope to provide some updated examples soon.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=383797#respond" onclick="return addComment.moveForm( &quot;comment-383797&quot;, &quot;383797&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397563" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-397563" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 25, 2017 at 4:42 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397563" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If the example is not predicting anything, is this article somehow misleading for those trying to predict with this code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397563#respond" onclick="return addComment.moveForm( &quot;comment-397563&quot;, &quot;397563&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397564" class="comment even depth-4 parent">

	      	<div id="li-comment-397564" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 25, 2017 at 5:01 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Now I have two adapted versions of the example, feeded with own data.</p>
<p>One from Wollner and one from Jason. Both are running and plotting.</p>
<p>With some additions, I’m even able to forecast unseen data- BUT…</p>
<p>As beginner, how can I decide whether I’m dealing with real predictions or not?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397564#respond" onclick="return addComment.moveForm( &quot;comment-397564&quot;, &quot;397564&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397627" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-397627" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2017 at 6:20 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397627" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Compare to a persistence model:<br>
<a href="http://machinelearningmastery.com/persistence-time-series-forecasting-with-python/" rel="nofollow">http://machinelearningmastery.com/persistence-time-series-forecasting-with-python/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397664" class="comment even depth-5">

	      	<div id="li-comment-397664" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 26, 2017 at 3:58 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397664" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384245" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-384245" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/84dd416fba7e63dc0620b2ed320d7bd1" srcset="http://2.gravatar.com/avatar/84dd416fba7e63dc0620b2ed320d7bd1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">S. Wollner</span>
	                <span class="date">January 26, 2017 at 8:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-384245" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi again,</p>
<p>I’ve updated your example so that a real prediction is possible.</p>
<p>What I did:<br>
set look_back to 25<br>
add a linear activation to the Dense layer<br>
and changed trainings settings like batch size</p>
<p>optionally I added detrending and stationarity of signal (Currently it’s commented out)</p>
<p>Here is the code:</p>
<p>import numpy<br>
import math<br>
import matplotlib.pyplot as plt<br>
import pandas<br>
from keras.models import Sequential<br>
from keras.layers import Dense<br>
from keras.layers import LSTM<br>
from keras.layers import Activation<br>
from sklearn.preprocessing import MinMaxScaler<br>
from sklearn.metrics import mean_squared_error</p>
<p># fix random seed for reproducibility<br>
numpy.random.seed(7)</p>
<p># load the dataset<br>
dataframe = pandas.read_csv(‘international-airline-passengers.csv’, usecols=[1], engine=’python’, skipfooter=3)<br>
dataset = dataframe.values<br>
dataset = dataset.astype(‘float32′)</p>
<p>#plt.plot(dataset);<br>
#plt.show();</p>
<p># normalize the dataset<br>
#dataset = numpy.log10(dataset) # stationary signal<br>
#dataset = numpy.diff(dataset, n=1, axis=0) # detrended signal<br>
dataset = (dataset – numpy.min(dataset)) / (numpy.max(dataset) – numpy.min(dataset))  # normalized signal</p>
<p>#plt.plot(dataset);<br>
#plt.show();</p>
<p># split into train and test sets<br>
train_size = int(len(dataset) * 0.67)<br>
test_size = len(dataset) – train_size<br>
train, test = dataset[:train_size,:], dataset[train_size:len(dataset),:]<br>
print(len(train), len(test))</p>
<p># convert an array of values into a dataset matrix<br>
def create_dataset(dataset, look_back=1):<br>
	dataX, dataY = [], []<br>
	for i in range(len(dataset)-look_back-1):<br>
		a = dataset[i:(i+look_back), 0]<br>
		dataX.append(a)<br>
		dataY.append(dataset[i + look_back, 0])<br>
	return numpy.array(dataX), numpy.array(dataY)</p>
<p># reshape into X=t and Y=t+1<br>
look_back = 25<br>
trainX, trainY = create_dataset(train, look_back)<br>
testX, testY = create_dataset(test, look_back)</p>
<p># reshape input to be [samples, time steps, features]<br>
trainX = numpy.reshape(trainX, (trainX.shape[0], 1, trainX.shape[1]))<br>
testX = numpy.reshape(testX, (testX.shape[0], 1, testX.shape[1]))</p>
<p># create and fit the LSTM network<br>
model = Sequential()<br>
model.add(LSTM(100, input_dim = look_back))<br>
model.add(Dense(1))<br>
model.add(Activation(“linear”))</p>
<p>model.compile(loss=’mean_squared_error’, optimizer=’adam’)<br>
#model.compile(loss=”mean_squared_error”, optimizer=”rmsprop”)<br>
model.fit(trainX, trainY, nb_epoch=100, batch_size=25, validation_data=(testX, testY), verbose=1)<br>
score = model.evaluate(testX, testY, verbose=0)<br>
print(‘Test score:’, score)</p>
<p># make predictions<br>
trainPredict = model.predict(trainX, verbose=0)<br>
testPredict = model.predict(testX, verbose=0)</p>
<p># shift train predictions for plotting<br>
trainPredictPlot = numpy.empty_like(dataset)<br>
trainPredictPlot[:, :] = numpy.nan<br>
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict</p>
<p># shift test predictions for plotting<br>
testPredictPlot = numpy.empty_like(dataset)<br>
testPredictPlot[:, :] = numpy.nan<br>
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict</p>
<p># plot baseline and predictions<br>
plt.plot(dataset)<br>
plt.plot(trainPredictPlot)<br>
plt.plot(testPredictPlot)<br>
plt.show()</p>
<p>Kind regards<br>
S. Wollner</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=384245#respond" onclick="return addComment.moveForm( &quot;comment-384245&quot;, &quot;384245&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to S. Wollner">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385611" class="comment even depth-2">

	      	<div id="li-comment-385611" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/7bbfeda73caaf00b021b3516639e2422" srcset="http://1.gravatar.com/avatar/7bbfeda73caaf00b021b3516639e2422?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kay</span>
	                <span class="date">February 2, 2017 at 10:52 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-385611" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Wollner,<br>
I tried to follow your code, however i got the prediction as a straight line. Where do you think i went wrong.<br>
Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=385611#respond" onclick="return addComment.moveForm( &quot;comment-385611&quot;, &quot;385611&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Kay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384354" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-384354" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/81165f2b9d49b613759b6e35663a212a" srcset="http://2.gravatar.com/avatar/81165f2b9d49b613759b6e35663a212a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luis</span>
	                <span class="date">January 27, 2017 at 1:10 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-384354" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, </p>
<p>Thank you for this excellent post. I have reproduce the example and also used a real time-series data set successfully. But I have a simple question:</p>
<p>How I can generate a sequence of predict new values? I mean future values (no the test values), for example, the six first months of the year 1961; values for 1961-01, 1961-02,…1961-06. </p>
<p>Luis</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=384354#respond" onclick="return addComment.moveForm( &quot;comment-384354&quot;, &quot;384354&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Luis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-384496" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-384496" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 27, 2017 at 12:09 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-384496" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Luis, you can make predictions on new data by calling y = model.predict(X)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=384496#respond" onclick="return addComment.moveForm( &quot;comment-384496&quot;, &quot;384496&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384423" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-384423" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/198775272650dd7bef414f45532c0b87" srcset="http://1.gravatar.com/avatar/198775272650dd7bef414f45532c0b87?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shazz</span>
	                <span class="date">January 27, 2017 at 5:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-384423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I hope I don’t ask for something already in the comments, but at least I did not see it. All my apologizes else.</p>
<p>Based on your dataset, let’s assume that we have more features than only the number of passengers per unit of time, for example the “current” weather, fuel price,… whatever.<br>
If I want to use them in the training, the idea is the same, for each one I “copy” the n loopback values for each sample ?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=384423#respond" onclick="return addComment.moveForm( &quot;comment-384423&quot;, &quot;384423&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to shazz">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-384505" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-384505" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 27, 2017 at 12:24 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-384505" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Shazz,</p>
<p>I would recommend creating a new dataset using DataFrame.shift() rather than the crude loop back function in this example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=384505#respond" onclick="return addComment.moveForm( &quot;comment-384505&quot;, &quot;384505&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384426" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-384426" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9bd571b865e88d016f24499710a40403" srcset="http://0.gravatar.com/avatar/9bd571b865e88d016f24499710a40403?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">January 27, 2017 at 6:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-384426" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello S. Wollner:</p>
<p>I too notice the predictions to be simply mimicking the last known value.<br>
Thanks for posting your code.</p>
<p>I had a couple questions on your post:</p>
<p>1. How did you set the batch_size ? It appears that matches the lookback.<br>
Is that intentional ?</p>
<p>2. Similarly, how did you know how to set the number of neurons to 100 via this line:<br>
model.add(LSTM(100, input_dim = look_back)) ?<br>
That appears to be 4*look_back ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=384426#respond" onclick="return addComment.moveForm( &quot;comment-384426&quot;, &quot;384426&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-384589" class="comment even depth-2">

	      	<div id="li-comment-384589" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/84dd416fba7e63dc0620b2ed320d7bd1" srcset="http://2.gravatar.com/avatar/84dd416fba7e63dc0620b2ed320d7bd1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">S. Wollner</span>
	                <span class="date">January 27, 2017 at 11:57 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-384589" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Sam,</p>
<p>To 1.:<br>
No it doesn’t have to match the look_back amount.<br>
Here is a similar question and a good answer<br>
<a href="http://stats.stackexchange.com/questions/153531/what-is-batch-size-in-neural-network" rel="nofollow">http://stats.stackexchange.com/questions/153531/what-is-batch-size-in-neural-network</a></p>
<p>Short, you devide your time series into pieces for training. In this case:<br>
Training_set_size = (data_size * train_size – forecast_amount) / look_back<br>
That is the set for training your network. Now you devide it by the batch_size.<br>
Each batch should have more or less the same size.<br>
In the link above you will see pros and cons about the size of each batch. </p>
<p>To 2.:<br>
Try and error, like almost everything with neuronal networks. That’s parameter optimization. There is no true config for all problems. The more neurons you have, the more powerful your network can be. The problem is you also need a larger trainingset.</p>
<p>Normally you iterate through the number of neurons. E.g. you start at 2 and go up till 100 in a step size of 2 neurons. For each step you calculate  at least 35 networks (statistical expression) and calculate the mean and variance over the error of train- and testset.<br>
Plot all the results in a graph and take the network with less complexity and best TEST rate (not train!). Consider variance and mean!!!</p>
<p>That’s a paper from our research group. In this paper you’ll see such a graphic for lvq networks (Figure 4).<br>
<a href="http://isommer.informatik.fh-schmalkalden.de/publications/2002_Sci_doc.pdf" rel="nofollow">http://isommer.informatik.fh-schmalkalden.de/publications/2002_Sci_doc.pdf</a></p>
<p>Kind regards,<br>
S. Wollner</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=384589#respond" onclick="return addComment.moveForm( &quot;comment-384589&quot;, &quot;384589&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to S. Wollner">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384825" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-384825" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9bd571b865e88d016f24499710a40403" srcset="http://0.gravatar.com/avatar/9bd571b865e88d016f24499710a40403?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">January 29, 2017 at 6:40 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-384825" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks S. Wollner for the guidance.</p>
<p>I’m currently trying to use this LSTM RNN to predict monthly stock returns.<br>
Again though I cannot beat the naive benchmark of simply predicting<br>
t+1 = t or predicting the future return is simply the last known/given return at time t.</p>
<p>I’m wondering what else I can tune /change in the LSTM RNN to remove<br>
the” mimicking” effect ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=384825#respond" onclick="return addComment.moveForm( &quot;comment-384825&quot;, &quot;384825&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-384931" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-384931" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/21b73b533faf33f148201dbaa646d7b3" srcset="http://2.gravatar.com/avatar/21b73b533faf33f148201dbaa646d7b3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">berkmeister</span>
	                <span class="date">January 29, 2017 at 11:17 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-384931" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The major difficulty here is that the time series is non stationary – it is both mean trending and the variance is exploding as well. It is very hard to forecast using this time series. </p>
<p>You get around this by scaling using the entire dataset, therefore violating the in-sample out-of-sample separation. In other words, you are looking into the future, i.e. your test set, for scaling – which unfortunately is not possible in real life.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=384931#respond" onclick="return addComment.moveForm( &quot;comment-384931&quot;, &quot;384931&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to berkmeister">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385392" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-385392" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2017 at 10:17 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-385392" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi berkmeister,</p>
<p>The level can be made stationary with order one differencing.</p>
<p>The variance can be made stationary with log or box-cox transforms.</p>
<p>Both methods can be used on test and training data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=385392#respond" onclick="return addComment.moveForm( &quot;comment-385392&quot;, &quot;385392&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-385154" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-385154" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4926b322d2b4e04f0b40f93fd1b206bc" srcset="http://1.gravatar.com/avatar/4926b322d2b4e04f0b40f93fd1b206bc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdulaziz Almalaq</span>
	                <span class="date">January 31, 2017 at 10:14 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-385154" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Many thanks to your post and tutorial. I really got the most beneficial of ideas to apply the LSTM to my problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=385154#respond" onclick="return addComment.moveForm( &quot;comment-385154&quot;, &quot;385154&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Abdulaziz Almalaq">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385406" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-385406" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2017 at 10:35 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-385406" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=385406#respond" onclick="return addComment.moveForm( &quot;comment-385406&quot;, &quot;385406&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-385583" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-385583" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/95358e17f0ce5d43d24408a2e76fa2d8" srcset="http://0.gravatar.com/avatar/95358e17f0ce5d43d24408a2e76fa2d8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">February 2, 2017 at 6:21 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-385583" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe I have made the stock data in my dataset stationary by taking the first difference of the log of the prices.</p>
<p>However, if I want to include additional features such as<br>
volatility,  a moving average, etc… would those be computed<br>
 on the ORIGINAL stock prices or on the newly calculated<br>
log differences, which are stationary ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=385583#respond" onclick="return addComment.moveForm( &quot;comment-385583&quot;, &quot;385583&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385643" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-385643" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 2, 2017 at 2:03 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-385643" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question Sam.</p>
<p>I don’t work with security prices myself, but I expect you will want those measures on the original data.</p>
<p>From a feature engineering perspective, I’d recommend testing alternatives and use what results in the most accurate predictive models.</p>
<p>Regarding predicting security prices in the short term, consider using a persistence model:<br>
<a href="http://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/" rel="nofollow">http://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=385643#respond" onclick="return addComment.moveForm( &quot;comment-385643&quot;, &quot;385643&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-386377" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-386377" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/639a47495050bbd5f4f0acc38e9ec371" srcset="http://0.gravatar.com/avatar/639a47495050bbd5f4f0acc38e9ec371?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">February 7, 2017 at 10:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-386377" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Another question I had was on performing 2 or more day ahead forecasts on a stationary time series<br>
with first differences.<br>
For example, if we want to forecast 5 days ahead of day (instead of 1 day), would we instead use<br>
the differences between t and t-5  ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=386377#respond" onclick="return addComment.moveForm( &quot;comment-386377&quot;, &quot;386377&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-386526" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-386526" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 8, 2017 at 9:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-386526" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Sam,</p>
<p>Forecasts would be made one time step at a time. The differences can then be inverted from the last known observation across each of the predicted time steps.</p>
<p>I hope that answers your question.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=386526#respond" onclick="return addComment.moveForm( &quot;comment-386526&quot;, &quot;386526&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-386696" class="comment even depth-3 parent">

	      	<div id="li-comment-386696" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/47018df53972150d37a4ca086469bd66" srcset="http://1.gravatar.com/avatar/47018df53972150d37a4ca086469bd66?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">February 9, 2017 at 5:49 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-386696" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Unfortunately I’m not able to follow.</p>
<p>Suppose we have the following stock price history</p>
<p>Date 	Price	Difference<br>
1/2/2017	100<br>
1/3/2017	102	           2<br>
1/4/2017	104	           2<br>
1/5/2017	105	           1<br>
1/6/2017	106		   1<br>
1/7/2017	107		   1<br>
1/8/2017	108		   1</p>
<p>If we want to forecast what the price will be on January 8th STARTING from January 3rd (a 5 day horizon),<br>
how would build the differences to make the series stationary? If we continue with first differences, then I believe we would only be forecasting the change from Jan 7th to Jan 8, which is still<br>
a 1 day change, not a 5 day ?</p>
<p>Thanks again.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=386696#respond" onclick="return addComment.moveForm( &quot;comment-386696&quot;, &quot;386696&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-386721" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-386721" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 9, 2017 at 7:30 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-386721" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Sam,</p>
<p>Off the cuff: The LSTM can forecast a 5-day horizon by having 5 neurons in the output layer and learn from differenced data. The difference inverse can be applied from the last know observation and propagated along the forecast to get back to domain values.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=386721#respond" onclick="return addComment.moveForm( &quot;comment-386721&quot;, &quot;386721&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-386875" class="comment even depth-5">

	      	<div id="li-comment-386875" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d26ec2a1e7b8eac98179518360b88f43" srcset="http://1.gravatar.com/avatar/d26ec2a1e7b8eac98179518360b88f43?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">February 10, 2017 at 4:53 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-386875" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Alright, so if I understand correctly, the 5 outputs from the output layer<br>
would correspond to the differences between days 0-1,1 -2, 2-3,3-4, 4-5 respectively?</p>
<p>Thanks for your patience.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-386904" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-386904" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 10, 2017 at 9:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-386904" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct Sam.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-387092" class="comment even depth-5">

	      	<div id="li-comment-387092" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d26ec2a1e7b8eac98179518360b88f43" srcset="http://1.gravatar.com/avatar/d26ec2a1e7b8eac98179518360b88f43?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">February 11, 2017 at 3:52 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-387092" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>One more question on that:<br>
Would I also need to modify the target values (trainY) so they<br>
contained 5 targets per sample, instead of just one  ? That is to match up the<br>
5 RNN outputs ?</p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-387114" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-387114" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 11, 2017 at 5:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-387114" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-386484" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-386484" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/589a7d258cc382ca718790a7c85c79dc" srcset="http://2.gravatar.com/avatar/589a7d258cc382ca718790a7c85c79dc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kim</span>
	                <span class="date">February 8, 2017 at 3:10 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-386484" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason<br>
I have some question about using multivariable.</p>
<p>Did I understand correctly?<br>
for example, if i have three variables and one window (just one day, continuous data)<br>
data structure is In this way,</p>
<p>variable1 variable2 variable3 output1<br>
(input_shape=(1, 3))</p>
<p>and, if i have three variables and two windows (two day, continuous data)<br>
data structure is In this way,</p>
<p>variable1(t-1) variable2(t-1) variable3(t-1) output1(t-1)<br>
variable1        variable2       variable3        output1<br>
(input_shape=(2, 3))</p>
<p>is it right way? thank in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=386484#respond" onclick="return addComment.moveForm( &quot;comment-386484&quot;, &quot;386484&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Kim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-387068" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-387068" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9e46b5217e312a32f9361172db1bf576" srcset="http://0.gravatar.com/avatar/9e46b5217e312a32f9361172db1bf576?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">YS_XIE</span>
	                <span class="date">February 11, 2017 at 1:52 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-387068" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Many thanks to your post and tutorial. I really got the most beneficial of ideas to apply the LSTM to my problem.</p>
<p>I have some questions:<br>
1): How to save the test data and predict dat to a text file?<br>
2): How to save the output image ?</p>
<p>Thanks a lot.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=387068#respond" onclick="return addComment.moveForm( &quot;comment-387068&quot;, &quot;387068&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to YS_XIE">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-387112" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-387112" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 11, 2017 at 5:05 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-387112" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can save data to a file using Python IO functions, npy functions for saving the matrix, or wrap it in a dataframe and save that.</p>
<p>You can save a plot using the matplotlib function savefig().</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=387112#respond" onclick="return addComment.moveForm( &quot;comment-387112&quot;, &quot;387112&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-387166" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-387166" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d219af79b45e5891507fda4c4c2139a0" srcset="http://1.gravatar.com/avatar/d219af79b45e5891507fda4c4c2139a0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">YS_XIE</span>
	                <span class="date">February 11, 2017 at 11:56 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-387166" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your quickly reply. I have resolved the problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=387166#respond" onclick="return addComment.moveForm( &quot;comment-387166&quot;, &quot;387166&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to YS_XIE">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-387339" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-387339" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 12, 2017 at 5:33 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-387339" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=387339#respond" onclick="return addComment.moveForm( &quot;comment-387339&quot;, &quot;387339&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-388017" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-388017" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3c6f3e72c301df099f2b54b74bfb3b58" srcset="http://0.gravatar.com/avatar/3c6f3e72c301df099f2b54b74bfb3b58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tony Zhang</span>
	                <span class="date">February 15, 2017 at 12:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388017" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason<br>
It’s a great tutorial. I have learnt a lot from it. Thank you very much.<br>
By the way, is it possible to use the LSTM-RNN to obtain the predictions with a probability distribution?  I think it will be even better if LSTM-RNN can do this.<br>
Please let me know if I have the wrong thinking.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388017#respond" onclick="return addComment.moveForm( &quot;comment-388017&quot;, &quot;388017&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Tony Zhang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-388119" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-388119" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 15, 2017 at 11:36 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388119" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure Tony, you could use a sigmoid on the output layer and interpret it as a probability distribution.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388119#respond" onclick="return addComment.moveForm( &quot;comment-388119&quot;, &quot;388119&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-388138" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-388138" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3c6f3e72c301df099f2b54b74bfb3b58" srcset="http://0.gravatar.com/avatar/3c6f3e72c301df099f2b54b74bfb3b58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tony Zhang</span>
	                <span class="date">February 15, 2017 at 12:26 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388138" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your quickly reply.<br>
Maybe I have asked in a wrong way. I mean like the example above, is it possible we get the probability distributions of the  predicted future passengers at the same time? In other words, how confident we are sure about the prediction accuracies.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388138#respond" onclick="return addComment.moveForm( &quot;comment-388138&quot;, &quot;388138&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Tony Zhang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-388330" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-388330" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 16, 2017 at 11:01 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388330" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not directly Tony.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388330#respond" onclick="return addComment.moveForm( &quot;comment-388330&quot;, &quot;388330&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-388068" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-388068" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/c1f56505915b6e945224f40186b4bce4" srcset="http://0.gravatar.com/avatar/c1f56505915b6e945224f40186b4bce4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amw 5G</span>
	                <span class="date">February 15, 2017 at 6:19 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388068" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this, it has been a great help in debugging my own keras RNN code.  A suggestion for your root LSTM for Regression with Time Steps model, as examples of what else you could do:</p>
<p>First, incorporate the month number as a predictor.  This helps with the obvious seasonality in the time series.  You can do this by creating an N-by-lookback shaped matrix where the value equals the month number (0 for January, …, 11 for December).  I did it by adjusting the create_dataset function to look like<br>
def create_dataset(dataset, look_back=1):<br>
	dataX, dataY, dataT = [], [], []<br>
	for i in range(len(dataset)-look_back-1):<br>
		a = dataset[i:(i+look_back), 0]<br>
		dataX.append(a)<br>
		dataY.append(dataset[i + look_back, 0])<br>
		b = [x % (12) for x in range(i, i+(look_back))] #12 because that’s how many months are in a year<br>
		dataT.append(b)<br>
	return numpy.array(dataX), numpy.array(dataY), numpy.array(dataT)</p>
<p>Then, feed this into an embedding layer to create a one-hot vector of 12 dimensions.  Your model will now have two branches (one for the time series and one for the vector of month indicators), that merge into a single model containing the RNN.  F. Chollet has some examples at <a href="https://keras.io/getting-started/sequential-model-guide/" rel="nofollow">https://keras.io/getting-started/sequential-model-guide/</a>.  I did it with<br>
month_model = Sequential()<br>
month_model.add(Embedding(12, 12, input_length=look_back))<br>
month_model.add(GRU(output_dim=4, return_sequences=True))<br>
month_model.add(TimeDistributed(Dense(look_back)))</p>
<p>series_model = Sequential()<br>
series_model.add(Dense(look_back, input_shape=(look_back,1)))<br>
model = Sequential()<br>
model.add(Merge([month_model, series_model], mode=’concat’, concat_axis=-1))<br>
model.add(GRU(4, return_sequences=False))<br>
model.add(Dense(1))<br>
model.compile(loss=’mean_squared_error’, optimizer=’adam’)</p>
<p>Lastly, I used a callback to ensure that the model didn’t overfit during the 100 epochs.  Specifically, if the loss on the validation set stopped decreasing, the model would early terminate.  I found I didn’t really need even half of the epochs, thus saving some time.  E.g.,<br>
early_stopping = EarlyStopping(monitor=’val_loss’, patience=3)<br>
model.fit([np.array(trainT.squeeze()),trainX], trainY.squeeze(), validation_data=([np.array(testT.squeeze()),testX],testY.squeeze()), nb_epoch=100, batch_size=1, verbose=2, callbacks=[early_stopping]) </p>
<p>Using a lookback of 3, my training set had a RMSE of 7.38, and 17.69 for the validation set.  Which I think is a pretty decent improvement with minimal additional work.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388068#respond" onclick="return addComment.moveForm( &quot;comment-388068&quot;, &quot;388068&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Amw 5G">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-388123" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-388123" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 15, 2017 at 11:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388123" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very nice Amw, thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388123#respond" onclick="return addComment.moveForm( &quot;comment-388123&quot;, &quot;388123&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-389427" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-389427" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/0317b0ff1dcc70bd66acde87bc50bba3" srcset="http://0.gravatar.com/avatar/0317b0ff1dcc70bd66acde87bc50bba3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DAN</span>
	                <span class="date">February 21, 2017 at 11:11 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I was testing your code, when you run the function create_dataset, it gives an error:<br>
trainX, trainY = create_dataset(train, look_back)</p>
<p>ValueError: too many values to unpack (expected 2)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389427#respond" onclick="return addComment.moveForm( &quot;comment-389427&quot;, &quot;389427&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to DAN">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389470" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-389470" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 22, 2017 at 10:03 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389470" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dan,</p>
<p>Perhaps check that you do not have any extra white space and that you have not modified the example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389470#respond" onclick="return addComment.moveForm( &quot;comment-389470&quot;, &quot;389470&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-389649" class="comment odd alt depth-3">

	      	<div id="li-comment-389649" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/69ce35b0ed7805bdd0a5c35a3d078f02" srcset="http://0.gravatar.com/avatar/69ce35b0ed7805bdd0a5c35a3d078f02?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">KJ</span>
	                <span class="date">February 23, 2017 at 9:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389649" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think you are missing some Keras dependencies.  Make sure you have:</p>
<p>from keras.models import Sequential<br>
from keras.layers import Dense<br>
from keras.layers import Embedding<br>
from keras.layers import GRU<br>
from keras.layers import Merge<br>
from keras.layers import TimeDistributed<br>
from keras.callbacks import EarlyStopping</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389649#respond" onclick="return addComment.moveForm( &quot;comment-389649&quot;, &quot;389649&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to KJ">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-390449" class="comment even depth-3">

	      	<div id="li-comment-390449" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/0317b0ff1dcc70bd66acde87bc50bba3" srcset="http://0.gravatar.com/avatar/0317b0ff1dcc70bd66acde87bc50bba3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DAN</span>
	                <span class="date">February 28, 2017 at 1:36 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-390449" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The error comes from: trainX,trainY = create_dataset(train, look_back), If I remove trainY, it works…wtf</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=390449#respond" onclick="return addComment.moveForm( &quot;comment-390449&quot;, &quot;390449&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to DAN">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-389648" class="comment odd alt depth-2">

	      	<div id="li-comment-389648" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/69ce35b0ed7805bdd0a5c35a3d078f02" srcset="http://0.gravatar.com/avatar/69ce35b0ed7805bdd0a5c35a3d078f02?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">KJ</span>
	                <span class="date">February 23, 2017 at 9:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389648" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice idea.</p>
<p>What do you feed into trainPredict and testPredict?</p>
<p>trainPredict = model.predict(numpy.array(trainT.squeeze()),trainX], batch_size=batch_size)<br>
gives me an invalid syntax error.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389648#respond" onclick="return addComment.moveForm( &quot;comment-389648&quot;, &quot;389648&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to KJ">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-388722" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-388722" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/0317b0ff1dcc70bd66acde87bc50bba3" srcset="http://0.gravatar.com/avatar/0317b0ff1dcc70bd66acde87bc50bba3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HD</span>
	                <span class="date">February 18, 2017 at 2:33 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388722" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Sir,</p>
<p>This guide is amazing, but how can we use that to predict out of sample ?</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388722#respond" onclick="return addComment.moveForm( &quot;comment-388722&quot;, &quot;388722&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to HD">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-388797" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-388797" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 18, 2017 at 8:42 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-388797" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Train your model on all your historical data then call model.predict().</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=388797#respond" onclick="return addComment.moveForm( &quot;comment-388797&quot;, &quot;388797&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389258" class="comment even depth-3">

	      	<div id="li-comment-389258" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/0317b0ff1dcc70bd66acde87bc50bba3" srcset="http://0.gravatar.com/avatar/0317b0ff1dcc70bd66acde87bc50bba3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HD</span>
	                <span class="date">February 20, 2017 at 9:25 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389258" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It didn’t work for me. I’ve done: train_size = int(len(dataset) * 1)<br>
and removed all the test data but still it does predict inside the samples.<br>
Is there a function that I should add ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389258#respond" onclick="return addComment.moveForm( &quot;comment-389258&quot;, &quot;389258&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to HD">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-389606" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-389606" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9bc96a84df63105e3d98f3802214cddb" srcset="http://0.gravatar.com/avatar/9bc96a84df63105e3d98f3802214cddb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">February 23, 2017 at 4:24 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this great post.<br>
I just have two questions:</p>
<p>1) What would be the code to add to show the accuracy in percentage?<br>
2) How can I code the red line to show the next prediction at the end of the chart?</p>
<p>Thank you in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389606#respond" onclick="return addComment.moveForm( &quot;comment-389606&quot;, &quot;389606&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389643" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-389643" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 23, 2017 at 8:55 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389643" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Chris,</p>
<p>It is a regression problem so accuracy does not make sense. If it were a classification problem, the activation function in the output layer would have to be changed to sigmoid or similar. </p>
<p>You can predict the next out of sample value by training the model on all available data and calling model.predict()</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389643#respond" onclick="return addComment.moveForm( &quot;comment-389643&quot;, &quot;389643&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389770" class="comment odd alt depth-3">

	      	<div id="li-comment-389770" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/9bc96a84df63105e3d98f3802214cddb" srcset="http://0.gravatar.com/avatar/9bc96a84df63105e3d98f3802214cddb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">February 24, 2017 at 2:37 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389770" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok, I will try.<br>
Thank you Jason <img draggable="false" class="emoji" alt="😉" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f609.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389770#respond" onclick="return addComment.moveForm( &quot;comment-389770&quot;, &quot;389770&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-389698" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-389698" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/69ce35b0ed7805bdd0a5c35a3d078f02" srcset="http://0.gravatar.com/avatar/69ce35b0ed7805bdd0a5c35a3d078f02?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">KJ</span>
	                <span class="date">February 23, 2017 at 3:29 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389698" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I really appreciate the time you put into this very detailed explanation of time series prediction. I think there are a couple of errors in your code, which appear to be confusing a lot of people:</p>
<p>1. When you read the file, skipfooter should = 2, not 3, as there are only two lines of data after the last value.  The existing code prevents the last value from being added to dataset.</p>
<p>2. Similarly, in create_dataset, you should not subtract 1 in the range of the for loop.  Again, this prevents the last value from being added to dataX and dataY.</p>
<p>3. Finally, you should not use the the shift train prediction, and the shift test prediction is incorrect.  This has the effect of making it appear that the prediction at t=0 instead of t+1.  I think this is why many people have been asking how to predict the last value.</p>
<p>Here is my code which both demonstrates and fixes these issues.  Please feel free to tell me I’m wrong.</p>
<p># Stacked LSTM for international airline passengers problem with memory<br>
import numpy<br>
import matplotlib.pyplot as plt<br>
import pandas<br>
import math<br>
from keras.models import Sequential<br>
from keras.layers import Dense<br>
from keras.layers import LSTM<br>
from sklearn.preprocessing import MinMaxScaler<br>
from sklearn.metrics import mean_squared_error</p>
<p># convert an array of values into a dataset matrix<br>
def create_dataset(dataset, look_back=1):<br>
	dataX, dataY = [], []<br>
	for i in range(len(dataset)-look_back):  # – 1 IS WRONG.  IT PREVENTS LAST VALUE OF DATASET FROM BEING USED FOR dataX AND dataY<br>
		a = dataset[i:(i+look_back), 0]<br>
		dataX.append(a)<br>
		dataY.append(dataset[i + look_back, 0])<br>
	return numpy.array(dataX), numpy.array(dataY)</p>
<p># fix random seed for reproducibility<br>
numpy.random.seed(7)</p>
<p># load the dataset<br>
# No header on data<br>
dataframe = pandas.read_csv(‘international-airline-passengers.csv’, usecols=[1], engine=’python’, skipfooter=2) # 3 IS WRONG AS THERE ARE ONLY TWO LINES IN THE FOOTER.  THIS PREVENTS THE LAST VALUE FROM BEING READ.<br>
dataset = dataframe.values<br>
dataset = dataset.astype(‘float32’)</p>
<p>print()<br>
print(‘Last 5 values from dataset’)<br>
print(dataset[dataset.shape[0] – 5])<br>
print(dataset[dataset.shape[0] – 4])<br>
print(dataset[dataset.shape[0] – 3])<br>
print(dataset[dataset.shape[0] – 2])<br>
print(dataset[dataset.shape[0] – 1])<br>
print()</p>
<p># normalize the dataset<br>
scaler = MinMaxScaler(feature_range=(0, 1))<br>
dataset = scaler.fit_transform(dataset)</p>
<p># split into train and test sets<br>
train_size = int(len(dataset) * 0.67)<br>
test_size = len(dataset) – train_size<br>
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]</p>
<p># reshape into X=t and Y=t+1<br>
look_back = 1<br>
trainX, trainY = create_dataset(train, look_back)<br>
testX, testY = create_dataset(test, look_back)</p>
<p># reshape input to be [samples, time steps, features]<br>
trainX = numpy.reshape(trainX, (trainX.shape[0], trainX.shape[1], 1))<br>
testX = numpy.reshape(testX, (testX.shape[0], testX.shape[1], 1))</p>
<p># create and fit the LSTM network<br>
batch_size = 1<br>
model = Sequential()<br>
model.add(LSTM(12, batch_input_shape=(batch_size, look_back, 1), stateful=True, return_sequences=True))<br>
model.add(LSTM(12, stateful=True))<br>
model.add(Dense(1))<br>
model.compile(loss=’mean_squared_error’, optimizer=’adam’)</p>
<p>for i in range(1):<br>
	model.fit(trainX, trainY, nb_epoch=1, batch_size=batch_size, verbose=0, shuffle=False) # I JUST SET VERBOSE=0 SO IT IS EASIER TO SEE THE PRINTED DATA<br>
	model.reset_states()</p>
<p># make predictions<br>
trainPredict = model.predict(trainX, batch_size=batch_size)<br>
model.reset_states()<br>
testPredict = model.predict(testX, batch_size=batch_size)</p>
<p># invert predictions<br>
trainPredict = scaler.inverse_transform(trainPredict)<br>
trainY = scaler.inverse_transform([trainY])<br>
testPredict = scaler.inverse_transform(testPredict)<br>
testY = scaler.inverse_transform([testY])</p>
<p># print the data<br>
testX = scaler.inverse_transform(testX[:,0,0])<br>
print()<br>
print(‘testX’,’testY’, ‘testPredict’)<br>
print(testX[testX.shape[0] – 5], round(testY[0, testY.shape[1] – 5]), round(testPredict[testPredict.shape[0] – 5, 0]))<br>
print(testX[testX.shape[0] – 4], round(testY[0, testY.shape[1] – 4]), round(testPredict[testPredict.shape[0] – 4, 0]))<br>
print(testX[testX.shape[0] – 3], round(testY[0, testY.shape[1] – 3]), round(testPredict[testPredict.shape[0] – 3, 0]))<br>
print(testX[testX.shape[0] – 2], round(testY[0, testY.shape[1] – 2]), round(testPredict[testPredict.shape[0] – 2, 0]))<br>
print(testX[testX.shape[0] – 1], round(testY[0, testY.shape[1] – 1]), round(testPredict[testPredict.shape[0] – 1, 0]))<br>
print()</p>
<p># calculate root mean squared error<br>
trainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))<br>
print(‘Train Score: %.2f RMSE’ % (trainScore))<br>
testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))<br>
print(‘Test Score: %.2f RMSE’ % (testScore))</p>
<p># shift train predictions for plotting THIS IS ALSO WRONG<br>
#trainPredictPlot = numpy.empty_like(dataset)<br>
#trainPredictPlot[:, :] = numpy.nan<br>
#trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict</p>
<p>trainPredictPlot = trainPredict<br>
testPredictPlot = testPredict</p>
<p># plot last 25 predictions<br>
plt.figure(figsize=(10,4))<br>
plt.title(‘Last 25 Predictions’)<br>
datasetPlot = dataset[len(dataset) – 25:len(dataset),:]<br>
plt.plot(scaler.inverse_transform(datasetPlot), color=’b’, label=’Actual’)<br>
testPredictPlot = testPredictPlot[len(testPredictPlot) – 25:len(testPredictPlot),:]<br>
plt.plot(testPredictPlot, color=’r’, label=’Prediction’)<br>
plt.grid(True)<br>
plt.legend()<br>
plt.show()</p>
<p># shift test predictions for plotting THIS IS ALSO WRONG<br>
testPredictPlot = numpy.empty_like(dataset)<br>
testPredictPlot[:, :] = numpy.nan<br>
testPredictPlot[len(trainPredict) + (look_back):len(dataset) – 1, :] = testPredict</p>
<p># plot baseline and predictions<br>
plt.figure(figsize=(10,4))<br>
plt.title(‘All Data’)<br>
plt.plot(scaler.inverse_transform(dataset), color=’b’, label=’Actual’)<br>
plt.plot(trainPredictPlot, color=’g’, label=’Training’)<br>
plt.plot(testPredictPlot, color=’r’, label=’Prediction’)<br>
plt.grid(True)<br>
plt.legend()<br>
plt.show()</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389698#respond" onclick="return addComment.moveForm( &quot;comment-389698&quot;, &quot;389698&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to KJ">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-389843" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-389843" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d3e7082aadb8dccd03594f295dddd6be" srcset="http://1.gravatar.com/avatar/d3e7082aadb8dccd03594f295dddd6be?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.superpumpup.com/" rel="external nofollow" class="url">Justin</a></span>
	                <span class="date">February 24, 2017 at 12:26 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389843" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,<br>
I have looked through most of the comments, and not seen this pointed out, but in the “Memory Between Batches” examples, you should not do the <code>reset_state()</code> in between doing <code>predict</code> on the <code>training</code> and <code>test</code> sets.  The beginning of your test set should know that it is at the “end” of the training set, rather than at null.  </p>
<p>Thank you very much for all this, by the way, it’s been super helpful.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389843#respond" onclick="return addComment.moveForm( &quot;comment-389843&quot;, &quot;389843&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Justin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389920" class="comment even depth-2">

	      	<div id="li-comment-389920" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/7cd61db55208d4d73bce17c84245fcea" srcset="http://1.gravatar.com/avatar/7cd61db55208d4d73bce17c84245fcea?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">m0rtal</span>
	                <span class="date">February 24, 2017 at 9:37 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389920" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Are you sure?</p>
<p>Quote:<br>
It requires that the training data not be shuffled when fitting the network. It also requires explicit resetting of the network state after each exposure to the training data (epoch) by calls to model.reset_states(). This means that we must create our own outer loop of epochs and within each epoch call model.fit() and model.reset_states().</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389920#respond" onclick="return addComment.moveForm( &quot;comment-389920&quot;, &quot;389920&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to m0rtal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-389918" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-389918" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/7cd61db55208d4d73bce17c84245fcea" srcset="http://1.gravatar.com/avatar/7cd61db55208d4d73bce17c84245fcea?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">m0rtal</span>
	                <span class="date">February 24, 2017 at 9:34 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389918" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If this is a prediction, should’n plot be continued like this?<br>
<a href="http://i90.fastpic.ru/big/2017/0224/31/9aa244bfcaebaa4cc8255d858e12d731.png" rel="nofollow">http://i90.fastpic.ru/big/2017/0224/31/9aa244bfcaebaa4cc8255d858e12d731.png</a></p>
<p>Please correct me if I’m wrong, we are predicting for look_back periods? Or just t+1?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389918#respond" onclick="return addComment.moveForm( &quot;comment-389918&quot;, &quot;389918&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to m0rtal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390090" class="comment even depth-2">

	      	<div id="li-comment-390090" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/69ce35b0ed7805bdd0a5c35a3d078f02" srcset="http://0.gravatar.com/avatar/69ce35b0ed7805bdd0a5c35a3d078f02?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">KJ</span>
	                <span class="date">February 26, 2017 at 1:20 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-390090" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is prediction, but the code as written doesn’t predict anything into the future.  My updated code <a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389969" rel="nofollow">http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389969</a> predicts one value into the future based on the existing data.</p>
<p>You would have to add to either code if you want to predict more than one value into the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=390090#respond" onclick="return addComment.moveForm( &quot;comment-390090&quot;, &quot;390090&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to KJ">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-389969" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-389969" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/69ce35b0ed7805bdd0a5c35a3d078f02" srcset="http://0.gravatar.com/avatar/69ce35b0ed7805bdd0a5c35a3d078f02?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">KJ</span>
	                <span class="date">February 25, 2017 at 5:26 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-389969" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’d appreciate it if you would delete the code from my post on February 23, 2017 at 3:29 pm.  I’ve made a couple of improvements to it, so it will make your comments section a lot shorter if people don’t have to read through all that old code.</p>
<p>The improvements are:</p>
<p>look_back = look_back + 1, ie. if the look_back is set to 1, each X will contain t-1 &amp; t, rather than just the current value (t).  If you just want one value, set look_back = 0.</p>
<p>The look_back is added to x before it is split into trainX and trainY.  This allows predictions to be made on testX[0], instead of testX[look_back].  One might argue that this is letting the model use data in the training set to make predictions, but since that is only time series data, I don’t see that as a problem.</p>
<p>The final value in the dataset is added to testX, so the model makes a prediction for 1961-01.</p>
<p>There are a lot of commented out print statements to allow people to see exactly what the data looks like.</p>
<p>Here is the updated code:</p>
<p># Stacked LSTM for international airline passengers problem with memory<br>
import numpy<br>
import matplotlib.pyplot as plt<br>
import pandas<br>
import math<br>
from keras.models import Sequential<br>
from keras.layers import Dense<br>
from keras.layers import LSTM<br>
from sklearn.preprocessing import MinMaxScaler<br>
from sklearn.metrics import mean_squared_error</p>
<p># convert an array of values into a dataset matrix<br>
def create_dataset(dataset, look_back):<br>
    dataX, dataY = [], []<br>
    for i in range(len(dataset)- look_back):<br>
        dataX.append(dataset[i:(i + look_back), 0])<br>
        dataY.append(dataset[i + look_back, 0])<br>
    return numpy.array(dataX), numpy.array(dataY)</p>
<p># fix random seed for reproducibility<br>
numpy.random.seed(7)</p>
<p># load the dataset<br>
# <a href="https://datamarket.com/data/set/22u3/international-airline-passengers-monthly-totals-in-thousands-jan-49-dec-60#!ds=22u3&amp;display=line" rel="nofollow">https://datamarket.com/data/set/22u3/international-airline-passengers-monthly-totals-in-thousands-jan-49-dec-60#!ds=22u3&amp;display=line</a><br>
 # if using a different dataset, skipfooter=2 may need to have a different value<br>
 # and if the csv file does not have a header, add header=None<br>
dataframe = pandas.read_csv(‘international-airline-passengers.csv’, usecols=[1], engine=’python’, skipfooter=2)<br>
dataset = dataframe.values<br>
dataset = dataset.astype(‘float32′)</p>
<p>”’<br>
# this can be deleted<br>
# print first and last values from dataset to verify data<br>
print()<br>
print(‘First 15 values from dataset:’)<br>
for i in range(15):<br>
    print(dataset[i])<br>
print()<br>
print(‘Last 15 values from dataset:’)<br>
for i in range(dataset.shape[0] – 15, dataset.shape[0]):<br>
    print(dataset[i])<br>
”’</p>
<p># normalize the dataset<br>
scaler = MinMaxScaler(feature_range=(0, 1))<br>
dataset = scaler.fit_transform(dataset)</p>
<p># reshape into X=t and Y=t+1<br>
look_back = 10<br>
look_back += 1<br>
trainX, trainY = create_dataset(dataset, look_back)</p>
<p># split into train and test sets<br>
train_size = int(len(dataset) * 0.67)<br>
test_size = len(dataset) – train_size<br>
trainX, testX = trainX[0:train_size,:], trainX[train_size:len(trainX),:]<br>
trainY, testY = trainY[0:train_size], trainY[train_size:len(trainY)]</p>
<p>”’<br>
# this can be deleted<br>
# print trainX and trainY to verify data<br>
print()<br>
print(‘trainX + trainY’)<br>
for i in range(trainX.shape[0]):<br>
    print(i + look_back, end=’ ‘)<br>
    for c in range(look_back):<br>
        print(trainX[i,c], end=’ ‘)<br>
    print(trainY[i],” “)</p>
<p>print()<br>
print(‘testX + testY’)<br>
for i in range(testX.shape[0]):<br>
    print(i+ look_back + trainX.shape[0], end=’ ‘)<br>
    for c in range(look_back):<br>
        print(testX[i,c], end=’ ‘)<br>
    print(testY[i],” “)<br>
”’   </p>
<p># reshape input to be [samples, time steps, features]<br>
trainX = numpy.reshape(trainX, (trainX.shape[0], trainX.shape[1], 1))<br>
testX = numpy.reshape(testX, (testX.shape[0], testX.shape[1], 1))</p>
<p># create and fit the LSTM network<br>
batch_size = 1<br>
model = Sequential()<br>
model.add(LSTM(4, batch_input_shape=(batch_size, look_back, 1), stateful=True, return_sequences=True))<br>
model.add(LSTM(4, stateful=True)) # There is no need for an batch_input_shape in the second layer<br>
model.add(Dense(1))<br>
model.compile(loss=’mean_squared_error’, optimizer=’adam’)</p>
<p>for i in range(100):<br>
	model.fit(trainX, trainY, nb_epoch=1, batch_size=batch_size, verbose=0, shuffle=False) # I JUST SET VERBOSE=0 SO IT IS EASIER TO SEE THE PRINTED DATA<br>
	model.reset_states()</p>
<p># make predictions<br>
trainPredict = model.predict(trainX, batch_size=batch_size)<br>
model.reset_states()</p>
<p># add last entry from dataset to be able to predict unknown testY<br>
a = dataset[len(dataset) – look_back:len(dataset), 0]<br>
a = numpy.reshape(a, (1, a.shape[0]))<br>
a = numpy.reshape(a, (a.shape[0], a.shape[1], 1))<br>
testX = numpy.append(testX, a, 0)</p>
<p>testPredict = model.predict(testX, batch_size=batch_size)</p>
<p># invert predictions<br>
trainPredict = scaler.inverse_transform(trainPredict)<br>
trainY = scaler.inverse_transform([trainY])<br>
testPredict = scaler.inverse_transform(testPredict)<br>
testY = scaler.inverse_transform([testY])</p>
<p># print next predicted value<br>
print()<br>
print(‘Prediction for 1961-01:’, round(testPredict[len(testPredict) – 1, 0]))</p>
<p>”’<br>
# this can be deleted<br>
# print testX, testY and testPredict to confirm code is working<br>
train = scaler.inverse_transform(trainX[:,0,0])<br>
train = numpy.reshape(train, (len(train), 1))<br>
test = scaler.inverse_transform(testX[:,0,0])<br>
test = numpy.reshape(test, (len(test), 1))<br>
for c in range(1, look_back):<br>
    train1 = scaler.inverse_transform(trainX[:,c,0])<br>
    train1 = numpy.reshape(train1, (len(train1), 1))<br>
    train = numpy.append(train, train1, axis = 1)<br>
    test1 = scaler.inverse_transform(testX[:,c,0])<br>
    test1 = numpy.reshape(test1, (len(test1), 1))<br>
    test = numpy.append(test, test1, axis = 1)<br>
trainX = train<br>
testX = test<br>
# print number of rows in data<br>
print()<br>
print(‘Number of values in:’)<br>
print(‘trainX’,’trainY’, ‘trainPredict’)<br>
print(trainX.shape[0], ‘  ‘, trainY.shape[1], ‘  ‘, trainPredict.shape[0])<br>
print(‘testX’,’testY’, ‘testPredict’)<br>
print(testX.shape[0], ‘  ‘, testY.shape[1], ‘  ‘, testPredict.shape[0])<br>
# print trainX, trainY and trainPredict to verify data<br>
print()<br>
print(‘trainX’ , ‘          trainY’,  ‘trainPredict’)<br>
for i in range(trainX.shape[0]):<br>
    print(i + look_back, end=’ ‘)<br>
    for c in range(look_back):<br>
        print(trainX[i, c], end=’ ‘)<br>
    print(round(trainY[0,i]), end=’ ‘)<br>
    print(round(trainPredict[i,0]), ‘ ‘)<br>
# print testX, testY and testPredict to verify data<br>
print()<br>
print(‘testX’ , ‘          testY’,  ‘testPredict’)<br>
for i in range(testX.shape[0]):<br>
    print(i + look_back + trainX.shape[0], end=’ ‘)<br>
    for c in range(look_back):<br>
        print(testX[i, c], end=’ ‘)<br>
    if(i &lt; testX.shape[0] – 1):<br>
        print(round(testY[0,i]), end=' ')<br>
    else:<br>
        print('     ', end=' ')<br>
    print(round(testPredict[i,0]), " ")<br>
'''</p>
<p># calculate root mean squared error<br>
trainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))<br>
print()<br>
print('Train Score: %.2f RMSE' % (trainScore))<br>
print()</p>
<p># THIS HAS BEEN REMOVED, BECAUSE WHEN THE LAST ENTRY IS ADDED TO testX,<br>
# testPredict HAS MORE VALUES THAN testY, WHICH WILL THROW AN EXCEPTION<br>
#testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))<br>
#print('Test Score: %.2f RMSE' % (testScore))</p>
<p># shift train predictions for plotting<br>
trainPredictPlot = numpy.empty_like(dataset) # create array with same shape as dataset<br>
trainPredictPlot[:, :] = numpy.nan # fill with nan<br>
trainPredictPlot[look_back:len(trainPredict) + look_back, :] = trainPredict</p>
<p># shift test predictions for plotting<br>
testPredictPlot = numpy.empty_like(dataset) # create array with same shape as dataset<br>
testPredictPlot[:, :] = numpy.nan # fill with nan<br>
test = ['nan']<br>
test = numpy.reshape(test, (len(test), 1))<br>
testPredictPlot = numpy.append(testPredictPlot, test, 0)<br>
testPredictPlot[len(trainPredict) + look_back:len(dataset) + 1, :] = testPredict</p>
<p># plot baseline and predictions<br>
plt.figure(figsize=(10,4))<br>
plt.title('All Data')<br>
plt.plot(scaler.inverse_transform(dataset), color='b', label='Actual')<br>
plt.plot(trainPredictPlot, color='g', label='Training')<br>
plt.plot(testPredictPlot, color='r', label='Prediction')<br>
plt.grid(True)<br>
plt.grid(b=True, which='minor', axis='both')<br>
plt.minorticks_on()<br>
plt.legend()<br>
plt.show()</p>
<p># zoom in on the test predictions<br>
plt.figure(figsize=(10,4))<br>
plt.title('Test Predictions')<br>
'''<br>
# the next two lines plot the data set to confirm that testY is the same as the dataset<br>
# this can be deleted<br>
datasetPlot = dataset[len(dataset) – len(testPredict) + 1:len(dataset),:] # subtract 24, because dataset has one less value than testPredict<br>
plt.plot(scaler.inverse_transform(datasetPlot), color='y', label='dataset')<br>
'''<br>
testYPlot = numpy.reshape(testY, [testY.shape[1], 1]) # testY is [0, 47] need to change shape to [47, 0] to plot it<br>
testYPlot = testYPlot[testYPlot.shape[0] – len(testPredict) + 1:testYPlot.shape[0]] # subtract 24, because testY has one less value than testPredict<br>
plt.plot(testYPlot, color='b', label='testY')<br>
testPredictPlot = testPredict[len(testPredict) – len(testPredict):len(testPredict), :]<br>
plt.plot(testPredictPlot, color='r', label='Prediction')<br>
plt.grid(True)<br>
plt.grid(b=True, which='minor', axis='both')<br>
plt.minorticks_on()<br>
plt.legend()<br>
plt.show()</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=389969#respond" onclick="return addComment.moveForm( &quot;comment-389969&quot;, &quot;389969&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to KJ">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397538" class="comment even depth-2">

	      	<div id="li-comment-397538" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 25, 2017 at 9:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is nearly impossible to reproduce the original formatting of this code.<br>
Could you provide it formatted or on Github?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397538#respond" onclick="return addComment.moveForm( &quot;comment-397538&quot;, &quot;397538&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-390208" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-390208" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3911d0b9a21385fb2fff1adb68e2a8a5" srcset="http://0.gravatar.com/avatar/3911d0b9a21385fb2fff1adb68e2a8a5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Robert</span>
	                <span class="date">February 26, 2017 at 3:15 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-390208" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the awesome tutorial, Jason, and for being so helpful in the comments!</p>
<p>I’d like to predict into the future using time series data that has multiple observations from each date (and goes beyond a single year), and that also has multiple other features besides just the date and the label. I would also like to predict more than 1 step into the future, and to predict multiple dependent variables simultaneously if possible. I saw how to use additional features from other comments.  I also think I saw how to predict more than 1 step into the future.</p>
<p>Could you explain how I can use data with multiple observations from the same date? I’m really stuck on understanding that. If you have the time, could you also explain how to simultaneously predict multiple dependent variables? </p>
<p>One other thing…how do I normalize the data when I have multiple variables, not all of which are numbers?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=390208#respond" onclick="return addComment.moveForm( &quot;comment-390208&quot;, &quot;390208&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Robert">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390312" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-390312" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 27, 2017 at 5:49 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-390312" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Robert,</p>
<p>Great question. I’m working on more examples like this at the moment.</p>
<p>Generally, multiple input features is multiple multivariate time series forecasting. You can structure you data so that each column is a new feature in the LSTM format of [samples, timesteps, features].</p>
<p>A time-horizon of more than one timestep is called multi-step time series forecasting. Again, you can structure your data so that the output has multiple columns and then specify the output layer of your network with that many neurons.</p>
<p>This post might help with restructuring your data:<br>
<a href="http://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow">http://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>
<p>This post might help with scaling your data:<br>
<a href="http://machinelearningmastery.com/normalize-standardize-time-series-data-python/" rel="nofollow">http://machinelearningmastery.com/normalize-standardize-time-series-data-python/</a></p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=390312#respond" onclick="return addComment.moveForm( &quot;comment-390312&quot;, &quot;390312&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-390596" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-390596" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1b017e81052156dc8759e076b9dcf8b3" srcset="http://1.gravatar.com/avatar/1b017e81052156dc8759e076b9dcf8b3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Donald</span>
	                <span class="date">February 28, 2017 at 6:45 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-390596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>If my input file have multiple columns “open, high, low, close, volume”, how can I adapt the script to use all columns for training and then make prediction for “close” column?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=390596#respond" onclick="return addComment.moveForm( &quot;comment-390596&quot;, &quot;390596&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Donald">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390706" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-390706" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 1, 2017 at 8:34 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-390706" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry Donald, I do not have a good tutorial for multivariate time series for you to work from. Not yet anyway.</p>
<p>Generally, the principles are the same as the univariate case. See this post on how to structure your data:<br>
<a href="http://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow">http://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=390706#respond" onclick="return addComment.moveForm( &quot;comment-390706&quot;, &quot;390706&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-391475" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-391475" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/fdb65a8627cb74436f847a9e6a1edf36" srcset="http://0.gravatar.com/avatar/fdb65a8627cb74436f847a9e6a1edf36?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nilavra Pathak</span>
	                <span class="date">March 6, 2017 at 11:47 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-391475" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>Nice tutorial. I recently used an LSTM forecasting. </p>
<p>I have a couple of questions. </p>
<p>1. When we are providing the training set is the LSTM which is being trained equal to the length of the training data size. For example if the training data is a sequence of 10000 values then is the LSTM equal to a 10000 length unrolled recurrent net like in this blog <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="nofollow">http://colah.github.io/posts/2015-08-Understanding-LSTMs/</a></p>
<p>If so then shouldn’t we part up the data of sequences of smaller length like your tutorial in <a href="http://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/</a> </p>
<p>2. I see that you are normalizing the entire dataset, and the data seems to be a monotonically increasing one. So any future data may not be scaled within that range .<br>
How will you deal with such a case, where future data value is not within the range of observed data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=391475#respond" onclick="return addComment.moveForm( &quot;comment-391475&quot;, &quot;391475&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Nilavra Pathak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-391609" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-391609" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 7, 2017 at 9:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-391609" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Nilavra,</p>
<p>I’d recommend trying many different representations for a given perdiction problem. Try breaking it into sub-sequences, try using lag obs as features and time steps, see what works best for your problem.</p>
<p>It is a good idea to difference a dataset with a trend (changing level). Also, it is a good idea to power transform a dataset with an increasing variance (e.g. ideally boxcox or log). The dataset in this example could use both transforms.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=391609#respond" onclick="return addComment.moveForm( &quot;comment-391609&quot;, &quot;391609&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-391598" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-391598" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/52ebf7d6ff2c031a05c442928739edcb" srcset="http://2.gravatar.com/avatar/52ebf7d6ff2c031a05c442928739edcb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Viral Mehta</span>
	                <span class="date">March 7, 2017 at 7:41 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-391598" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why do we see a discontinuity between train prediction (green) and test prediction (red)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=391598#respond" onclick="return addComment.moveForm( &quot;comment-391598&quot;, &quot;391598&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Viral Mehta">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-391859" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-391859" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/3a380f7ad6d42f4c9fca28d2228f68c5" srcset="http://0.gravatar.com/avatar/3a380f7ad6d42f4c9fca28d2228f68c5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">anthony</span>
	                <span class="date">March 8, 2017 at 10:16 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-391859" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is your lstm code performing forecasts for multiple time steps?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=391859#respond" onclick="return addComment.moveForm( &quot;comment-391859&quot;, &quot;391859&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to anthony">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-392363" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-392363" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/bd1cb326dc88e2eed6446ea74ee906ac" srcset="http://2.gravatar.com/avatar/bd1cb326dc88e2eed6446ea74ee906ac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://arslan.tech/" rel="external nofollow" class="url">Arslan</a></span>
	                <span class="date">March 12, 2017 at 5:41 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-392363" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a multivariate time series in which I have fields such as business days, holidays, product launch data etc. in addition to the Y (variable to forecast). How can I implement this model using a LSTM?</p>
<p>I tried to modify the data such that my Nxm training set (trainX) contains m lags for N rows (using ‘create_dataset’ method from the code), and then concatenated the additional information ( business days, holidays, product launch data etc.) as columns. However, I realize that , it does not make sense. I will somehow have to pass a data vector in place of every Y value and its m lags ( containing the additional information: holidays, product launch data and other info). If this makes sense to you, please advise how to go about with this. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=392363#respond" onclick="return addComment.moveForm( &quot;comment-392363&quot;, &quot;392363&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Arslan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-392424" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-392424" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 13, 2017 at 7:39 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-392424" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Arslan, see this post on how to structure your data as supervised learning for multivariate time series:<br>
<a href="http://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow">http://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=392424#respond" onclick="return addComment.moveForm( &quot;comment-392424&quot;, &quot;392424&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-392690" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-392690" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/818deaab3fbdb485abdb8b9dc883e44b" srcset="http://2.gravatar.com/avatar/818deaab3fbdb485abdb8b9dc883e44b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">lotusirous</span>
	                <span class="date">March 15, 2017 at 3:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-392690" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your great article.</p>
<p>However, in your example. Why don’t you consider preprocessing methods such as: log and difference dataset? Most of research papers showed that preprocessing data can improve prediction performance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=392690#respond" onclick="return addComment.moveForm( &quot;comment-392690&quot;, &quot;392690&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to lotusirous">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-392727" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-392727" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2017 at 8:13 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-392727" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I agree, the example would be better if the data was made stationary first (log transform and differenced). I hope to cover this with fuller examples in upcoming blog posts.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=392727#respond" onclick="return addComment.moveForm( &quot;comment-392727&quot;, &quot;392727&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-392820" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-392820" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d55095b90ece809f99251a2893c2ae4f" srcset="http://1.gravatar.com/avatar/d55095b90ece809f99251a2893c2ae4f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hobart</span>
	                <span class="date">March 16, 2017 at 1:18 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-392820" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for great article!!!! I now probably can practice LSTM in code! <img draggable="false" class="emoji" alt="🙂" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f642.svg"></p>
<p>I got one question when I try to define my LSTM network. Say if I have some different datas, dataX, dataY, dataZ and try to predict/mimic dataA. Shall I use different batches or different features? (I know feature is designed for this, but it seems batch can also do the samething, am I right?)</p>
<p>dataX, dataY, dataZ, dataA all hold scalar value. </p>
<p>Another question is practical (basically python related). Say I have dataX and try to predcit dataA. dataX = [1,2,3,…n], is there any efficient way to build training dataset like [3,2,  ]. </p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=392820#respond" onclick="return addComment.moveForm( &quot;comment-392820&quot;, &quot;392820&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hobart">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-392856" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-392856" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2017 at 8:01 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-392856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are many ways to represent time series data with LSTMs.</p>
<p>I’d recommend using a stateful LSTM with 1 lag variable as input and let it learn the sequence. Then try all other structures (timesteps/features) you can think of to see if you can out-perform your baseline.</p>
<p>Yes, consider using the Pandas shift() function. I offer examples in my recent time series blog posts.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=392856#respond" onclick="return addComment.moveForm( &quot;comment-392856&quot;, &quot;392856&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-393073" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-393073" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/57a8209a2a2cae41cb1041086aec60c6" srcset="http://2.gravatar.com/avatar/57a8209a2a2cae41cb1041086aec60c6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stefan</span>
	                <span class="date">March 18, 2017 at 1:31 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-393073" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Awesome post and simple (as it should be)!</p>
<p>What I’d like to know from this is if one could try to predict *one* signal given *n* other signals?</p>
<p>That would mean that the network learns about non-linear correlations between multiple signals and outputs a desired target signal. Can this be done using LSTM networks?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=393073#respond" onclick="return addComment.moveForm( &quot;comment-393073&quot;, &quot;393073&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Stefan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393122" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-393122" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 18, 2017 at 7:48 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-393122" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not, as long is the signals are correlated.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=393122#respond" onclick="return addComment.moveForm( &quot;comment-393122&quot;, &quot;393122&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-393225" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-393225" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/a309c869da076b74a18bb4b3e40fe5ad" srcset="http://1.gravatar.com/avatar/a309c869da076b74a18bb4b3e40fe5ad?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">klaas</span>
	                <span class="date">March 19, 2017 at 12:51 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-393225" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a similar dataset. However when trying to reshape the X array into the LSTM required format i receive an error : “lstm tuple index out of range”. Searched on Google but can’t find the solution that works. Any suggestions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=393225#respond" onclick="return addComment.moveForm( &quot;comment-393225&quot;, &quot;393225&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to klaas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393256" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-393256" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 19, 2017 at 6:12 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-393256" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Check your data carefully ensure the shape you are requesting makes sense.</p>
<p>Remember, LSTMs require data in [samples, timesteps, features] format.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=393256#respond" onclick="return addComment.moveForm( &quot;comment-393256&quot;, &quot;393256&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-393329" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-393329" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/43fbde48763450a6fb17ae0c25443199" srcset="http://1.gravatar.com/avatar/43fbde48763450a6fb17ae0c25443199?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Apurv Verma</span>
	                <span class="date">March 19, 2017 at 9:46 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-393329" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I feel like there is a delay effect happening. The shifted predicted values are closer to the value at current timestamp. Do you think there is an explanation of why that particular effect is being observed?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=393329#respond" onclick="return addComment.moveForm( &quot;comment-393329&quot;, &quot;393329&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Apurv Verma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-393471" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-393471" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/6868885d43b2805f5b5750b58e3ea35f" srcset="http://0.gravatar.com/avatar/6868885d43b2805f5b5750b58e3ea35f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">linamede</span>
	                <span class="date">March 21, 2017 at 2:04 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-393471" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Would it be possible to learn to predict more than one steps ahead at once? For example, instead for giving past 3  data, learn to predict the future 3 data. (instead of only one future datum, as in your example)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=393471#respond" onclick="return addComment.moveForm( &quot;comment-393471&quot;, &quot;393471&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to linamede">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393521" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-393521" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 21, 2017 at 8:42 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-393521" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you will need to reframe your problem and specify 3 neurons in the output layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=393521#respond" onclick="return addComment.moveForm( &quot;comment-393521&quot;, &quot;393521&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-393884" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-393884" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/467d433d06b0d32d1c335b37a409099a" srcset="http://1.gravatar.com/avatar/467d433d06b0d32d1c335b37a409099a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sandi</span>
	                <span class="date">March 23, 2017 at 3:45 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-393884" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice blog Jason!</p>
<p>In this tutorial you always give 4 output dimensions<br>
model.add(LSTM(4, input_dim=look_back))</p>
<p>When I set the output dimension = 1, like:</p>
<p>model.add(LSTM(1, input_dim=look_back))</p>
<p>it returned error maessage:<br>
TypeError: Cannot convert Type TensorType(float32, 3D) (of Variable Subtensor{:int64:}.0) into Type TensorType(float32, (False, False, True)). You can try to manually convert Subtensor{:int64:}.0 into a TensorType(float32, (False, False, True)).</p>
<p>Any suggestions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=393884#respond" onclick="return addComment.moveForm( &quot;comment-393884&quot;, &quot;393884&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Sandi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393966" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-393966" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 24, 2017 at 7:52 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-393966" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not seen this fault.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=393966#respond" onclick="return addComment.moveForm( &quot;comment-393966&quot;, &quot;393966&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394012" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-394012" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/c8bb39f4ad2d406604a8fd18e21d0c97" srcset="http://0.gravatar.com/avatar/c8bb39f4ad2d406604a8fd18e21d0c97?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pablo Estrada</span>
	                <span class="date">March 24, 2017 at 12:07 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394012" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello! Thanks a lot for your post! I have a small question? How do I modify the network in order to predict more than one day? For example, getting the next week of the passengers What are the specific parameters I should modify to make the prediction longer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394012#respond" onclick="return addComment.moveForm( &quot;comment-394012&quot;, &quot;394012&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Pablo Estrada">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394094" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-394094" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 25, 2017 at 7:32 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394094" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can reframe the problem to predict multiple days.</p>
<p>You can also call the model again and again and use predictions as input observations.</p>
<p>This post will give you some ideas:<br>
<a href="http://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394094#respond" onclick="return addComment.moveForm( &quot;comment-394094&quot;, &quot;394094&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394083" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-394083" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/89652bfa48444c2907d0547a9153be91" srcset="http://2.gravatar.com/avatar/89652bfa48444c2907d0547a9153be91?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mete YALCİNER</span>
	                <span class="date">March 25, 2017 at 4:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394083" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you jason good article</p>
<p>But code alittle bit incorrect , if we use the network in time series problems tests array must start end of train array in first example test array starts end of train array+1 in anothers exaples test array stars end of train array+3 …. etc if our inputs  is small like 1 and 3 no problem but if our inputs big  like 170 ,200 it is big problem…… Think please we predict stocks prices our tests stars 150 days later and will give incorrect results, coz market is changable…………</p>
<p>than<br>
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]</p>
<p>must change like this </p>
<p>train, test = dataset[0:train_size,:], dataset[train_size-look_back-1:len(dataset),:]</p>
<p>and<br>
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict</p>
<p>must change like this</p>
<p>testPredictPlot[len(trainPredict)+look_back:len(dataset)-1, :] = testPredict</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394083#respond" onclick="return addComment.moveForm( &quot;comment-394083&quot;, &quot;394083&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Mete YALCİNER">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-394084" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-394084" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/89652bfa48444c2907d0547a9153be91" srcset="http://2.gravatar.com/avatar/89652bfa48444c2907d0547a9153be91?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mete YALCİNER</span>
	                <span class="date">March 25, 2017 at 5:02 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394084" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>so sorry i must add so that <img draggable="false" class="emoji" alt="🙂" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f642.svg"> i have a predict problem i tryed last tree mounts with ANN but i did not find answer and my best MSE was e-3  , when i see your article i decided try DeepLearning  with keras now i cannot belive my eyes , my MSE has e-12 , Than Jason Tank you very much……</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394084#respond" onclick="return addComment.moveForm( &quot;comment-394084&quot;, &quot;394084&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Mete YALCİNER">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-394086" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-394086" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/0de1d868ba90cdf0eb7d081565abbdf8" srcset="http://0.gravatar.com/avatar/0de1d868ba90cdf0eb7d081565abbdf8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shailen</span>
	                <span class="date">March 25, 2017 at 6:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394086" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Can this technique work for dynamical problems as well, where the time-varying response is a function of time-varying inputs? Ultimately the model should be able to provide/predict time-varying response for any arbitrary time-varying inputs. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394086#respond" onclick="return addComment.moveForm( &quot;comment-394086&quot;, &quot;394086&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Shailen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-394234" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-394234" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d78a1b61ad3016747e2a52a21c1e9ed5" srcset="http://1.gravatar.com/avatar/d78a1b61ad3016747e2a52a21c1e9ed5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Freddie</span>
	                <span class="date">March 26, 2017 at 5:20 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394234" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi!</p>
<p>I’m trying to create a curve predictive model to generate new curves (for example, sinusoidal curves), but the problem is that when I train my model with curves with different periods, the model can only generate curves with the same period (like an average of the periods of the training set) which could be the problem?</p>
<p>thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394234#respond" onclick="return addComment.moveForm( &quot;comment-394234&quot;, &quot;394234&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Freddie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394288" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-394288" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 27, 2017 at 7:53 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394288" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is hard to know.</p>
<p>Perhaps the problem requires a more sophisticated model or a simpler representation, or perhaps the problem is too difficult.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394288#respond" onclick="return addComment.moveForm( &quot;comment-394288&quot;, &quot;394288&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394283" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-394283" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/86541a57000e86b5153ba12968f1ac9c" srcset="http://2.gravatar.com/avatar/86541a57000e86b5153ba12968f1ac9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">George</span>
	                <span class="date">March 27, 2017 at 7:30 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394283" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason and thanks for your very nice tutorials.</p>
<p>I have this kind of problem and I wanted to ask you in which category it fits.</p>
<p>Let’s say I have a device which measures temperatures.The temperatures will have a “specific” range (I mean the source of the temprerature will be a steady source).</p>
<p>Now, I will take some thousands of temperatures vaues in the beginning and then, I want to be able to train my network , and when it sees a temperature which is not a good fit in the preious values, to reject them.</p>
<p>What kind of problem is this?Time series? Kernel density?Unsupervised cluster?</p>
<p>Thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394283#respond" onclick="return addComment.moveForm( &quot;comment-394283&quot;, &quot;394283&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to George">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394297" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-394297" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 27, 2017 at 7:59 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394297" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This sounds like “anomaly detection” or “change detection”, even “outlier detection”.</p>
<p>These terms will help you find good algorithms to try.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394297#respond" onclick="return addComment.moveForm( &quot;comment-394297&quot;, &quot;394297&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394301" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-394301" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/86541a57000e86b5153ba12968f1ac9c" srcset="http://2.gravatar.com/avatar/86541a57000e86b5153ba12968f1ac9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">George</span>
	                <span class="date">March 27, 2017 at 8:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394301" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great!Thanks a lot!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394301#respond" onclick="return addComment.moveForm( &quot;comment-394301&quot;, &quot;394301&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to George">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394400" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-394400" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 28, 2017 at 8:18 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394400" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome George.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394400#respond" onclick="return addComment.moveForm( &quot;comment-394400&quot;, &quot;394400&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394517" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-394517" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2c2fc2d581e40949e709d4c0be2a206f" srcset="http://2.gravatar.com/avatar/2c2fc2d581e40949e709d4c0be2a206f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kunpeng Zhang</span>
	                <span class="date">March 29, 2017 at 2:18 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
thank you very much for your great post.<br>
I have a naive confusion regarding the ‘Test Score’ part.<br>
Why we use<br>
‘testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:, 0]))’ instead of<br>
‘testScore = math.sqrt(mean_squared_error(test[:286], testPredict))’ ?<br>
What’s the difference between the two?<br>
And also I am aware that you use ‘testScore = model.evaluate(testX, testY, verbose=0)’ to trigger the ‘testScore’.<br>
Which one is the best to evaluate our model? Could you give me some advice?<br>
Thank you for your work. I appreciate it a lot.<br>
Best regards.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394517#respond" onclick="return addComment.moveForm( &quot;comment-394517&quot;, &quot;394517&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Kunpeng Zhang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-394689" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-394689" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/e57a4b9e692c37dc1813096aaf180a67" srcset="http://2.gravatar.com/avatar/e57a4b9e692c37dc1813096aaf180a67?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">marm</span>
	                <span class="date">March 30, 2017 at 7:56 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394689" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, That is really  helpful post. I have a question about random walk data, Can we predict random walk data by using LSTM? I have also read your post about prediction of random walk but still believe LSTM is much better than other methods. Can you give me some advice?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394689#respond" onclick="return addComment.moveForm( &quot;comment-394689&quot;, &quot;394689&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to marm">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394710" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-394710" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2017 at 8:59 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394710" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can, but I doubt you will do better than a persistence model. </p>
<p>In fact, if the data is a true random walk, then you will not do better.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394710#respond" onclick="return addComment.moveForm( &quot;comment-394710&quot;, &quot;394710&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394720" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-394720" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/cf7967d77e714e23567c82f35be9ae60" srcset="http://0.gravatar.com/avatar/cf7967d77e714e23567c82f35be9ae60?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fisher</span>
	                <span class="date">March 30, 2017 at 10:29 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394720" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Nice talk!  Very clear and useful, being my first guide to implement LSTM in time series prediction. I’ve followed many of your articles, thx for your sharing!</p>
<p>Only one different opinion, it seems that you do Min-Max firstly on the whole dataset before training and prediction, which I think may be improper. Because “test set” should be treated like “online” data in real world, i.e. we never know what’s coming next into our model when we do prediction. If you scale test set first, then you are actually putting information of test set into training process, this will improve model performance on test set, but obviously, it’s improper. So I think the correct pipeline should be:</p>
<p>Step 1. Split dataset into train set and test set<br>
Step 2. Train Scaler on train set and convert train set.   i.e. trainSet_convert = scaler.fit_transform(train set)<br>
Step 3. Train LSTM on trainSet_convert .<br>
Step 4. Use scaler to transforms test set,   i.e.  testSet_transformed = scaler.transform(test set)<br>
Step 5. Use LSTM to do prediction and evaluation on testSet_transformed</p>
<p>Here Step 1.~3. are training stage, Step 4.~5. are prediction stage. The main difference compared with your pipeline is that, scaler transforms test set on prediction stage, not training stage.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394720#respond" onclick="return addComment.moveForm( &quot;comment-394720&quot;, &quot;394720&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Fisher">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394829" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-394829" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 31, 2017 at 5:50 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394829" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, ideally you would perform scaling on the training dataset and use the coefficients from training to scale test (e.g. min/max or stdev/mean).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394829#respond" onclick="return addComment.moveForm( &quot;comment-394829&quot;, &quot;394829&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394917" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-394917" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/d676f5c47c4e90c67c035289ae766761" srcset="http://1.gravatar.com/avatar/d676f5c47c4e90c67c035289ae766761?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andrea</span>
	                <span class="date">March 31, 2017 at 8:00 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394917" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks a lot for the useful articles, really good job!</p>
<p>I just have one question: also if I’ve already seen “4 Strategies for Multi-Step Time Series Forecasting” I still can’t get how to predict more future values than my initial dataset.</p>
<p>For example: If my dataset is composed by 100 values, how I can predict the next 10 values and display it in the same way you have done in this example?</p>
<p>Thank you in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394917#respond" onclick="return addComment.moveForm( &quot;comment-394917&quot;, &quot;394917&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Andrea">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394977" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-394977" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 1, 2017 at 5:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-394977" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can configure the LSTM to have 10 units in the output layer.</p>
<p>You can treat it as a many-to-one RNN or a many-to-many and use a seq2seq paradigm. </p>
<p>I have tutorials covering this scheduled for the blog.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=394977#respond" onclick="return addComment.moveForm( &quot;comment-394977&quot;, &quot;394977&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395556" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-395556" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/ab940cb3cfc071915e1f036b645370b5" srcset="http://1.gravatar.com/avatar/ab940cb3cfc071915e1f036b645370b5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mike Williamson</span>
	                <span class="date">April 7, 2017 at 1:43 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395556" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I went through this example, but I feel like there is something I am not understanding:  the predictions are only being provided one day in advance.</p>
<p>E.g., if we look at the generated test data (testPredict from the line</p>
<p>testPredict = model.predict(testX, batch_size=batch_size)</p>
<p>), we see that we are using testX to generate predictions.  Well, testX is merely a feature containing all the time series data, excluding the particular day we’re next trying to predict.</p>
<p>Then, once a prediction is made, that prediction is actually *ignored* when doing to subsequent prediction, and instead we use the actual data from testX.</p>
<p>So, is this model really only predicting one day in advance?  If so, how is it useful?  What am I missing  here?  I know that LSTM RNN’s are very powerful, but this example is not convincing me.</p>
<p>(FWIW, I reproduced this example by correcting it and truly using the predictions to feed the subsequent predictions, and the predictive capablility falls apart.  After a few days, it just “stabilizes” and stops moving altogether.)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395556#respond" onclick="return addComment.moveForm( &quot;comment-395556&quot;, &quot;395556&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Mike Williamson">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395723" class="comment odd alt depth-2">

	      	<div id="li-comment-395723" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/0f3a29d3a19d8b9f10dea2d66b19f9e7" srcset="http://0.gravatar.com/avatar/0f3a29d3a19d8b9f10dea2d66b19f9e7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pawan</span>
	                <span class="date">April 9, 2017 at 4:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395723" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I agree with you! I have raised same question in my comment below. Almost all tutorial on using ML for time series forecasting is doing this type of mistake</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395723#respond" onclick="return addComment.moveForm( &quot;comment-395723&quot;, &quot;395723&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to pawan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-395805" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395805" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:45 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395805" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is called walk forward validation and assumes new data is available each day, at least in this domain.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395805#respond" onclick="return addComment.moveForm( &quot;comment-395805&quot;, &quot;395805&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395626" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-395626" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/07062bee713abad7dba252417d1306d2" srcset="http://0.gravatar.com/avatar/07062bee713abad7dba252417d1306d2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anis</span>
	                <span class="date">April 7, 2017 at 11:43 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395626" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this tuto.<br>
There is one thing that I didn’t understand.<br>
I want to interpret the performance of my algo using the RMSE score.<br>
But I was always working with scores in the range of 0 and 1 which is not the case in the first example(LSTM for regression).<br>
So please , I want some details of the score of RMSE and its significance.</p>
<p>Thank you !!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395626#respond" onclick="return addComment.moveForm( &quot;comment-395626&quot;, &quot;395626&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Anis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395720" class="comment even depth-2">

	      	<div id="li-comment-395720" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/0f3a29d3a19d8b9f10dea2d66b19f9e7" srcset="http://0.gravatar.com/avatar/0f3a29d3a19d8b9f10dea2d66b19f9e7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pawan</span>
	                <span class="date">April 9, 2017 at 4:00 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395720" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>RMSE may or may not be between 0 to 1, depending upon the scale of target variable. RMSE mathematically is sum of sqaure of residuals, which in a way tells how much of variance model is not able to explain. </p>
<p>Since, we know the variance in original data we can use it to divide the RMSE, which gives Normalized RMSE or NRMSE, for a good model this quantity should always be less than 1, the closer it is to 0 the better it is. If it’s value is more than, it means that our model is introducing more variance than actually present in data, which is not the goal of any modeling exercise.</p>
<p>In statistics, 1- NRMSE is R-square, which is used to assess the goodness of a model. if R-square is closer to 1, model almost explains all the variance observed, if it is closer to 0, model does not explain any variance and in this case ‘mean’ of target variable would be much better predictor the than model itself.</p>
<p>Hope this helps!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395720#respond" onclick="return addComment.moveForm( &quot;comment-395720&quot;, &quot;395720&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to pawan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-395819" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-395819" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:55 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395819" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post shows how to implement RMSE from scratch and other performance measures:<br>
<a href="http://machinelearningmastery.com/time-series-forecasting-performance-measures-with-python/" rel="nofollow">http://machinelearningmastery.com/time-series-forecasting-performance-measures-with-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395819#respond" onclick="return addComment.moveForm( &quot;comment-395819&quot;, &quot;395819&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395718" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-395718" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/0f3a29d3a19d8b9f10dea2d66b19f9e7" srcset="http://0.gravatar.com/avatar/0f3a29d3a19d8b9f10dea2d66b19f9e7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pawan</span>
	                <span class="date">April 9, 2017 at 3:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395718" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When forecasting for test data, I think we should not assume that lagged data is available for all testing period. By assuming it to be available, i think we are over-stating the power of LSTM for time series forecasting. </p>
<p>As per me, right method to test would be –<br>
1. When forecasting for time t + 1, we can take t and t – 1 values from train data. Here, t being final time of train data<br>
2. But when forecasting for t + 2, t + 1 and t has to be used, in reality we don’t know t + 1, as we have data till time ‘t’. So, forecast value of t + 1 should be used instead.<br>
3. Step 2 will have to be repeated for time t + 3, t + 4, …..<br>
4. Once we have forecast using steps 2 and 3 for test period, we should compare it with the actual test data to get the error</p>
<p>If above is followed, we will get much higher error than we are currently getting by assuming the availability of lagged values.</p>
<p>It would be good to know your thought on this</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395718#respond" onclick="return addComment.moveForm( &quot;comment-395718&quot;, &quot;395718&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to pawan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395826" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-395826" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:59 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395826" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I agree in the case when we remaking a multi-step forecast.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395826#respond" onclick="return addComment.moveForm( &quot;comment-395826&quot;, &quot;395826&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-395991" class="comment even depth-2">

	      	<div id="li-comment-395991" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/07062bee713abad7dba252417d1306d2" srcset="http://0.gravatar.com/avatar/07062bee713abad7dba252417d1306d2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anis</span>
	                <span class="date">April 10, 2017 at 10:33 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-395991" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for yours responses.<br>
I asked this question because I follow the course Algo LSTM with Keras but using another dataset.<br>
And I get as result RMSE= 0.01 but when  I plot the result  i found that the prediction graph are not really fiiting with our dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=395991#respond" onclick="return addComment.moveForm( &quot;comment-395991&quot;, &quot;395991&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Anis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396203" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-396203" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/4c62e327109719abda35679f55d44eac" srcset="http://1.gravatar.com/avatar/4c62e327109719abda35679f55d44eac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://freelancermap.com/" rel="external nofollow" class="url">Yasmin</a></span>
	                <span class="date">April 12, 2017 at 4:13 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-396203" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey, thanks for such a detailed post. I thought you might like to check out a guest post we recently had on using LTSM RNNs in Keras Tendorflow for trend prediction using just 3 steps – let us know what you think…</p>
<p><a href="https://www.freelancermap.com/freelancer-tips/11865-trend-prediction-with-lstm-rnns-using-keras-tensorflow-in-3-steps" rel="nofollow">https://www.freelancermap.com/freelancer-tips/11865-trend-prediction-with-lstm-rnns-using-keras-tensorflow-in-3-steps</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=396203#respond" onclick="return addComment.moveForm( &quot;comment-396203&quot;, &quot;396203&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Yasmin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396279" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396279" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2017 at 9:55 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-396279" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the link.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=396279#respond" onclick="return addComment.moveForm( &quot;comment-396279&quot;, &quot;396279&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396352" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-396352" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/94958954e92089b994a3fd1bb05c4c27" srcset="http://0.gravatar.com/avatar/94958954e92089b994a3fd1bb05c4c27?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">JD</span>
	                <span class="date">April 13, 2017 at 10:56 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-396352" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great tutorial! Thank you for your effort and time Sir. </p>
<p>I think this is the one of few tutorials that actually talk about how to manage data matrix.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=396352#respond" onclick="return addComment.moveForm( &quot;comment-396352&quot;, &quot;396352&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to JD">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396390" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396390" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2017 at 8:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-396390" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks JD.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=396390#respond" onclick="return addComment.moveForm( &quot;comment-396390&quot;, &quot;396390&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396467" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-396467" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/85ca9e2714f69ee9a4b01678d1025f61" srcset="http://2.gravatar.com/avatar/85ca9e2714f69ee9a4b01678d1025f61?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Srinivas</span>
	                <span class="date">April 15, 2017 at 2:38 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-396467" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot for the great tutorial Jason. This is super helpful. </p>
<p>However, I have one question. For the stateful LSTM when we are running the epochs manually, I understand why you are doing the <code>model.reset_states()</code> after each epoch.</p>
<p>But when we are finally doing the prediction, we run a predict on the train data and then do a reset_states() before doing a predict on the test data. </p>
<p>I think we do not need this as the test data is right after the train data temporally. So, I think we can use the previous state of the internal memory of the LSTM layer. What do you think?</p>
<p>Thanks,<br>
Srinivas</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=396467#respond" onclick="return addComment.moveForm( &quot;comment-396467&quot;, &quot;396467&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Srinivas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396508" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396508" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 15, 2017 at 9:40 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-396508" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We may.</p>
<p>See this post on seeding state in LSTMs:<br>
<a href="http://machinelearningmastery.com/seed-state-lstms-time-series-forecasting-python/" rel="nofollow">http://machinelearningmastery.com/seed-state-lstms-time-series-forecasting-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=396508#respond" onclick="return addComment.moveForm( &quot;comment-396508&quot;, &quot;396508&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396664" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-396664" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/fe5552c5ba4d2c3d69230b79c40bedb6" srcset="http://0.gravatar.com/avatar/fe5552c5ba4d2c3d69230b79c40bedb6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dan</span>
	                <span class="date">April 17, 2017 at 6:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-396664" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I updated to the latest version of keras and tensorflow and get extremly bad results. Any suggestions for that Jason? Did you use the latest version of tensorflow?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=396664#respond" onclick="return addComment.moveForm( &quot;comment-396664&quot;, &quot;396664&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Dan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396770" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396770" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 18, 2017 at 8:26 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-396770" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider increasing the number of training epochs.</p>
<p>Consider running the example multiple times and take the average of results.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=396770#respond" onclick="return addComment.moveForm( &quot;comment-396770&quot;, &quot;396770&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397437" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-397437" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/fcb26192097a40faf441ffb05c0470cc" srcset="http://0.gravatar.com/avatar/fcb26192097a40faf441ffb05c0470cc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Moha</span>
	                <span class="date">April 24, 2017 at 3:05 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397437" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, The way this post wrote very well summarise.Thanks. I’m a beginner to ML student in campus in SL. I would like to understand the code snippet what each line does, where can I get the clear idea on that ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397437#respond" onclick="return addComment.moveForm( &quot;comment-397437&quot;, &quot;397437&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Moha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397521" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397521" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 25, 2017 at 7:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397521" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This might be a good place to start:<br>
<a href="http://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/" rel="nofollow">http://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397521#respond" onclick="return addComment.moveForm( &quot;comment-397521&quot;, &quot;397521&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397438" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-397438" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/b30cd85d8f8195df03b58b16b5ec2713" srcset="http://2.gravatar.com/avatar/b30cd85d8f8195df03b58b16b5ec2713?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://medium.com/@prdeepak.babu/deep-learning-gender-from-name-lstm-recurrent-neural-networks-448d64553044" rel="external nofollow" class="url">Deepak</a></span>
	                <span class="date">April 24, 2017 at 3:13 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397438" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the detailed blog. this helped me apply this to predicting gender using name with minor modification to accomodate many-to-one architecture. the link can be found here<br>
<a href="https://medium.com/@prdeepak.babu/deep-learning-gender-from-name-lstm-recurrent-neural-networks-448d64553044" rel="nofollow">https://medium.com/@prdeepak.babu/deep-learning-gender-from-name-lstm-recurrent-neural-networks-448d64553044</a></p>
<p>Thanks again! keep writing !!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397438#respond" onclick="return addComment.moveForm( &quot;comment-397438&quot;, &quot;397438&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Deepak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397522" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397522" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 25, 2017 at 7:44 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397522" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>
<p>Thanks for sharing the link.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397522#respond" onclick="return addComment.moveForm( &quot;comment-397522&quot;, &quot;397522&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397533" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-397533" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 25, 2017 at 7:57 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397533" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What about the so called mimicking effect described in several comments here Jason?</p>
<p>I’m new to this topic and slightly concerned.</p>
<p>Could you provide an elaborated statement in regard to this ‘critic’ (t+1 etc.)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397533#respond" onclick="return addComment.moveForm( &quot;comment-397533&quot;, &quot;397533&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397625" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-397625" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2017 at 6:18 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397625" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I refer you to this updated tutorial and compare skill to a persistence model:<br>
<a href="http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow">http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397625#respond" onclick="return addComment.moveForm( &quot;comment-397625&quot;, &quot;397625&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397666" class="comment odd alt depth-3">

	      	<div id="li-comment-397666" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 26, 2017 at 4:06 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397666" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397666#respond" onclick="return addComment.moveForm( &quot;comment-397666&quot;, &quot;397666&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397796" class="comment even depth-3 parent">

	      	<div id="li-comment-397796" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 28, 2017 at 12:01 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397796" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have compared the performance, running the code on </p>
<p><a href="http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow">http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/</a></p>
<p>..with the performance of the recommended baseline model, consisting a persistence forecast.</p>
<p>A) Feeded with the shampoo example data  </p>
<p>The results are:</p>
<p>baseline score:  133.16 RMSE</p>
<p>LSTM simple example score: 142.44 RMSE &gt; 133.16 RMSE</p>
<p>LSTM complete example score: 107.214 RMSE &lt; 133.16 RMSE</p>
<p>B) Feeded with airline data the results are:</p>
<p>baseline score:  47.81 RMSE</p>
<p>LSTM simple example score: 44.87 RMSE  47.81 RMSE</p>
<p>What does this mean in regard to the so called mimicking effect?<br>
And the criticism that there is actually no prediction involved.<br>
I’ve got different results and multiple options to interpret them.<br>
I’m a little bit confused now.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397796#respond" onclick="return addComment.moveForm( &quot;comment-397796&quot;, &quot;397796&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397849" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-397849" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 28, 2017 at 7:42 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may suggest the LSTM is more skillful than persistence.</p>
<p>Neural networks will give different results each time they are run. I recommend re-running an experiment many times (30) and taking the average performance.</p>
<p>More on the stochastic nature of neural nets here:<br>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<p>I also recommend tuning the LSTM to the problem, this post may help:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397849#respond" onclick="return addComment.moveForm( &quot;comment-397849&quot;, &quot;397849&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397565" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-397565" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 25, 2017 at 5:12 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397565" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Trying to adapt some versions from the user comments I get the error message:</p>
<p>“TypeError: (‘Keyword argument not understood:’, ‘input_dim’)”</p>
<p>If I try instead “input_shape” it says “int object is not iterateable”</p>
<p>Does somebody has a solution for this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397565#respond" onclick="return addComment.moveForm( &quot;comment-397565&quot;, &quot;397565&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397665" class="comment odd alt depth-2">

	      	<div id="li-comment-397665" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 26, 2017 at 4:05 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397665" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Update: </p>
<p>There seems to be an undocumented change in the Keras-API.<br>
Got very few infos out of the web.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397665#respond" onclick="return addComment.moveForm( &quot;comment-397665&quot;, &quot;397665&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397818" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-397818" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/07062bee713abad7dba252417d1306d2" srcset="http://0.gravatar.com/avatar/07062bee713abad7dba252417d1306d2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">April 28, 2017 at 3:48 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397818" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>This a good tutorial.<br>
The only thing which is not clear is how to predict a value that we don’t know it.In this exemple we can predict only the value in our data set and we are not able to predict futur values !!!!!!!!!!!!</p>
<p>Please I want some clarifications</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397818#respond" onclick="return addComment.moveForm( &quot;comment-397818&quot;, &quot;397818&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397859" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-397859" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 28, 2017 at 7:54 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397859" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can predict a future value by feeding in the last observations as input (X) to the function:</p>
<p>yhat = model.predict(X)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397859#respond" onclick="return addComment.moveForm( &quot;comment-397859&quot;, &quot;397859&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397882" class="comment even depth-2">

	      	<div id="li-comment-397882" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/2ab114b86e9463e9ffc3431264b55beb" srcset="http://2.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 28, 2017 at 12:43 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397882" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I created a ‘Jason-checked’ example here…</p>
<p><a href="http://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397444" rel="nofollow">http://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397444</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397882#respond" onclick="return addComment.moveForm( &quot;comment-397882&quot;, &quot;397882&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Hans">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397904" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-397904" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/8eb40c4635baa6b9ad4f744084ac78fe" srcset="http://2.gravatar.com/avatar/8eb40c4635baa6b9ad4f744084ac78fe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kaoutar</span>
	                <span class="date">April 28, 2017 at 6:49 pm</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397904" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thanks for sharing this great tutorial! Can you please also suggest the way to get the  forecast For example, if we want to forecast the value of the series for the next few years (ahead of current time–As we usually do for the any time series data), i have a data from 2000 to 2016 ,and i want to have the forecast for the 4 next years . Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397904#respond" onclick="return addComment.moveForm( &quot;comment-397904&quot;, &quot;397904&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Kaoutar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397963" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397963" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2017 at 7:22 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-397963" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post:<br>
<a href="http://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=397963#respond" onclick="return addComment.moveForm( &quot;comment-397963&quot;, &quot;397963&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398030" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-398030" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/50231b94272b720e68374bf3b5647bc6" srcset="http://2.gravatar.com/avatar/50231b94272b720e68374bf3b5647bc6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Daniel Luque</span>
	                <span class="date">April 30, 2017 at 4:06 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-398030" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!, first your work is awesome <img draggable="false" class="emoji" alt="🙂" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1f642.svg"> and I want to thank you for sharing your knowledge, I have a question, how the model can predict future valued that are not in the data set?. All the examples I have seen in the internet just mimic the last part of the data set but not predict anything. I want to predict future movements but unless I know it can be done I have not find any way to do it.<br>
Hope you can help me to do this.<br>
Thanks so much!.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=398030#respond" onclick="return addComment.moveForm( &quot;comment-398030&quot;, &quot;398030&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Daniel Luque">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398042" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398042" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 30, 2017 at 5:35 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-398042" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Fit the model on all available data and then call model.predict(X) where X are the last few observations.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=398042#respond" onclick="return addComment.moveForm( &quot;comment-398042&quot;, &quot;398042&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398115" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-398115" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/e436fc2e00c098237d0b2ea0e374a5cf" srcset="http://2.gravatar.com/avatar/e436fc2e00c098237d0b2ea0e374a5cf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">cdsj</span>
	                <span class="date">May 1, 2017 at 2:27 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-398115" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi jason，i follow your tutorial,program can run ,but when i change little ,the result is not my expect.<br>
i add the “metrics=[‘accuracy’]”:<br>
model.compile(loss=’mean_squared_error’, optimizer=’adam’,metrics=[‘accuracy’])<br>
when running,loss is down,but acc not change.why?thank you !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=398115#respond" onclick="return addComment.moveForm( &quot;comment-398115&quot;, &quot;398115&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to cdsj">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398139" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398139" class="comment-container">

					                <div class="avatar"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 1, 2017 at 5:59 am</span>
	                <span class="perma"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#comment-398139" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is the challenge of applied machine learning.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/?replytocom=398139#respond" onclick="return addComment.moveForm( &quot;comment-398139&quot;, &quot;398139&quot;, &quot;respond&quot;, &quot;2929&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#respond" style="display:none;">Click here to cancel reply.</a></small></h3>			<form action="http://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form">
				<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="2929" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="de54e70b77"></p><p style="display: none;"></p>			<input type="hidden" id="ak_js" name="ak_js" value="1493624684130"></form>
			</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/1d75d46040c28497f0dee5d8e100db37(2)" srcset="http://1.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" class="avatar avatar-100 photo" height="100" width="100"></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="http://machinelearningmastery.com/about">Read More</a></p>
<div class="fix"></div>
</div><div id="text-6" class="widget widget_text">			<div class="textwidget"><p></p><center><p></p>
<h3>Finally Get Started With Deep Learning</h3>
<p>Sick of the fancy math and need for super computers?<br>
Looking for step-by-step tutorials?<br>
Want end-to-end projects?</p>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/">Get Started With Deep Learning in Python Today!</a><br>
<a href="https://machinelearningmastery.com/deep-learning-with-python/"><img src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/DeepLearningWithPython-220.png"></a><br>
</p></center><p></p>
</div>
		</div>
		<div id="woo_tabs-2" class="widget widget_woo_tabs"> 		<div id="tabs">

            <ul class="wooTabs">
                                <li class="popular"><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#tab-pop" class="selected">Popular</a></li>                                                            </ul>

            <div class="clear"></div>

            <div class="boxes box inside">

	            
                                <ul id="tab-pop" class="list" style="display: block;">
                    	<li>
		<a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" class="thumbnail wp-post-image" alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"></a>		<a title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
		<span class="meta">July 21, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/Tour-of-Deep-Learning-Algorithms-150x150.jpg" class="thumbnail wp-post-image" alt="Tour of Deep Learning Algorithms" title="Develop Your First Neural Network in Python With Keras Step-By-Step"></a>		<a title="Develop Your First Neural Network in Python With Keras Step-By-Step" href="http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
		<span class="meta">May 24, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" class="thumbnail wp-post-image" alt="Your First Machine Learning Project in Python Step-By-Step" title="Your First Machine Learning Project in Python Step-By-Step"></a>		<a title="Your First Machine Learning Project in Python Step-By-Step" href="http://machinelearningmastery.com/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python Step-By-Step</a>
		<span class="meta">June 10, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" class="thumbnail wp-post-image" alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"></a>		<a title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
		<span class="meta">July 26, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/how-to-run-your-first-classifier-in-weka/" title="How to Run Your First Classifier in Weka"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/weka-zeror-150x150.png" class="thumbnail wp-post-image" alt="Weka Results for the ZeroR algorithm on the Iris flower dataset" title="How to Run Your First Classifier in Weka"></a>		<a title="How to Run Your First Classifier in Weka" href="http://machinelearningmastery.com/how-to-run-your-first-classifier-in-weka/">How to Run Your First Classifier in Weka</a>
		<span class="meta">February 17, 2014</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" class="thumbnail wp-post-image" alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"></a>		<a title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" href="http://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
		<span class="meta">June 2, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/" title="Tutorial To Implement k-Nearest Neighbors in Python From Scratch"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/k-Nearest-Neighbors-algorithm-150x150.png" class="thumbnail wp-post-image" alt="k-Nearest Neighbors algorithm" title="Tutorial To Implement k-Nearest Neighbors in Python From Scratch"></a>		<a title="Tutorial To Implement k-Nearest Neighbors in Python From Scratch" href="http://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/">Tutorial To Implement k-Nearest Neighbors in Python From Scratch</a>
		<span class="meta">September 12, 2014</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/" title="A Tour of Machine Learning Algorithms"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/ensemble-150x150.png" class="thumbnail wp-post-image" alt="Ensemble Learning Method" title="A Tour of Machine Learning Algorithms"></a>		<a title="A Tour of Machine Learning Algorithms" href="http://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/">A Tour of Machine Learning Algorithms</a>
		<span class="meta">November 25, 2013</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="http://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" class="thumbnail wp-post-image" alt="Regression Tutorial with Keras Deep Learning Library in Python" title="Regression Tutorial with the Keras Deep Learning Library in Python"></a>		<a title="Regression Tutorial with the Keras Deep Learning Library in Python" href="http://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/">Regression Tutorial with the Keras Deep Learning Library in Python</a>
		<span class="meta">June 9, 2016</span>
		<div class="fix"></div>
	</li>
		<li style="border-bottom: 0px;">
		<a href="http://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" title="How To Implement Naive Bayes From Scratch in Python"><img width="45" height="45" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/naive-bayes-classifier-150x150.jpg" class="thumbnail wp-post-image" alt="naive bayes classifier" title="How To Implement Naive Bayes From Scratch in Python"></a>		<a title="How To Implement Naive Bayes From Scratch in Python" href="http://machinelearningmastery.com/naive-bayes-classifier-scratch-python/">How To Implement Naive Bayes From Scratch in Python</a>
		<span class="meta">December 8, 2014</span>
		<div class="fix"></div>
	</li>
	                </ul>
                                                                
            </div><!-- /.boxes -->

        </div><!-- /wooTabs -->

        </div>         </aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2017 Machine Learning Mastery. All Rights Reserved. </p>		</div>

		<div id="credit" class="col-right">
			<p></p><p>
<a href="http://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="http://machinelearningmastery.com/contact/">Contact</a> |
<a href="http://machinelearningmastery.com/about/">About</a>
</p><p></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip Code -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/form.js.下載"></script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/comment-reply.min.js.下載"></script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/wp-embed.min.js.下載"></script>
<script type="text/javascript">
/* <![CDATA[ */
var fsb = {"ajax":"http:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","nonce":"273334f3e4"};
/* ]]> */
</script>
<script type="text/javascript" src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/fsb.js.下載"></script>

<div class="swiftype-widget"><div class="autocomplete" style="position: absolute; z-index: 9999; top: 105px; left: 843.109px; width: 406px; display: none;"><ul></ul></div></div><div style="position: absolute; right: 0px; left: 0px; bottom: 0px; top: 0px; z-index: 2147483646; background: black; width: 100%; opacity: 0.5; display: none; height: 127208px;"></div><iframe src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/saved_resource.html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 871px;"></iframe><iframe src="./Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras - Machine Learning Mastery_files/saved_resource(1).html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 871px;"></iframe><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right no-image">
    <div id="drip-header-2211" class="drip-header drip-hidden">
      <a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Get Your Start in Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: 0px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Get Your Start in Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without the math or fancy degree</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em> email course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
            </div>
            <dl class="no-labels">
              
                <dt>Email Address</dt>
                <dd class="drip-clearfix">
                  
                    <input type="email" name="fields[email]" value="" placeholder="Email Address" class="drip-text-field">
                    <div id="drip-errors-for-email-2211" class="drip-errors"></div>
                  
                </dd>
              
            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>

      
    </div>
  </div>
</div></body></html>